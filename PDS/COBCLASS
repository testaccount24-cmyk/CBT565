./ ADD NAME=$$README 0100-02143-02143-1556-00037-00037-00000-BC0THOR
************************************************************************
* CLASS: the COBOL Language class library. This is an incomplete course*
*        that may be of use to someone wishing to develop an elementary*
*        class in COBOL. I had a request to develop the class from a   *
*        non-programmer who had to deal with COBOL programmers, and    *
*        hoped to be able to communicate better with them after the    *
*        class. I presented an initial class in commonly used computer *
*        and programming terminology, however work schedules interfered*
*        and the students were never able to wangle time to take the   *
*        follow-on, so I never finished the course.                    *
************************************************************************
$$README  Text: this file
CALC100C  Sample tax calculation program in COBOL.
CALC100X  Execution JCL for the CALC100C program.
CHAR100C  Sample COBOL program to get number from user, display edited.
CHAR200C  Sample COBOL program gets name from user, displays converted.
CHAR300C  Sample COBOL program gets ZIP-code, displays with hyphen.
COBLKEDJ  JCL to compile and linkedit a COBOL program.
DATE100C  Sample COBOL program to calculate elapsed days between dates.
DATE200C  Sample COBOL program to display age, given birth date.
DELDEFNJ  JCL using IDCAMS to delete, define a VSAM dataset.
IND1000C  Sample COBOL program showing VSAM READs and WRITEs.
IND2000C  Sample COBOL program shows Add/Change/Delete for a VSAM file.
IND4000C  Sample COBOL program reads, displays record from VSAM file.
JOBCARDJ  JCL job card sample.
LISTMODC  Sample COBOL program reads source program, prints statistics.
PAYMNTC   Sample COBOL program creates, maintains VSAM payroll file.
PAYRECF   Sample COBOL COPY book describing a record.
REL4000C  Sample COBOL program processes a relative record VSAM file.
RPT1000C  Sample COBOL report program.
RPT2000C  Sample COBOL report program.
RPT3000C  Sample COBOL report program.
RPT5000C  Sample COBOL report program.
SEQ1000C  Sample COBOL program using sequential and VSAM datasets.
SEQ2000C  Sample COBOL program using sequential and VSAM datasets.
SKELETNC  Sample COBOL program that can be used to develop new programs.
SRT1000C  Sample COBOL program showing code for an internal sort.
./ ADD NAME=$$READM1 0100-01302-01302-1202-00009-00009-00000-BC0THOR
000100This PDS contains members to be used in an elementary COBOL programming
      class. In most cases, the first 7 characters identify a program, and
      the last character is the type, where:
        C = COBOL source program.
        F = FILEDESC (copy book).
        X = Execution JCL for a class program.
        J = Execution JCL for a utility program.
        D = Data file for a class program.
        e = Second data file for a class program.
./ ADD NAME=CALC100C 0101-01299-01302-1119-00039-00039-00000-BC0THOR
000100 IDENTIFICATION DIVISION.
000200*
000300 PROGRAM-ID. CALC100C.
000400*
000500 ENVIRONMENT DIVISION.
000600*
000700 INPUT-OUTPUT SECTION.
000800*
000900 DATA DIVISION.
001000*
001100 FILE SECTION.
001200*
001300 WORKING-STORAGE SECTION.
001400*
001500 77  END-OF-SESSION-SWITCH       PIC X       VALUE "N".
001600 77  SALES-AMOUNT                PIC 9(5)V99.
001700 77  SALES-TAX                   PIC Z,ZZZ.99.
001800*
001900 PROCEDURE DIVISION.
002000*
002100 000-CALCULATE-SALES-TAX.
002200*
002300     PERFORM 100-CALCULATE-ONE-SALES-TAX
002400         UNTIL END-OF-SESSION-SWITCH = "Y".
002500     DISPLAY "END OF SESSION.".
002600     STOP RUN.
002700*
002800 100-CALCULATE-ONE-SALES-TAX.
002900*
003000     DISPLAY "-----------------------------------------------".
003100     DISPLAY "TO END PROGRAM, ENTER 0.".
003200     DISPLAY "TO CALCULATE SALES TAX, ENTER THE SALES AMOUNT.".
003300     ACCEPT SALES-AMOUNT.
003400     IF SALES-AMOUNT = ZERO
003500         MOVE "Y" TO END-OF-SESSION-SWITCH
003600     ELSE
003700         COMPUTE SALES-TAX ROUNDED =
003800             SALES-AMOUNT * .0785
003900         DISPLAY "SALES TAX = " SALES-TAX.
./ ADD NAME=CALC100X 0102-01302-01306-1536-00011-00015-00000-BC0THOR
//*******************************************************************
//*          ???????.PDS.CLASS(CALC100X)                            *
//*******************************************************************
//CALC100C EXEC PGM=CALC100C
//STEPLIB  DD   DSN=???????.LOAD.LOAD,DISP=SHR
//SYSUDUMP DD   SYSOUT=*
//SYSOUT   DD   SYSOUT=*
//SYSIN    DD   *
0012037
5127493
0000000
./ ADD NAME=CHAR100C 0101-01302-01302-1120-00072-00072-00000-BC0THOR
000100 IDENTIFICATION DIVISION.
000200
000300 PROGRAM-ID. CHAR100C.
000400
000500 ENVIRONMENT DIVISION.
000600
000700 INPUT-OUTPUT SECTION.
000800
000900 DATA DIVISION.
001000
001100 FILE SECTION.
001200
001300 WORKING-STORAGE SECTION.
001400
001500 01  SWITCHES.
001600     05  END-OF-SESSION-SWITCH   PIC X       VALUE "N".
001700         88  END-OF-SESSION                  VALUE "Y" "Y".
001800     05  VALID-ENTRY-SWITCH      PIC X.
001900         88  VALID-ENTRY                     VALUE "Y".
002000
002100 01  WORK-FIELDS.
002200     05  USER-ENTRY              PIC X(5).
002300     05  WORK-FIELD              PIC X(6).
002400     05  EDITED-RESULT           PIC S9(5).
002500     05  COUNT-1                 PIC S9(3).
002600     05  COUNT-2                 PIC S9(3).
002700
002800 PROCEDURE DIVISION.
002900
003000 000-EDIT-NUMERIC-ENTRIES.
003100
003200     PERFORM 100-EDIT-NUMERIC-ENTRY
003300         UNTIL END-OF-SESSION.
003400     DISPLAY "END OF SESSION.".
003500     STOP RUN.
003600
003700 100-EDIT-NUMERIC-ENTRY.
003800
003900     DISPLAY "-----------------------------------------------".
004000     DISPLAY "TO END PROGRAM, ENTER Y (OR Y).".
004100     ACCEPT END-OF-SESSION-SWITCH.
004200     DISPLAY "-----------------------------------------------".
004300     IF NOT END-OF-SESSION
004400         PERFORM 110-GET-INPUT-FIELDS
004500         PERFORM 120-EDIT-NUMERIC-ENTRY
004600         IF VALID-ENTRY
004700             DISPLAY "EDITED RESULT = " EDITED-RESULT
004800         ELSE
004900             DISPLAY "INVALID ENTRY.".
005000
005100 110-GET-INPUT-FIELDS.
005200
005300     DISPLAY "ENTER NUMERIC FIELD (99999).".
005400     ACCEPT USER-ENTRY.
005500
005600 120-EDIT-NUMERIC-ENTRY.
005700
005800     MOVE ZERO TO COUNT-1 COUNT-2.
005900     MOVE USER-ENTRY TO WORK-FIELD.
006000
006100     INSPECT WORK-FIELD
006200         TALLYING COUNT-1 FOR ALL "$" ALL "," ALL "."
006300         REPLACING LEADING " " BY "0".
006400
006500     IF COUNT-1 = 0
006600         INSPECT WORK-FIELD
006700             TALLYING COUNT-2 FOR CHARACTERS BEFORE " "
006800         MOVE WORK-FIELD (1:COUNT-2) TO EDITED-RESULT
006900         MOVE "Y" TO VALID-ENTRY-SWITCH
007000     ELSE
007100         MOVE "N" TO VALID-ENTRY-SWITCH.
007200
./ ADD NAME=CHAR200C 0101-01302-01302-1120-00065-00065-00000-BC0THOR
000100 IDENTIFICATION DIVISION.
000200
000300 PROGRAM-ID. CHAR200C.
000400
000500 ENVIRONMENT DIVISION.
000600
000700 INPUT-OUTPUT SECTION.
000800
000900 DATA DIVISION.
001000
001100 FILE SECTION.
001200
001300 WORKING-STORAGE SECTION.
001400
001500 01  SWITCHES.
001600     05  END-OF-SESSION-SWITCH   PIC X       VALUE "N".
001700         88  END-OF-SESSION                  VALUE "Y" "Y".
001800
001900 01  WORK-FIELDS.
002000     05  FULL-NAME               PIC X(20).
002100     05  NAME-1                  PIC X(10).
002200     05  POINTER-FIELD           PIC S9(3).
002300
002400 PROCEDURE DIVISION.
002500
002600 000-CONVERT-NAME-FIELDS.
002700
002800     PERFORM 100-CONVERT-NAME-FIELD
002900         UNTIL END-OF-SESSION.
003000     DISPLAY "END OF SESSION.".
003100     STOP RUN.
003200
003300 100-CONVERT-NAME-FIELD.
003400
003500     DISPLAY "-----------------------------------------------".
003600     DISPLAY "TO END PROGRAM, ENTER Y (OR Y).".
003700     ACCEPT END-OF-SESSION-SWITCH.
003800     DISPLAY "-----------------------------------------------".
003900     IF NOT END-OF-SESSION
004000         PERFORM 110-GET-INPUT-FIELDS
004100         PERFORM 120-CONVERT-NAME
004200         DISPLAY "RESULT: " FULL-NAME.
004300
004400 110-GET-INPUT-FIELDS.
004500
004600     DISPLAY "ENTER FULL NAME IN ALL CAPS (20).".
004700     ACCEPT FULL-NAME.
004800
004900 120-CONVERT-NAME.
005000
005100     MOVE FUNCTION LOWER-CASE (FULL-NAME) TO FULL-NAME.
005200     MOVE FUNCTION UPPER-CASE (FULL-NAME (1:1))
005300         TO FULL-NAME (1:1).
005400     MOVE 1 TO POINTER-FIELD.
005500     UNSTRING FULL-NAME DELIMITED BY ALL " "
005600         INTO NAME-1
005700         WITH POINTER POINTER-FIELD.
005800     MOVE FUNCTION UPPER-CASE (FULL-NAME (POINTER-FIELD:1))
005900         TO FULL-NAME (POINTER-FIELD:1).
006000     UNSTRING FULL-NAME DELIMITED BY ALL " "
006100         INTO NAME-1
006200         WITH POINTER POINTER-FIELD.
006300     IF POINTER-FIELD <= 20
006400        MOVE FUNCTION UPPER-CASE (FULL-NAME (POINTER-FIELD:1))
006500             TO FULL-NAME (POINTER-FIELD:1).
./ ADD NAME=CHAR300C 0101-01302-01302-1123-00079-00079-00000-BC0THOR
000100 IDENTIFICATION DIVISION.
000200
000300 PROGRAM-ID. CHAR300C.
000400
000500 ENVIRONMENT DIVISION.
000600
000700 INPUT-OUTPUT SECTION.
000800
000900 DATA DIVISION.
001000
001100 FILE SECTION.
001200
001300 WORKING-STORAGE SECTION.
001400
001500 01  SWITCHES.
001600     05  END-OF-SESSION-SWITCH   PIC X       VALUE "N".
001700         88  END-OF-SESSION                  VALUE "Y" "Y".
001800     05  VALID-ENTRY-SWITCH      PIC X.
001900         88  VALID-ENTRY                     VALUE "Y".
002000
002100 01  WORK-FIELDS.
002200     05  ZIP-CODE                PIC X(10).
002300     05  EDITED-ZIP-CODE         PIC X(9).
002400     05  COUNT-1                 PIC S9(3).
002500     05  COUNT-2                 PIC S9(3).
002600     05  COUNT-3                 PIC S9(3).
002700
002800 PROCEDURE DIVISION.
002900
003000 000-EDIT-ZIP-CODES.
003100
003200     PERFORM 100-EDIT-ZIP-CODE
003300         UNTIL END-OF-SESSION.
003400     DISPLAY "END OF SESSION.".
003500     STOP RUN.
003600
003700 100-EDIT-ZIP-CODE.
003800
003900     DISPLAY "-----------------------------------------------".
004000     DISPLAY "TO END PROGRAM, ENTER Y (OR Y).".
004100     ACCEPT END-OF-SESSION-SWITCH.
004200     DISPLAY "-----------------------------------------------".
004300     IF NOT END-OF-SESSION
004400         PERFORM 110-GET-INPUT-FIELDS
004500         PERFORM 120-EDIT-ZIP-CODE-ENTRY
004600         IF VALID-ENTRY
004700             DISPLAY "EDITED ZIP CODE = " EDITED-ZIP-CODE
004800         ELSE
004900             DISPLAY "INVALID ENTRY.".
005000
005100 110-GET-INPUT-FIELDS.
005200
005300     DISPLAY "ENTER ZIP CODE WITH OR WITHOUT A HYPHEN (-).".
005400     ACCEPT ZIP-CODE.
005500
005600 120-EDIT-ZIP-CODE-ENTRY.
005700
005800     MOVE ZERO TO COUNT-1 COUNT-2 COUNT-3.
005900
006000     INSPECT ZIP-CODE TALLYING
006100         COUNT-1 FOR ALL "-"
006200         COUNT-2 FOR CHARACTERS BEFORE "-".
006300     INSPECT ZIP-CODE
006400         TALLYING COUNT-3 FOR CHARACTERS BEFORE " ".
006500
006600     IF COUNT-1 = 0 AND (COUNT-3 = 5 OR COUNT-3 = 9)
006700         MOVE ZIP-CODE TO EDITED-ZIP-CODE
006800         MOVE "Y" TO VALID-ENTRY-SWITCH
006900     ELSE
007000         IF COUNT-1 = 1 AND COUNT-2 = 5
007100             MOVE ZIP-CODE (1:5) TO EDITED-ZIP-CODE
007200             MOVE "Y" TO VALID-ENTRY-SWITCH
007300             IF COUNT-3 = 10
007400                 MOVE ZIP-CODE (7:4)  TO EDITED-ZIP-CODE (6:)
007500             END-IF
007600         ELSE
007700             MOVE "N" TO VALID-ENTRY-SWITCH
007800         END-IF
007900     END-IF.
./ ADD NAME=COBLKEDJ 0108-01288-01303-1535-00047-00051-00000-BC0THOR
//*******************************************************************
//*                 ???????.PDS.CLASS(COBLKEDJ)                     *
//* COMPILE/LINK ???????.PDS.COBOL(########) TO ???????.LOAD.LOAD   *
//*******************************************************************
//*------------------------------------------------------------------
//* COMPILE STEP    (COB390)
//*------------------------------------------------------------------
//COMPILE  EXEC PGM=CWPCMAIN
//STEPLIB  DD   DSN=IGY.V2R1M0.SIGYCOMP,DISP=SHR
//SYSTERM  DD   SYSOUT=*
//SYSPRINT DD   SYSOUT=*
//CWPERRM  DD   SYSOUT=*
//SYSPUNCH DD   DUMMY
//SYSUT1   DD   SPACE=(CYL,(2,2)),UNIT=DISK
//SYSUT2   DD   SPACE=(CYL,(2,2)),UNIT=DISK
//SYSUT3   DD   SPACE=(CYL,(2,2)),UNIT=DISK
//SYSUT4   DD   SPACE=(CYL,(2,2)),UNIT=DISK
//SYSUT5   DD   SPACE=(CYL,(2,2)),UNIT=DISK
//SYSUT6   DD   SPACE=(CYL,(2,2)),UNIT=DISK
//SYSUT7   DD   SPACE=(CYL,(2,2)),UNIT=DISK
//SYSLIN   DD   DSN=&&SYSLIN,DISP=(NEW,PASS),
//         UNIT=DISK,SPACE=(CYL,(1,1)),
//         LRECL=80,RECFM=FB,BLKSIZE=4000
//SYSLIB   DD   DSN=???????.PDS.CLASS,DISP=SHR
//         DD   DSN=EMVSP.OUTPUT.FILEDESC,DISP=SHR
//SYSIN    DD   DSN=???????.PDS.CLASS(########),DISP=SHR
//XOPTIONS DD   DSN=SPP.XPEDTSO.V6R6M0.XOPTIONS,DISP=SHR
//CWPDDIO  DD   DSN=???????.TST.XPEDITER.DDIO,DISP=SHR
//CWPPRMO  DD  *
COBOL(OUTPUT(PRINT,DDIO))
PROCESSOR(OUTPUT(NOPRINT,NODDIO),TEXT(NONE))
LANGUAGE(COBOL/390)
DDIO(OUTPUT(NOLIST,NOXREF,FIND,NODMAP,NOOFFSET,COMPRESS))
//*------------------------------------------------------------------
//* LINKEDIT STEP
//*------------------------------------------------------------------
//LINK     EXEC PGM=IEWL,COND=(8,LE),
//         PARM=('LIST,LET,MAP,XREF,CALL')
//SYSPRINT DD   SYSOUT=*
//SYSLIN   DD   DSN=&&SYSLIN,DISP=(SHR,PASS)
//SYSLIB   DD   DSN=CEE.SCEELKED,DISP=SHR
//         DD   DSN=???????.LOAD.LOAD,DISP=SHR
//         DD   DSN=EMVSP.OUTPUT.LOADLIB,DISP=SHR
//         DD   DSN=SYS1.LINKLIB,DISP=SHR
//         DD   DSN=SYS1.IMSVS.RESLIB,DISP=SHR
//SYSLMOD  DD   DSN=???????.LOAD.LOAD(########),DISP=SHR
//SYSUT1   DD   SPACE=(CYL,(2,2)),UNIT=DISK
./ ADD NAME=DATE100C 0101-01302-01302-1125-00086-00086-00000-BC0THOR
000100 IDENTIFICATION DIVISION.
000200
000300 PROGRAM-ID. DATE100C.
000400
000500 ENVIRONMENT DIVISION.
000600
000700 INPUT-OUTPUT SECTION.
000800
000900 DATA DIVISION.
001000
001100 FILE SECTION.
001200
001300 WORKING-STORAGE SECTION.
001400
001500 01  SWITCHES.
001600     05  END-OF-SESSION-SWITCH   PIC X       VALUE "N".
001700         88  END-OF-SESSION                  VALUE "Y" "Y".
001800
001900 01  USER-ENTRIES.
002000
002100     05  DATE-1                  PIC 9(5).
002200     05  DATE-1-R REDEFINES DATE-1.
002300         10  D1-YEAR             PIC 9(2).
002400         10  D1-DAYS             PIC 9(3).
002500     05  DATE-2                  PIC 9(5).
002600     05  DATE-2-R REDEFINES DATE-2.
002700         10  D2-YEAR             PIC 9(2).
002800         10  D2-DAYS             PIC 9(3).
002900
003000 01  WORK-FIELDS.
003100
003200     05  WORK-DATE.
003300         10  WORK-YEAR           PIC 9(2).
003400         10  WORK-DAYS           PIC 9(3).
003500     05  TOTAL-DAYS              PIC S9(5).
003600     05  TOTAL-DAYS-1            PIC S9(5).
003700     05  TOTAL-DAYS-2            PIC S9(5).
003800     05  ELAPSED-DAYS            PIC Z(5).
003900     05  YEAR-REMAINDER          PIC S9.
004000     05  LEAP-YEARS              PIC S9(3).
004100
004200 PROCEDURE DIVISION.
004300
004400 000-CALCULATE-ELAPSED-DAYS.
004500
004600     PERFORM 100-CALCULATE-ELAPSED-DAYS
004700         UNTIL END-OF-SESSION.
004800     DISPLAY "END OF SESSION.".
004900     STOP RUN.
005000
005100 100-CALCULATE-ELAPSED-DAYS.
005200
005300     DISPLAY "-----------------------------------------------".
005400     DISPLAY "TO END PROGRAM, ENTER Y (OR Y).".
005500     ACCEPT END-OF-SESSION-SWITCH.
005600     DISPLAY "-----------------------------------------------".
005700     IF NOT END-OF-SESSION
005800         PERFORM 110-GET-USER-ENTRIES
005900         PERFORM 120-CALCULATE-ELAPSED-DAYS
006000         DISPLAY "ELAPSED DAYS = " ELAPSED-DAYS.
006100
006200 110-GET-USER-ENTRIES.
006300
006400     DISPLAY "ENTER FIRST DATE (YYDDD).".
006500     ACCEPT DATE-1.
006600     DISPLAY "ENTER SECOND DATE (YYDDD).".
006700     ACCEPT DATE-2.
006800
006900 120-CALCULATE-ELAPSED-DAYS.
007000
007100     MOVE DATE-1 TO WORK-DATE.
007200     PERFORM 130-COMPUTE-TOTAL-DAYS.
007300     MOVE TOTAL-DAYS TO TOTAL-DAYS-1.
007400     MOVE DATE-2 TO WORK-DATE.
007500     PERFORM 130-COMPUTE-TOTAL-DAYS.
007600     MOVE TOTAL-DAYS TO TOTAL-DAYS-2.
007700     COMPUTE ELAPSED-DAYS = TOTAL-DAYS-1 - TOTAL-DAYS-2.
007800
007900 130-COMPUTE-TOTAL-DAYS.
008000
008100     DIVIDE WORK-YEAR BY 4 GIVING LEAP-YEARS
008200         REMAINDER YEAR-REMAINDER.
008300     COMPUTE TOTAL-DAYS = (WORK-YEAR * 365)
008400                        + WORK-DAYS + LEAP-YEARS.
008500     IF YEAR-REMAINDER = 0
008600         COMPUTE TOTAL-DAYS = TOTAL-DAYS - 1.
./ ADD NAME=DATE200C 0101-01302-01302-1125-00063-00063-00000-BC0THOR
000100 IDENTIFICATION DIVISION.
000200
000300 PROGRAM-ID. DATE200C.
000400
000500 ENVIRONMENT DIVISION.
000600
000700 INPUT-OUTPUT SECTION.
000800
000900 DATA DIVISION.
001000
001100 FILE SECTION.
001200
001300 WORKING-STORAGE SECTION.
001400
001500 01  SWITCHES.
001600     05  END-OF-SESSION-SWITCH        PIC X       VALUE "N".
001700         88  END-OF-SESSION                       VALUE "Y" "Y".
001800
001900 01  CURRENT-DATE-AND-TIME.
002000
002100     05  CD-DATE.
002200         10  CD-YEAR                  PIC 9(4).
002300         10  CD-MONTH                 PIC 9(2).
002400         10  CD-DAY                   PIC 9(2).
002500
002600 01  USER-ENTRIES.
002700
002800     05  BIRTH-MONTH                  PIC 9(2).
002900     05  BIRTH-DAY                    PIC 9(2).
003000     05  BIRTH-YEAR                   PIC 9(2).
003100
003200 01  WORK-FIELDS.
003300
003400     05  USER-AGE                     PIC Z(3).
003500
003600 PROCEDURE DIVISION.
003700
003800 000-CALCULATE-USER-AGES.
003900
004000     ACCEPT CD-DATE FROM DATE YYYYMMDD.
004100     PERFORM 100-CALCULATE-USER-AGE
004200         UNTIL END-OF-SESSION.
004300     DISPLAY "END OF SESSION.".
004400     STOP RUN.
004500
004600 100-CALCULATE-USER-AGE.
004700
004800     DISPLAY "-----------------------------------------------".
004900     DISPLAY "TO END PROGRAM, ENTER Y (OR Y).".
005000     ACCEPT END-OF-SESSION-SWITCH.
005100     DISPLAY "-----------------------------------------------".
005200     IF NOT END-OF-SESSION
005300         PERFORM 110-GET-USER-ENTRIES
005400         DISPLAY "AGE = " USER-AGE.
005500
005600 110-GET-USER-ENTRIES.
005700
005800     DISPLAY "ENTER MONTH OF BIRTH.".
005900     ACCEPT BIRTH-MONTH.
006000     DISPLAY "ENTER DAY OF BIRTH.".
006100     ACCEPT BIRTH-DAY.
006200     DISPLAY "ENTER YEAR OF BIRTH (99).".
006300     ACCEPT BIRTH-YEAR.
./ ADD NAME=DELDEFNJ 0105-01289-01302-1126-00036-00021-00000-BC0THOR
//BC0THORJ JOB (1152002-9800039,,TMVS01-UR-XXXX),'DTHORNTON',CLASS=V,
//   MSGCLASS=Y,NOTIFY=BC0THOR,REGION=4M
//JESOUT OUTPUT GROUPID=02A,DEFAULT=YES,JESDS=ALL,
//   PAGEDEF=GRYBIG,FORMDEF=GRYBIG
//*******************************************************************
//*                 BC0THOR.PDS.CLASS(DELDEFNJ)                     *
//*                DELETE, THEN DEFINE A VSAM DATA SET              *
//*******************************************************************
//SCRATCH  EXEC PGM=IDCAMS
//SYSPRINT DD   SYSOUT=*
//SYSIN    DD   *
  DELETE BC0THOR.TSTCLASS.PAYFILE -
        PURGE -
        NOERASE -
        CLUSTER
  DEFINE CLUSTER -
         (NAME(BC0THOR.TSTCLASS.PAYFILE) -
         SHAREOPTIONS(3 3) -
         UNIQUE) -
       INDEX -
         (NAME(BC0THOR.TSTCLASS.PAYFILE.INDEX) -
         TRACKS(1 1) -
         CONTROLINTERVALSIZE(512) -
         VOLUMES(*) -
         IMBED -
         REPLICATE) -
       DATA -
         (NAME(BC0THOR.TSTCLASS.PAYFILE.DATA) -
         VOLUMES(*) -
         SPEED -
         KEYS(9 1) -
         RECORDSIZE(564 564) -
         FREESPACE(25 25) -
         CYLINDERS(5 1) -
         CONTROLINTERVALSIZE(4096))
  LISTCAT ENTRIES('BC0THOR.TSTCLASS.PAYFILE') ALL
./ ADD NAME=IND1000C 0101-01302-01302-1128-00077-00077-00000-BC0THOR
000100 IDENTIFICATION DIVISION.
000200*
000300 PROGRAM-ID. IND100C.
000400*
000500 ENVIRONMENT DIVISION.
000600*
000700 INPUT-OUTPUT SECTION.
000800*
000900 FILE-CONTROL.
001000     SELECT INVMASTS ASSIGN TO INVMASTS.
001100     SELECT INVMASTI ASSIGN TO INVMASTI
001200                     ORGANIZATION IS INDEXED
001300                     ACCESS IS SEQUENTIAL
001400                     RECORD KEY IS IR-ITEM-NO.
001500*
001600 DATA DIVISION.
001700*
001800 FILE SECTION.
001900*
002000 FD  INVMASTS.
002100*
002200 01  SEQUENTIAL-RECORD-AREA  PIC X(70).
002300*
002400 FD  INVMASTI.
002500*
002600 01  INDEXED-RECORD-AREA.
002700     05  IR-ITEM-NO              PIC X(5).
002800     05  FILLER                  PIC X(65).
002900*
003000 WORKING-STORAGE SECTION.
003100*
003200 01  SWITCHES.
003300     05  INVMAST-EOF-SWITCH      PIC X    VALUE "N".
003400         88  INVMAST-EOF                  VALUE "Y".
003500*
003600 01  INVENTORY-MASTER-RECORD.
003700     05  IM-ITEM-NO              PIC X(5).
003800     05  IM-DESCRIPTIVE-DATA.
003900         10  IM-ITEM-DESC        PIC X(40).
004000         10  IM-UNIT-COST        PIC S9(3)V99.
004100         10  IM-UNIT-PRICE       PIC S9(3)V99.
004200     05  IM-INVENTORY-DATA.
004300         10  IM-REORDER-POINT    PIC S9(5).
004400         10  IM-ON-HAND          PIC S9(5).
004500         10  IM-ON-ORDER         PIC S9(5).
004600*
004700 PROCEDURE DIVISION.
004800*
004900 000-CREATE-INVENTORY-FILE.
005000*
005100     OPEN INPUT  INVMASTS
005200          OUTPUT INVMASTI.
005300     PERFORM 100-CREATE-INVENTORY-RECORD
005400         UNTIL INVMAST-EOF.
005500     CLOSE INVMASTS
005600           INVMASTI.
005700     STOP RUN.
005800*
005900 100-CREATE-INVENTORY-RECORD.
006000*
006100     PERFORM 110-READ-SEQUENTIAL-RECORD.
006200     IF NOT INVMAST-EOF
006300         PERFORM 120-WRITE-INDEXED-RECORD.
006400*
006500 110-READ-SEQUENTIAL-RECORD.
006600*
006700     READ INVMASTS INTO INVENTORY-MASTER-RECORD
006800         AT END
006900             MOVE "Y" TO INVMAST-EOF-SWITCH.
007000*
007100 120-WRITE-INDEXED-RECORD.
007200*
007300     WRITE INDEXED-RECORD-AREA FROM INVENTORY-MASTER-RECORD
007400         INVALID KEY
007500             DISPLAY "WRITE ERROR ON INVMAST FOR ITEM NUMBER "
007600                 IR-ITEM-NO
007700             MOVE "Y" TO INVMAST-EOF-SWITCH.
./ ADD NAME=IND2000C 0101-01302-01302-1135-00168-00168-00000-BC0THOR
000100 IDENTIFICATION DIVISION.
000200*
000300 PROGRAM-ID.  IND2000C
000400*
000500 ENVIRONMENT DIVISION.
000600*
000700 INPUT-OUTPUT SECTION.
000800*
000900 FILE-CONTROL.
001000*
001100     SELECT MNTTRAN  ASSIGN TO MNTTRAN.
001200     SELECT INVMAST  ASSIGN TO INVMAST
001300                     ORGANIZATION IS INDEXED
001400                     ACCESS IS RANDOM
001500                     RECORD KEY IS IR-ITEM-NO.
001600     SELECT ERRTRAN  ASSIGN TO ERRTRAN
001700                     FILE STATUS IS ERRTRAN-FILE-STATUS.
001800*
001900 DATA DIVISION.
002000*
002100 FILE SECTION.
002200*
002300 FD  MNTTRAN.
002400*
002500 01  TRANSACTION-RECORD      PIC X(61).
002600*
002700 FD  INVMAST.
002800*
002900 01  INVENTORY-RECORD-AREA.
003000     05  IR-ITEM-NO          PIC X(5).
003100     05  FILLER              PIC X(65).
003200*
003300 FD  ERRTRAN.
003400*
003500 01  ERROR-TRANSACTION       PIC X(61).
003600*
003700 WORKING-STORAGE SECTION.
003800*
003900 01  SWITCHES.
004000     05  TRANSACTION-EOF-SWITCH  PIC X   VALUE "N".
004100         88  TRANSACTION-EOF             VALUE "Y".
004200     05  MASTER-FOUND-SWITCH     PIC X   VALUE "Y".
004300         88  MASTER-FOUND                VALUE "Y".
004400*
004500 01  FILE-STATUS-FIELDS.
004600     05  ERRTRAN-FILE-STATUS     PIC XX.
004700         88  ERRTRAN-SUCCESSFUL          VALUE "00".
004800*
004900 01  MAINTENANCE-TRANSACTION.
005000     05  MT-TRANSACTION-CODE     PIC X.
005100         88  DELETE-RECORD               VALUE "1".
005200         88  ADD-RECORD                  VALUE "2".
005300         88  CHANGE-RECORD               VALUE "3".
005400     05  MT-MASTER-DATA.
005500         10  MT-ITEM-NO          PIC X(5).
005600         10  MT-ITEM-DESC        PIC X(40).
005700         10  MT-UNIT-COST        PIC S9(3)V99.
005800         10  MT-UNIT-PRICE       PIC S9(3)V99.
005900         10  MT-REORDER-POINT    PIC S9(5).
006000*
006100 01  INVENTORY-MASTER-RECORD.
006200     05  IM-ITEM-NO              PIC X(5).
006300     05  IM-DESCRIPTIVE-DATA.
006400         10  IM-ITEM-DESC        PIC X(40).
006500         10  IM-UNIT-COST        PIC S9(3)V99.
006600         10  IM-UNIT-PRICE       PIC S9(3)V99.
006700     05  IM-INVENTORY-DATA.
006800         10  IM-REORDER-POINT    PIC S9(5).
006900         10  IM-ON-HAND          PIC S9(5).
007000         10  IM-ON-ORDER         PIC S9(5).
007100*
007200 PROCEDURE DIVISION.
007300*
007400 000-MAINTAIN-INVENTORY-FILE.
007500*
007600     OPEN INPUT  MNTTRAN
007700          I-O    INVMAST
007800          OUTPUT ERRTRAN.
007900     PERFORM 300-MAINTAIN-INVENTORY-RECORD
008000         UNTIL TRANSACTION-EOF.
008100     CLOSE MNTTRAN
008200           INVMAST
008300           ERRTRAN.
008400     STOP RUN.
008500*
008600 300-MAINTAIN-INVENTORY-RECORD.
008700*
008800     PERFORM 310-READ-INVENTORY-TRANSACTION.
008900     IF NOT TRANSACTION-EOF
009000         PERFORM 320-READ-INVENTORY-MASTER
009100         IF DELETE-RECORD
009200             IF MASTER-FOUND
009300                 PERFORM 330-DELETE-INVENTORY-RECORD
009400             ELSE
009500                 PERFORM 380-WRITE-ERROR-TRANSACTION
009600         ELSE IF ADD-RECORD
009700             IF MASTER-FOUND
009800                 PERFORM 380-WRITE-ERROR-TRANSACTION
009900             ELSE
010000                 PERFORM 340-ADD-INVENTORY-RECORD
010100         ELSE IF CHANGE-RECORD
010200             IF MASTER-FOUND
010300                 PERFORM 360-CHANGE-INVENTORY-RECORD
010400             ELSE
010500                 PERFORM 380-WRITE-ERROR-TRANSACTION.
010600*
010700 310-READ-INVENTORY-TRANSACTION.
010800*
010900     READ MNTTRAN INTO MAINTENANCE-TRANSACTION
011000         AT END
011100             MOVE "Y" TO TRANSACTION-EOF-SWITCH.
011200*
011300 320-READ-INVENTORY-MASTER.
011400*
011500     MOVE MT-ITEM-NO TO IR-ITEM-NO.
011600     READ INVMAST INTO INVENTORY-MASTER-RECORD
011700         INVALID KEY
011800             MOVE "N" TO MASTER-FOUND-SWITCH
011900         NOT INVALID KEY
012000             MOVE "Y" TO MASTER-FOUND-SWITCH.
012100*
012200 330-DELETE-INVENTORY-RECORD.
012300*
012400     DELETE INVMAST.
012500*
012600 340-ADD-INVENTORY-RECORD.
012700*
012800     MOVE MT-ITEM-NO       TO IM-ITEM-NO.
012900     MOVE MT-ITEM-DESC     TO IM-ITEM-DESC.
013000     MOVE MT-UNIT-COST     TO IM-UNIT-COST.
013100     MOVE MT-UNIT-PRICE    TO IM-UNIT-PRICE.
013200     MOVE MT-REORDER-POINT TO IM-REORDER-POINT.
013300     MOVE ZERO             TO IM-ON-HAND.
013400     MOVE ZERO             TO IM-ON-ORDER.
013500     PERFORM 350-WRITE-INVENTORY-RECORD.
013600*
013700 350-WRITE-INVENTORY-RECORD.
013800*
013900     WRITE INVENTORY-RECORD-AREA FROM INVENTORY-MASTER-RECORD
014000         INVALID KEY
014100             DISPLAY "WRITE ERROR ON INVMAST FOR ITEM NUMBER "
014200                 IR-ITEM-NO
014300             MOVE "Y" TO TRANSACTION-EOF-SWITCH.
014400*
014500 360-CHANGE-INVENTORY-RECORD.
014600*
014700     IF MT-ITEM-DESC NOT = SPACE
014800         MOVE MT-ITEM-DESC TO IM-ITEM-DESC.
014900     IF MT-UNIT-COST NOT = ZERO
015000         MOVE MT-UNIT-COST TO IM-UNIT-COST.
015100     IF MT-UNIT-PRICE NOT = ZERO
015200         MOVE MT-UNIT-PRICE TO IM-UNIT-PRICE.
015300     IF MT-REORDER-POINT NOT = ZERO
015400         MOVE MT-REORDER-POINT TO IM-REORDER-POINT.
015500     PERFORM 370-REWRITE-INVENTORY-RECORD.
015600*
015700 370-REWRITE-INVENTORY-RECORD.
015800*
015900     REWRITE INVENTORY-RECORD-AREA FROM INVENTORY-MASTER-RECORD.
016000*
016100 380-WRITE-ERROR-TRANSACTION.
016200*
016300     WRITE ERROR-TRANSACTION FROM MAINTENANCE-TRANSACTION.
016400     IF NOT ERRTRAN-SUCCESSFUL
016500         DISPLAY "WRITE ERROR ON ERRTRAN FOR ITEM NUMBER "
016600             MT-ITEM-NO
016700         DISPLAY "FILE STATUS CODE IS " ERRTRAN-FILE-STATUS
016800         MOVE "Y" TO TRANSACTION-EOF-SWITCH.
./ ADD NAME=IND4000C 0102-01302-01302-1422-00076-00076-00000-BC0THOR
000100 IDENTIFICATION DIVISION.
000200*
000300 PROGRAM-ID. IND4000C.
000400*
000500 ENVIRONMENT DIVISION.
000600*
000700 INPUT-OUTPUT SECTION.
000800*
000900 FILE-CONTROL.
001000*
001100     SELECT CUSTMAST ASSIGN TO CUSTMAST
001200                     ORGANIZATION IS INDEXED
001300                     ACCESS IS RANDOM
001400                     RECORD KEY IS CM-CUSTOMER-NUMBER
001500                     ALTERNATE RECORD KEY IS CM-BRANCH-NUMBER
001600                         WITH DUPLICATES.
001700*
001800 DATA DIVISION.
001900*
002000 FILE SECTION.
002100*
002200 FD  CUSTMAST.
002300*
002400 01  CUSTOMER-MASTER-RECORD.
002500     05  CM-BRANCH-NUMBER        PIC 9(2).
002600     05  CM-SALESREP-NUMBER      PIC 9(2).
002700     05  CM-CUSTOMER-NUMBER      PIC X(5).
002800     05  CM-CUSTOMER-NAME        PIC X(20).
002900     05  CM-SALES-THIS-YTD       PIC S9(5)V9(2).
003000     05  CM-SALES-LAST-YTD       PIC S9(5)V9(2).
003100*
003200 WORKING-STORAGE SECTION.
003300*
003400 01  SWITCHES.
003500     05  END-OF-SESSION-SWITCH   PIC X   VALUE "N".
003600         88  END-OF-SESSION              VALUE "Y".
003700*
003800 01  USER-ENTRIES.
003900     05  CUSTOMER-NUMBER         PIC 9(5).
004000*
004100 01  WORK-FIELDS.
004200     05  EDITED-YTD-SALES        PIC ZZ,ZZZ.99-.
004300*
004400 PROCEDURE DIVISION.
004500*
004600 000-DISPLAY-CUSTOMER-RECORDS.
004700*
004800     OPEN INPUT CUSTMAST.
004900     PERFORM 100-DISPLAY-CUSTOMER-RECORD
005000         UNTIL END-OF-SESSION.
005100     CLOSE CUSTMAST.
005200     STOP RUN.
005300*
005400 100-DISPLAY-CUSTOMER-RECORD.
005500*
005600     PERFORM 110-GET-USER-ENTRY.
005700*
005800 110-GET-USER-ENTRY.
005900*
006000     DISPLAY "ENTER A CUSTOMER NUMBER.".
006100     DISPLAY "OR, ENTER 99999 TO END THE PROGRAM.".
006200     DISPLAY "-----------------------------------------".
006300     ACCEPT CUSTOMER-NUMBER.
006400     IF CUSTOMER-NUMBER = 99999
006500         MOVE "Y" TO END-OF-SESSION-SWITCH.
006600*
006700 120-READ-CUSTOMER-RECORD.
006800*
006900*
007000 130-DISPLAY-CUSTOMER-DATA.
007100*
007200     MOVE CM-SALES-THIS-YTD TO EDITED-YTD-SALES.
007300     DISPLAY "NUMBER  NAME                    YTD SALES".
007400     DISPLAY CM-CUSTOMER-NUMBER "   " CM-CUSTOMER-NAME
007500             "    " EDITED-YTD-SALES.
007600     DISPLAY "-----------------------------------------".
./ ADD NAME=JOBCARDJ 0101-01303-01303-1533-00004-00008-00000-BC0THOR
//???????X JOB (0000000-0000000,,TMVS01-UR-XXXX),'YOURNAME',CLASS=A,
//   MSGCLASS=Y,NOTIFY=???????,REGION=104M
//JESOUT OUTPUT GROUPID=???,DEFAULT=YES,JESDS=ALL, <==??? IS MAIL DROP
//   PAGEDEF=GRYBIG,FORMDEF=GRYBIG
./ ADD NAME=LISTMODC 0102-01302-01311-1307-02037-02036-00000-BC0THOR
000100 IDENTIFICATION DIVISION.
000200*
000300 PROGRAM-ID.    LISTMODC.
000400*
000500 ENVIRONMENT DIVISION.
000600*
000700 CONFIGURATION SECTION.
000800*
000900 INPUT-OUTPUT SECTION.
001000*
001100 FILE-CONTROL.
001200*
001300     SELECT SRCEFILE   ASSIGN TO SRCEFILE.
001500     SELECT MODLIST    ASSIGN TO MODLIST.
001600*
001700 DATA DIVISION.
001800*
001900 FILE SECTION.
002000*
002100 FD  SRCEFILE
002110     RECORDING MODE IS F
002200     LABEL RECORDS ARE STANDARD.
002300*
002400 01  SOURCE-RECORD.
002500*
002600     05  FILLER                    PIC X(6).
002700     05  CODING-AREA               PIC X(66).
002800         88  BLANK-LINE            VALUE SPACE.
002900     05  CODING-AREA-X             REDEFINES CODING-AREA.
003000         10  AST-AREA              PIC X.
003100             88  COMMENT           VALUE "*".
003200         10  DATA-AREA.
003300             15  A-AREA            PIC X(4).
003400             15  B-AREA            PIC X(61).
003500     05  FILLER                    PIC X(8).
003600*
003700 FD  MODLIST
003710     RECORDING MODE IS F
003800     LABEL RECORDS ARE STANDARD.
003900*
004000 01  PRINT-AREA.
004100*
004200     05  PRINT-LINE        PIC X(132).
004300     05  PRINT-LINE-1      REDEFINES PRINT-LINE.
004400         10  PL1-ASTERISK  PIC X.
004500         10  PL1-NAME      PIC X(32).
004600         10  FILLER        PIC X(99).
004700     05  PRINT-LINE-2      REDEFINES PRINT-LINE.
004800         10  FILLER        PIC X(4).
004900         10  PL2-ASTERISK  PIC X.
005000         10  PL2-NAME      PIC X(32).
005100         10  FILLER        PIC X(95).
005200     05  PRINT-LINE-3      REDEFINES PRINT-LINE.
005300         10  FILLER        PIC X(8).
005400         10  PL3-ASTERISK  PIC X.
005500         10  PL3-NAME      PIC X(32).
005600         10  FILLER        PIC X(91).
005700     05  PRINT-LINE-4      REDEFINES PRINT-LINE.
005800         10  FILLER        PIC X(12).
005900         10  PL4-ASTERISK  PIC X.
006000         10  PL4-NAME      PIC X(32).
006100         10  FILLER        PIC X(87).
006200     05  PRINT-LINE-5      REDEFINES PRINT-LINE.
006300         10  FILLER        PIC X(16).
006400         10  PL5-ASTERISK  PIC X.
006500         10  PL5-NAME      PIC X(32).
006600         10  FILLER        PIC X(83).
006700     05  PRINT-LINE-6      REDEFINES PRINT-LINE.
006800         10  FILLER        PIC X(20).
006900         10  PL6-ASTERISK  PIC X.
007000         10  PL6-NAME      PIC X(32).
007100         10  FILLER        PIC X(79).
007200     05  PRINT-LINE-7      REDEFINES PRINT-LINE.
007300         10  FILLER        PIC X(24).
007400         10  PL7-ASTERISK  PIC X.
007500         10  PL7-NAME      PIC X(32).
007600         10  FILLER        PIC X(75).
007700     05  PRINT-LINE-8      REDEFINES PRINT-LINE.
007800         10  FILLER        PIC X(28).
007900         10  PL8-ASTERISK  PIC X.
008000         10  PL8-NAME      PIC X(32).
008100         10  FILLER        PIC X(71).
008200     05  PRINT-LINE-9      REDEFINES PRINT-LINE.
008300         10  FILLER        PIC X(32).
008400         10  PL9-ASTERISK  PIC X.
008500         10  PL9-NAME      PIC X(32).
008600         10  FILLER        PIC X(67).
008700     05  PRINT-LINE-10     REDEFINES PRINT-LINE.
008800         10  FILLER        PIC X(36).
008900         10  PL10-ASTERISK PIC X.
009000         10  PL10-NAME     PIC X(32).
009100         10  FILLER        PIC X(63).
009200     05  PRINT-LINE-11     REDEFINES PRINT-LINE.
009300         10  FILLER        PIC X(40).
009400         10  PL11-ASTERISK PIC X.
009500         10  PL11-NAME     PIC X(32).
009600         10  FILLER        PIC X(59).
009700     05  PRINT-LINE-12     REDEFINES PRINT-LINE.
009800         10  FILLER        PIC X(44).
009900         10  PL12-ASTERISK PIC X.
010000         10  PL12-NAME     PIC X(32).
010100         10  FILLER        PIC X(55).
010200     05  PRINT-LINE-13     REDEFINES PRINT-LINE.
010300         10  FILLER        PIC X(48).
010400         10  PL13-ASTERISK PIC X.
010500         10  PL13-NAME     PIC X(32).
010600         10  FILLER        PIC X(51).
010700     05  PRINT-LINE-14     REDEFINES PRINT-LINE.
010800         10  FILLER        PIC X(52).
010900         10  PL14-ASTERISK PIC X.
011000         10  PL14-NAME     PIC X(32).
011100         10  FILLER        PIC X(47).
011200     05  PRINT-LINE-15     REDEFINES PRINT-LINE.
011300         10  FILLER        PIC X(56).
011400         10  PL15-ASTERISK PIC X.
011500         10  PL15-NAME     PIC X(32).
011600         10  FILLER        PIC X(43).
011700     05  PRINT-LINE-16     REDEFINES PRINT-LINE.
011800         10  FILLER        PIC X(60).
011900         10  PL16-ASTERISK PIC X.
012000         10  PL16-NAME     PIC X(32).
012100         10  FILLER        PIC X(39).
012200     05  PRINT-LINE-17     REDEFINES PRINT-LINE.
012300         10  FILLER        PIC X(64).
012400         10  PL17-ASTERISK PIC X.
012500         10  PL17-NAME     PIC X(32).
012600         10  FILLER        PIC X(35).
012700     05  PRINT-LINE-18     REDEFINES PRINT-LINE.
012800         10  FILLER        PIC X(68).
012900         10  PL18-ASTERISK PIC X.
013000         10  PL18-NAME     PIC X(32).
013100         10  FILLER        PIC X(31).
013200     05  PRINT-LINE-19     REDEFINES PRINT-LINE.
013300         10  FILLER        PIC X(72).
013400         10  PL19-ASTERISK PIC X.
013500         10  PL19-NAME     PIC X(32).
013600         10  FILLER        PIC X(27).
013700     05  PRINT-LINE-20     REDEFINES PRINT-LINE.
013800         10  FILLER        PIC X(76).
013900         10  PL20-ASTERISK PIC X.
014000         10  PL20-NAME     PIC X(32).
014100         10  FILLER        PIC X(23).
014200     05  PRINT-LINE-21     REDEFINES PRINT-LINE.
014300         10  FILLER        PIC X(80).
014400         10  PL21-ASTERISK PIC X.
014500         10  PL21-NAME     PIC X(32).
014600         10  FILLER        PIC X(19).
014700     05  PRINT-LINE-22     REDEFINES PRINT-LINE.
014800         10  FILLER        PIC X(84).
014900         10  PL22-ASTERISK PIC X.
015000         10  PL22-NAME     PIC X(32).
015100         10  FILLER        PIC X(15).
015200     05  PRINT-LINE-23     REDEFINES PRINT-LINE.
015300         10  FILLER        PIC X(88).
015400         10  PL23-ASTERISK PIC X.
015500         10  PL23-NAME     PIC X(32).
015600         10  FILLER        PIC X(11).
015700     05  PRINT-LINE-24     REDEFINES PRINT-LINE.
015800         10  FILLER        PIC X(92).
015900         10  PL24-ASTERISK PIC X.
016000         10  PL24-NAME     PIC X(32).
016100         10  FILLER        PIC X(7).
016200     05  PRINT-LINE-25     REDEFINES PRINT-LINE.
016300         10  FILLER        PIC X(96).
016400         10  PL25-ASTERISK PIC X.
016500         10  PL25-NAME     PIC X(32).
016600         10  FILLER        PIC X(3).
016700     05  DECLARATIVE-LINE      REDEFINES PRINT-LINE.
016800         10  FILLER            PIC X.
016900         10  DL-CODE           PIC X(65).
017000         10  FILLER            PIC X(66).
017100     05  MODULE-LINE           REDEFINES PRINT-LINE.
017200         10  ML-MODULE-NAME    PIC X(30).
017300         10  FILLER            PIC X(102).
017400     05  STATISTICS-LINE       REDEFINES PRINT-LINE.
017500         10  SL-DESCRIPTION    PIC X(30).
017600         10  SL-COUNT          PIC ZZ,ZZ9.
017700         10  FILLER            PIC X(96).
017800*
017900 WORKING-STORAGE SECTION.
018000*
018100 01  MODULE-TABLE.
018200*
018300     05  MODULE-ENTRY                  OCCURS 250 TIMES
018400                                       INDEXED BY MODULE-INDEX.
018500         10  MODULE-NUMBER             PIC S9(3)    COMP.
018600         10  FULL-MODULE-NAME.
018700             15  MODULE-NAME           PIC X(30).
018800             15  FILLER                PIC X.
018900             15  COMMON-MODULE-FLAG    PIC X.
019000                 88  COMMON-MODULE     VALUE "C".
019100         10  MODULE-TYPE-FLAG          PIC X.
019200             88  PROGRAM-PARAGRAPH     VALUE "P".
019300             88  PROGRAM-SECTION       VALUE "X".
019400             88  SUBPROGRAM            VALUE "S".
019500         10  MODULE-PRINTED-SW         PIC X.
019600             88  MODULE-PRINTED        VALUE "Y".
019700         10  TIMES-CALLED              PIC S9(3)    COMP.
019800         10  MODULE-CALL-COUNT         PIC S9(3)    COMP.
019900         10  MODULE-CALL-DATA          OCCURS 25 TIMES
020000                                       INDEXED BY CALL-INDEX.
020100             15  CALLED-MODULE         PIC S9(3)    COMP.
020200         10  CALL-OVERFLOW-SW          PIC X.
020300*
020400 01  MODULE-TABLE-LIMITS               COMP.
020500*
020600     05  MODULE-LIMIT                  PIC S999     VALUE +250.
020700     05  CALL-LIMIT                    PIC S999     VALUE +25.
020800*
020900 01  UNSTRING-WORK-FIELDS.
021000*
021100     05  SOURCE-LINE.
021200         10  SOURCE-LINE-POSITION      PIC X
021300             OCCURS 66 TIMES
021400             INDEXED BY SOURCE-LINE-POSITION-INDEX.
021500     05  NEXT-SOURCE-WORD.
021600         10  SOURCE-WORD-POSITION      PIC X
021700             OCCURS 30 TIMES
021800             INDEXED BY SOURCE-WORD-POSITION-INDEX.
021900     05  SOURCE-WORDS.
022000         10  SOURCE-WORD               PIC X(30)
022100             OCCURS 8 TIMES
022200             INDEXED BY SOURCE-WORD-INDEX.
022300     05  SOURCE-WORD-COUNT             PIC S9      COMP.
022400*
022500 01  PROGRAM-CONTROL-SWITCHES.
022600*
022700     05  PARAGRAPH-MODULES-SW          PIC X       VALUE "Y".
022800         88  PARAGRAPH-MODULES                     VALUE "Y".
022900         88  SECTION-MODULES                       VALUE "N".
023000     05  SRCEFILE-EOF-SW               PIC X       VALUE "N".
023100         88  SRCEFILE-EOF                          VALUE "Y".
023200     05  ACTIVE-RECORD-SW              PIC X.
023300         88  ACTIVE-RECORD                         VALUE "Y".
023400     05  CANCEL-PROGRAM-SW             PIC X       VALUE "N".
023500         88  CANCEL-PROGRAM                        VALUE "Y".
023600     05  COUNT-LINES-SW                PIC X       VALUE "Y".
023700         88  COUNT-LINES                           VALUE "Y".
023800     05  PROCEDURE-DIVISION-SW         PIC X       VALUE "N".
023900         88  PROCEDURE-DIVISION                    VALUE "Y".
024000     05  DECLARATIVES-SECTION-SW       PIC X.
024100         88  DECLARATIVES-SECTION                  VALUE "Y".
024200     05  END-DECLARATIVES-SW           PIC X       VALUE "N".
024300         88  END-DECLARATIVES                      VALUE "Y".
024400     05  FIRST-MODULE-NAME-SW          PIC X       VALUE "Y".
024500         88  FIRST-MODULE-NAME                     VALUE "Y".
024600     05  NEXT-PROCEDURE-NAME-SW        PIC X.
024700         88  NEXT-PROCEDURE-NAME                   VALUE "Y".
024800     05  DUPLICATE-CALL-SW             PIC X       VALUE "N".
024900         88  DUPLICATE-CALL                        VALUE "Y".
025000*
025100 01  SEARCH-SWITCHES.
025200*
025300     05  FOUND-SW                      PIC X.
025400         88  FOUND                                 VALUE "Y".
025500     05  PERFORM-FOUND-SW              PIC X       VALUE "N".
025600         88  PERFORM-FOUND                         VALUE "Y".
025700     05  CALL-FOUND-SW                 PIC X       VALUE "N".
025800         88  CALL-FOUND                            VALUE "Y".
025900     05  SORT-FOUND-SW                 PIC X       VALUE "N".
026000         88  SORT-FOUND                            VALUE "Y".
026100     05  MERGE-FOUND-SW                PIC X       VALUE "N".
026200         88  MERGE-FOUND                           VALUE "Y".
026300     05  INPUT-PROCEDURE-FOUND-SW      PIC X       VALUE "N".
026400         88  INPUT-PROCEDURE-FOUND                 VALUE "Y".
026500     05  OUTPUT-PROCEDURE-FOUND-SW     PIC X       VALUE "N".
026600         88  OUTPUT-PROCEDURE-FOUND                VALUE "Y".
026700     05  GOTO-FOUND-SW                 PIC X       VALUE "N".
026800         88  GOTO-FOUND                            VALUE "Y".
026900     05  USE-STATEMENT-SW              PIC X       VALUE "N".
027000         88  USE-STATEMENT                         VALUE "Y".
027100*
027200 01  SUMMARY-SWITCHES.
027300*
027400     05  TABLE-OVERFLOW-SW             PIC X       VALUE "N".
027500         88  TABLE-OVERFLOW                        VALUE "Y".
027600     05  MODULE-CALL-OVERFLOW-SW       PIC X       VALUE "N".
027700         88  CALL-OVERFLOW                         VALUE "Y".
027800     05  LEVEL-OVERFLOW-SW             PIC X       VALUE "N".
027900         88  LEVEL-OVERFLOW                        VALUE "Y".
028000     05  PRINT-UNCALLED-MODULES-SW     PIC X       VALUE "N".
028100         88  PRINT-UNCALLED-MODULES                VALUE "Y".
028200     05  PRINT-CALLED-SUBPROGRAMS-SW   PIC X       VALUE "N".
028300         88  PRINT-CALLED-SUBPROGRAMS              VALUE "Y".
028400*
028500 01  DATE-FIELDS.
028600*
028700     05  SYSTEM-DATE         PIC 9(6).
028800     05  SYSTEM-DATE-R       REDEFINES SYSTEM-DATE.
028900         10  SYSTEM-YEAR     PIC 99.
029000         10  SYSTEM-MONTH    PIC 99.
029100         10  SYSTEM-DAY      PIC 99.
029200     05  TODAYS-DATE         PIC 9(6).
029300     05  TODAYS-DATE-R       REDEFINES TODAYS-DATE.
029400         10  TODAYS-MONTH    PIC 99.
029500         10  TODAYS-DAY      PIC 99.
029600         10  TODAYS-YEAR     PIC 99.
029700*
029800 01  TIME-FIELDS.
029900*
030000     05  SYSTEM-TIME             PIC 9(8).
030100     05  SYSTEM-TIME-R           REDEFINES SYSTEM-TIME.
030200         10  SYSTEM-HOUR         PIC 99.
030300         10  SYSTEM-MINUTE       PIC 99.
030400         10  SYSTEM-SECOND       PIC 99.
030500         10  SYSTEM-HUNDREDTH    PIC 99.
030600*
030700 01  COUNT-FIELDS                   COMP.
030800*
030900     05  TOTAL-LINE-COUNT           PIC S9(5)    VALUE ZERO.
031000     05  SOURCE-LINE-COUNT          PIC S9(5)    VALUE ZERO.
031100     05  PD-LINE-COUNT              PIC S9(5)    VALUE ZERO.
031200     05  MODULE-COUNT               PIC S9(3)    VALUE ZERO.
031300     05  COBOL-MODULE-COUNT         PIC S9(3)    VALUE ZERO.
031400     05  COBOL-PARAGRAPH-COUNT      PIC S9(3)    VALUE ZERO.
031500     05  COBOL-SECTION-COUNT        PIC S9(3)    VALUE ZERO.
031600     05  SUBPROGRAM-COUNT           PIC S9(3)    VALUE ZERO.
031700     05  RESTART-COUNT              PIC S9(5)    VALUE ZERO.
031800     05  PERFORM-COUNT              PIC S9(3)    VALUE ZERO.
031900     05  INLINE-PERFORM-COUNT       PIC S9(3)    VALUE ZERO.
032000     05  CALL-COUNT                 PIC S9(3)    VALUE ZERO.
032100     05  SORT-COUNT                 PIC S9(3)    VALUE ZERO.
032200     05  MERGE-COUNT                PIC S9(3)    VALUE ZERO.
032300     05  SORT-MERGE-PROCEDURE-COUNT PIC S9(3)    VALUE ZERO.
032400     05  GOTO-COUNT                 PIC S9(3)    VALUE ZERO.
032500     05  NUMBER-OF-CALLS            PIC S9(3)    VALUE ZERO.
032600     05  PERIOD-COUNT               PIC S9       VALUE ZERO.
032700*
032800 01  RECORD-LOCATOR-NUMBERS          COMP.
032900*
033000     05  FIRST-PD-RECORD-NO          PIC S9(5)   VALUE ZERO.
033100     05  FIRST-DECLARATIVE-RECORD-NO PIC S9(5)   VALUE ZERO.
033200     05  LAST-DECLARATIVE-RECORD-NO  PIC S9(5)   VALUE ZERO.
033300     05  FIRST-PROC-NAME-RECORD-NO   PIC S9(5)   VALUE ZERO.
033400*
033500 01  SAVE-AREAS.
033600*
033700     05  PRINT-SAVE-AREA             PIC X(132).
033800     05  INDEX-SAVE-AREA             INDEX.
033900     05  CALLED-MODULE-SAVE-AREA     PIC S9(3)   COMP.
034000*
034100 01  SEARCH-FIELDS.
034200*
034300     05  CALLED-PROC-NAME            PIC X(30).
034400     05  CALLED-PROC-NUMBER          PIC S9(3)   COMP.
034500*
034600 01  INDEX-DATA-FIELDS   INDEX.
034700*
034800     05  MODULE-INDEX-SAVE-AREA-1.
034900     05  MODULE-INDEX-SAVE-AREA-2.
035000     05  MODULE-INDEX-SAVE-AREA-3.
035100     05  MODULE-INDEX-SAVE-AREA-4.
035200     05  MODULE-INDEX-SAVE-AREA-5.
035300     05  MODULE-INDEX-SAVE-AREA-6.
035400     05  MODULE-INDEX-SAVE-AREA-7.
035500     05  MODULE-INDEX-SAVE-AREA-8.
035600     05  MODULE-INDEX-SAVE-AREA-9.
035700     05  MODULE-INDEX-SAVE-AREA-10.
035800     05  MODULE-INDEX-SAVE-AREA-11.
035900     05  MODULE-INDEX-SAVE-AREA-12.
036000     05  MODULE-INDEX-SAVE-AREA-13.
036100     05  MODULE-INDEX-SAVE-AREA-14.
036200     05  MODULE-INDEX-SAVE-AREA-15.
036300     05  MODULE-INDEX-SAVE-AREA-16.
036400     05  MODULE-INDEX-SAVE-AREA-17.
036500     05  MODULE-INDEX-SAVE-AREA-18.
036600     05  MODULE-INDEX-SAVE-AREA-19.
036700     05  MODULE-INDEX-SAVE-AREA-20.
036800     05  MODULE-INDEX-SAVE-AREA-21.
036900     05  MODULE-INDEX-SAVE-AREA-22.
037000     05  MODULE-INDEX-SAVE-AREA-23.
037100     05  MODULE-INDEX-SAVE-AREA-24.
037200*
037300     05  CALL-INDEX-SAVE-AREA-1.
037400     05  CALL-INDEX-SAVE-AREA-2.
037500     05  CALL-INDEX-SAVE-AREA-3.
037600     05  CALL-INDEX-SAVE-AREA-4.
037700     05  CALL-INDEX-SAVE-AREA-5.
037800     05  CALL-INDEX-SAVE-AREA-6.
037900     05  CALL-INDEX-SAVE-AREA-7.
038000     05  CALL-INDEX-SAVE-AREA-8.
038100     05  CALL-INDEX-SAVE-AREA-9.
038200     05  CALL-INDEX-SAVE-AREA-10.
038300     05  CALL-INDEX-SAVE-AREA-11.
038400     05  CALL-INDEX-SAVE-AREA-12.
038500     05  CALL-INDEX-SAVE-AREA-13.
038600     05  CALL-INDEX-SAVE-AREA-14.
038700     05  CALL-INDEX-SAVE-AREA-15.
038800     05  CALL-INDEX-SAVE-AREA-16.
038900     05  CALL-INDEX-SAVE-AREA-17.
039000     05  CALL-INDEX-SAVE-AREA-18.
039100     05  CALL-INDEX-SAVE-AREA-19.
039200     05  CALL-INDEX-SAVE-AREA-20.
039300     05  CALL-INDEX-SAVE-AREA-21.
039400     05  CALL-INDEX-SAVE-AREA-22.
039500     05  CALL-INDEX-SAVE-AREA-23.
039600*
039700 01  PRINT-FIELDS                COMP.
039800*
039900     05  LINE-COUNT              PIC S9(3)  VALUE +99.
040000     05  LINES-ON-PAGE           PIC S9(3)  VALUE +55.
040100     05  PAGE-COUNT              PIC S9(3)  VALUE ZERO.
040200     05  SPACE-CONTROL           PIC S9.
040300*
040400 01  ERROR-MESSAGES.
040500*
040600     05  NO-PROGRAM-ID-MESSAGE.
040700*
040800         10  FILLER    PIC X(20)   VALUE "PROGRAM-ID NOT FOUND".
040900         10  FILLER    PIC X(20)   VALUE " -- PROGRAM TERMINAT".
041000         10  FILLER    PIC X(20)   VALUE "ED.                 ".
041100*
041200     05  NO-PROCEDURE-DIVISION-MESSAGE.
041300*
041400         10  FILLER    PIC X(20)   VALUE "PROCEDURE DIVISION N".
041500         10  FILLER    PIC X(20)   VALUE "OT FOUND -- PROGRAM ".
041600         10  FILLER    PIC X(20)   VALUE "TERMINATED.         ".
041700*
041800     05  NO-END-DECLARATIVES-MESSAGE.
041900*
042000         10  FILLER    PIC X(20)   VALUE "END DECLARATIVES NOT".
042100         10  FILLER    PIC X(20)   VALUE " FOUND -- PROGRAM TE".
042200         10  FILLER    PIC X(20)   VALUE "RMINATED.           ".
042300*
042400     05  TABLE-OVERFLOW-MESSAGE-1.
042500*
042600         10  FILLER    PIC X(20)   VALUE "PROGRAM EXCEEDS MODU".
042700         10  FILLER    PIC X(20)   VALUE "LE LIMIT -- LISTMODS".
042800         10  FILLER    PIC X(20)   VALUE " CANNOT EXECUTE.    ".
042900*
043000     05  TABLE-OVERFLOW-MESSAGE-2.
043100*
043200         10  FILLER    PIC X(20)   VALUE "PROGRAM EXCEEDS MODU".
043300         10  FILLER    PIC X(20)   VALUE "LE LIMIT SO ALL SUBP".
043400         10  FILLER    PIC X(20)   VALUE "ROGRAMS OR SORT/MERG".
043500         10  FILLER    PIC X(20)   VALUE "E MODULES AREN""T LIS".
043600         10  FILLER    PIC X(20)   VALUE "TED.                ".
043700*
043800     05  CALL-OVERFLOW-MESSAGE.
043900*
044000         10  FILLER    PIC X(20)   VALUE "** CALL OVERFLOW:  O".
044100         10  FILLER    PIC X(20)   VALUE "NE OR MORE MODULES E".
044200         10  FILLER    PIC X(20)   VALUE "XCEED THE CALL LIMIT".
044300         10  FILLER    PIC X(20)   VALUE ".                   ".
044400*
044500     05  LEVEL-OVERFLOW-MESSAGE.
044600*
044700         10  FILLER    PIC X(20)   VALUE "** LEVEL OVERFLOW:  ".
044800         10  FILLER    PIC X(20)   VALUE "PROGRAM CONTAINS OVE".
044900         10  FILLER    PIC X(20)   VALUE "R 25 LEVELS OF CALLS".
045000         10  FILLER    PIC X(20)   VALUE ", BUT ONLY 25 CAN BE".
045100         10  FILLER    PIC X(20)   VALUE " PRINTED.           ".
045200*
045300 01  SUMMARY-HEADINGS.
045400*
045500     05  DECLARATIVES-HEADING       PIC X(30)
045600         VALUE "DECLARATIVES SUMMARY ---------".
045700     05  ERROR-MESSAGES-HEADING     PIC X(30)
045800         VALUE "ERROR MESSAGES ---------------".
045900     05  UNCALLED-MODULES-HEADING   PIC X(30)
046000         VALUE "UNCALLED MODULES -------------".
046100     05  CALLED-SUBPROGRAMS-HEADING PIC X(30)
046200         VALUE "CALLED SUBPROGRAMS -----------".
046300     05  PROGRAM-STATISTICS-HEADING PIC X(30)
046400         VALUE "PROGRAM STATISTICS -----------".
046500*
046600 01  HEADING-LINE-1.
046700*
046800     05  FILLER               PIC X(15)   VALUE "DATE AND TIME:".
046900     05  HDG1-DATE            PIC 99/99/99.
047000     05  FILLER               PIC XX      VALUE SPACE.
047100     05  HDG2-TIME-DATA.
047200         10  HDG2-HOURS       PIC XX.
047300         10  FILLER           PIC X       VALUE ":".
047400         10  HDG2-MINUTES     PIC XX.
047500         10  FILLER           PIC X       VALUE SPACE.
047600         10  HDG2-TIME-SUFFIX PIC X(8).
047700     05  FILLER               PIC X(84)   VALUE SPACE.
047800     05  FILLER               PIC X(6)    VALUE "PAGE:".
047900     05  HDG1-PAGE-NUMBER     PIC ZZ9.
048000*
048100 01  HEADING-LINE-2.
048200*
048300     05  FILLER               PIC X(15)   VALUE "PROGRAM-ID:".
048400     05  HDG2-PROGRAM-NAME    PIC X(30).
048500     05  FILLER               PIC X(87)   VALUE SPACE.
048600*
048700 01  SUMMARY-HEADING-LINE.
048800*
048900     05  SHL-HEADING     PIC X(30).
049000     05  FILLER          PIC X(20)   VALUE "--------------------".
049100     05  FILLER          PIC X(20)   VALUE "--------------------".
049200     05  FILLER          PIC X(20)   VALUE "--------------------".
049300     05  FILLER          PIC X(20)   VALUE "--------------------".
049400     05  FILLER          PIC X(20)   VALUE "--------------------".
049500     05  FILLER          PIC X(2)    VALUE "--".
049600*
049700 PROCEDURE DIVISION.
049800*
049900 0000-PRINT-STRUCTURE-LISTING.
050000*
050100     OPEN INPUT  SRCEFILE
050200          OUTPUT MODLIST.
050300     PERFORM 1000-GET-HEADING-DATA.
050400     IF NOT CANCEL-PROGRAM
050500         PERFORM 2000-LOCATE-FIRST-PROCEDURE
050600         IF NOT CANCEL-PROGRAM
050700             PERFORM 3000-LOAD-MODULE-NAMES
050800             IF NOT CANCEL-PROGRAM
050900                 PERFORM 4000-LOAD-MODULE-CALLS
051000                 PERFORM 5000-PRINT-STRUCTURE-LISTING
051100                 IF DECLARATIVES-SECTION                          DEC
051200                     PERFORM 6000-PRINT-DECLARATIVES              DEC
051300                     PERFORM 7000-PRINT-PROGRAM-SUMMARY           DEC
051400                 ELSE                                             DEC
051500                     PERFORM 7000-PRINT-PROGRAM-SUMMARY.
051600     CLOSE SRCEFILE
051700           MODLIST.
051800     STOP RUN.
051900*
052000 1000-GET-HEADING-DATA.
052100*
052200     ACCEPT SYSTEM-DATE FROM DATE.
052300     MOVE SYSTEM-YEAR   TO TODAYS-YEAR.
052400     MOVE SYSTEM-MONTH  TO TODAYS-MONTH.
052500     MOVE SYSTEM-DAY    TO TODAYS-DAY.
052600     MOVE TODAYS-DATE   TO HDG1-DATE.
052700*
052800     ACCEPT SYSTEM-TIME FROM TIME.
052900     IF SYSTEM-HOUR LESS 12
053000         MOVE "AM" TO HDG2-TIME-SUFFIX
053100     ELSE
053200         MOVE "PM" TO HDG2-TIME-SUFFIX
053300         IF SYSTEM-HOUR GREATER 12
053400             SUBTRACT 12 FROM SYSTEM-HOUR.
053500     MOVE SYSTEM-HOUR   TO HDG2-HOURS.
053600     MOVE SYSTEM-MINUTE TO HDG2-MINUTES.
053700*
053800     PERFORM 1100-GET-PROGRAM-NAME
053900         UNTIL FOUND
054000            OR CANCEL-PROGRAM.
054100*
054200 1100-GET-PROGRAM-NAME.
054300*
054400     MOVE "N" TO ACTIVE-RECORD-SW.
054500     PERFORM 1110-READ-SOURCE-FILE
054600         UNTIL SRCEFILE-EOF
054700            OR (ACTIVE-RECORD AND A-AREA NOT = SPACE).
054800     IF NOT SRCEFILE-EOF
054900         PERFORM 1130-UNSTRING-SOURCE-LINE
055000         IF SOURCE-WORD (1) = "PROGRAM-ID"
055100             MOVE SOURCE-WORD (2) TO HDG2-PROGRAM-NAME
055200             MOVE "Y" TO FOUND-SW
055300         ELSE
055400             MOVE "N" TO FOUND-SW
055500     ELSE
055600         MOVE "Y" TO CANCEL-PROGRAM-SW
055700         MOVE SPACE TO HDG2-PROGRAM-NAME
055800         MOVE NO-PROGRAM-ID-MESSAGE TO PRINT-LINE
055900         PERFORM 1180-PRINT-REPORT-LINE.
056000*
056100 1110-READ-SOURCE-FILE.
056200*
056300     READ SRCEFILE
056400         AT END
056500             MOVE "Y" TO SRCEFILE-EOF-SW.
056600     IF    COMMENT
056700        OR BLANK-LINE
056800         MOVE "N" TO ACTIVE-RECORD-SW
056900     ELSE
057000         MOVE "Y" TO ACTIVE-RECORD-SW.
057100     IF NOT SRCEFILE-EOF
057200         IF COUNT-LINES
057300             PERFORM 1120-ACCUMULATE-RECORD-COUNTS.
057400*
057500 1120-ACCUMULATE-RECORD-COUNTS.
057600*
057700     ADD 1 TO TOTAL-LINE-COUNT.
057800     IF ACTIVE-RECORD
057900         ADD 1 TO SOURCE-LINE-COUNT
058000         IF PROCEDURE-DIVISION
058100             ADD 1 TO PD-LINE-COUNT.
058200*
058300 1130-UNSTRING-SOURCE-LINE.
058400*
058500     MOVE DATA-AREA TO SOURCE-LINE.
058600     INSPECT SOURCE-LINE REPLACING ALL "," BY " ".
058700     INSPECT SOURCE-LINE REPLACING ALL "." BY " ".
058800     MOVE SPACE TO SOURCE-WORDS.
058900     SET SOURCE-LINE-POSITION-INDEX TO 1.
059000     SET SOURCE-WORD-INDEX TO 1.
059100     PERFORM 1140-UNSTRING-NEXT-WORD
059200         UNTIL SOURCE-WORD-INDEX > 8
059300            OR SOURCE-LINE-POSITION-INDEX > 65.
059400*
059500 1140-UNSTRING-NEXT-WORD.
059600*
059700     MOVE SPACE TO NEXT-SOURCE-WORD.
059800*
059900     PERFORM 1150-FIND-NEXT-SOURCE-WORD
060000         UNTIL SOURCE-LINE-POSITION (SOURCE-LINE-POSITION-INDEX)
060100               NOT = SPACE
060200            OR SOURCE-LINE-POSITION-INDEX > 65.
060300*
060400     IF SOURCE-LINE-POSITION (SOURCE-LINE-POSITION-INDEX) = QUOTE
060500         IF SOURCE-WORD-INDEX NOT = 1
060600             SET SOURCE-WORD-INDEX DOWN BY 1
060700             IF SOURCE-WORD (SOURCE-WORD-INDEX) = "CALL"
060800                 SET SOURCE-WORD-INDEX UP BY 1
060900             ELSE
061000                 SET SOURCE-WORD-INDEX UP BY 1
061100                 SET SOURCE-LINE-POSITION-INDEX UP BY 1
061200                 PERFORM 1160-FIND-LITERAL-ENDING
061300                     UNTIL SOURCE-LINE-POSITION
061400                           (SOURCE-LINE-POSITION-INDEX) = QUOTE
061500                        OR SOURCE-LINE-POSITION-INDEX > 65
061600                 IF SOURCE-LINE-POSITION-INDEX < 66
061700                     SET SOURCE-LINE-POSITION-INDEX UP BY 1.
061800*
061900     PERFORM 1170-BUILD-NEXT-SOURCE-WORD
062000         VARYING SOURCE-WORD-POSITION-INDEX FROM 1 BY 1
062100           UNTIL SOURCE-LINE-POSITION (SOURCE-LINE-POSITION-INDEX)
062200                = SPACE
062300              OR SOURCE-LINE-POSITION-INDEX > 65.
062400*
062500     IF NEXT-SOURCE-WORD NOT = SPACE
062600         MOVE NEXT-SOURCE-WORD TO SOURCE-WORD (SOURCE-WORD-INDEX)
062700         SET SOURCE-WORD-COUNT TO SOURCE-WORD-INDEX
062800         SET SOURCE-WORD-INDEX UP BY 1.
062900*
063000 1150-FIND-NEXT-SOURCE-WORD.
063100*
063200     SET SOURCE-LINE-POSITION-INDEX UP BY 1.
063300*
063400 1160-FIND-LITERAL-ENDING.
063500*
063600     SET SOURCE-LINE-POSITION-INDEX UP BY 1.
063700*
063800 1170-BUILD-NEXT-SOURCE-WORD.
063900*
064000     MOVE SOURCE-LINE-POSITION (SOURCE-LINE-POSITION-INDEX)
064100         TO SOURCE-WORD-POSITION (SOURCE-WORD-POSITION-INDEX).
064200     SET SOURCE-LINE-POSITION-INDEX UP BY 1.
064300*
064400 1180-PRINT-REPORT-LINE.
064500*
064600     IF LINE-COUNT > LINES-ON-PAGE
064700         PERFORM 1190-PRINT-HEADING-LINES
064800         PERFORM 1210-WRITE-REPORT-LINE
064900     ELSE
065000         PERFORM 1210-WRITE-REPORT-LINE.
065100     MOVE SPACE TO PRINT-AREA.
065200*
065300 1190-PRINT-HEADING-LINES.
065400*
065500     MOVE PRINT-LINE      TO PRINT-SAVE-AREA.
065600     ADD 1                TO PAGE-COUNT.
065700     MOVE PAGE-COUNT      TO HDG1-PAGE-NUMBER.
065800     MOVE HEADING-LINE-1  TO PRINT-LINE.
065900     PERFORM 1200-WRITE-PAGE-TOP-LINE.
066000     MOVE 1               TO SPACE-CONTROL.
066100     MOVE HEADING-LINE-2  TO PRINT-LINE.
066200     PERFORM 1210-WRITE-REPORT-LINE.
066300     MOVE 2               TO SPACE-CONTROL.
066400     MOVE ZERO            TO LINE-COUNT.
066500     MOVE PRINT-SAVE-AREA TO PRINT-LINE.
066600*
066700 1200-WRITE-PAGE-TOP-LINE.
066800*
066900     WRITE PRINT-AREA
067000         AFTER ADVANCING PAGE.
067100*
067200 1210-WRITE-REPORT-LINE.
067300*
067400     WRITE PRINT-AREA
067500         AFTER ADVANCING SPACE-CONTROL LINES.
067600     ADD SPACE-CONTROL TO LINE-COUNT.
067700     MOVE 1            TO SPACE-CONTROL.
067800*
067900 2000-LOCATE-FIRST-PROCEDURE.
068000*
068100     PERFORM 2100-LOCATE-PD-HEADER
068200         UNTIL PROCEDURE-DIVISION
068300            OR CANCEL-PROGRAM.
068400     IF NOT CANCEL-PROGRAM
068500         PERFORM 2200-LOCATE-DECLARATIVES
068600         IF NOT CANCEL-PROGRAM
068700             PERFORM 2300-LOCATE-FIRST-PROC-NAME.
068800*
068900 2100-LOCATE-PD-HEADER.
069000*
069100     MOVE "N" TO ACTIVE-RECORD-SW.
069200     PERFORM 1110-READ-SOURCE-FILE
069300         UNTIL SRCEFILE-EOF
069400            OR (ACTIVE-RECORD AND A-AREA NOT = SPACE).
069500     IF NOT SRCEFILE-EOF
069600         PERFORM 1130-UNSTRING-SOURCE-LINE
069700         IF SOURCE-WORD (1) = "PROCEDURE"
069800             MOVE TOTAL-LINE-COUNT TO FIRST-PD-RECORD-NO
069900             MOVE "Y" TO PROCEDURE-DIVISION-SW
070000             ADD 1 TO PD-LINE-COUNT
070100         ELSE
070200             MOVE "N" TO PROCEDURE-DIVISION-SW
070300     ELSE
070400         MOVE "Y" TO CANCEL-PROGRAM-SW
070500         MOVE NO-PROCEDURE-DIVISION-MESSAGE TO PRINT-LINE
070600         PERFORM 1180-PRINT-REPORT-LINE.
070700*
070800 2200-LOCATE-DECLARATIVES.
070900*
071000     MOVE "N" TO ACTIVE-RECORD-SW.
071100     PERFORM 1110-READ-SOURCE-FILE
071200         UNTIL SRCEFILE-EOF
071300            OR (ACTIVE-RECORD AND A-AREA NOT = SPACE).
071400     PERFORM 1130-UNSTRING-SOURCE-LINE.
071500     IF SOURCE-WORD (1) = "DECLARATIVES"
071600         MOVE TOTAL-LINE-COUNT TO FIRST-DECLARATIVE-RECORD-NO
071700         MOVE "Y" TO DECLARATIVES-SECTION-SW
071800     ELSE
071900         MOVE "N" TO DECLARATIVES-SECTION-SW.
072000     IF DECLARATIVES-SECTION
072100         PERFORM 2210-LOCATE-END-DECLARATIVES
072200             UNTIL END-DECLARATIVES
072300                OR CANCEL-PROGRAM.
072400*
072500 2210-LOCATE-END-DECLARATIVES.
072600*
072700     MOVE "N" TO ACTIVE-RECORD-SW.
072800     PERFORM 1110-READ-SOURCE-FILE
072900         UNTIL SRCEFILE-EOF
073000            OR (ACTIVE-RECORD AND A-AREA NOT = SPACE).
073100     PERFORM 1130-UNSTRING-SOURCE-LINE.
073200     IF SRCEFILE-EOF
073300         MOVE "Y" TO CANCEL-PROGRAM-SW
073400         MOVE NO-END-DECLARATIVES-MESSAGE TO PRINT-LINE
073500         PERFORM 1180-PRINT-REPORT-LINE
073600     ELSE
073700         IF SOURCE-WORD (1) = "END"
073800              MOVE TOTAL-LINE-COUNT TO LAST-DECLARATIVE-RECORD-NO
073900              MOVE "Y" TO END-DECLARATIVES-SW.
074000*
074100 2300-LOCATE-FIRST-PROC-NAME.
074200*
074300     IF DECLARATIVES-SECTION
074400         MOVE "N" TO ACTIVE-RECORD-SW
074500         PERFORM 1110-READ-SOURCE-FILE
074600             UNTIL SRCEFILE-EOF
074700                OR (ACTIVE-RECORD AND A-AREA NOT = SPACE).
074800     IF NOT SRCEFILE-EOF
074900         MOVE TOTAL-LINE-COUNT TO FIRST-PROC-NAME-RECORD-NO.
075000*
075100 3000-LOAD-MODULE-NAMES.
075200*
075300     PERFORM 3100-CLEAR-MODULE-TABLE
075400         VARYING MODULE-INDEX FROM 1 BY 1
075500         UNTIL MODULE-INDEX > MODULE-LIMIT.
075600     SET MODULE-INDEX TO 1.
075700     PERFORM 3200-LOAD-MODULE-NAME
075800         UNTIL SRCEFILE-EOF
075900            OR TABLE-OVERFLOW.
076000     IF TABLE-OVERFLOW
076100         MOVE "Y" TO CANCEL-PROGRAM-SW
076200         MOVE TABLE-OVERFLOW-MESSAGE-1 TO PRINT-LINE
076300         PERFORM 1180-PRINT-REPORT-LINE
076400     ELSE
076500         SET MODULE-INDEX DOWN BY 1
076600         SET MODULE-COUNT TO MODULE-INDEX.
076700*
076800 3100-CLEAR-MODULE-TABLE.
076900*
077000     MOVE ZERO  TO MODULE-NUMBER (MODULE-INDEX).
077100     MOVE SPACE TO FULL-MODULE-NAME (MODULE-INDEX)
077200                   MODULE-TYPE-FLAG (MODULE-INDEX).
077300     MOVE "N"   TO CALL-OVERFLOW-SW (MODULE-INDEX)
077400                   MODULE-PRINTED-SW (MODULE-INDEX).
077500     MOVE ZERO  TO TIMES-CALLED (MODULE-INDEX).
077600     MOVE ZERO  TO MODULE-CALL-COUNT (MODULE-INDEX).
077700     PERFORM 3110-CLEAR-MODULE-CALLS
077800         VARYING CALL-INDEX FROM 1 BY 1
077900         UNTIL CALL-INDEX > CALL-LIMIT.
078000*
078100 3110-CLEAR-MODULE-CALLS.
078200*
078300     MOVE ZERO
078400         TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX).
078500*
078600 3200-LOAD-MODULE-NAME.
078700*
078800     MOVE "N" TO ACTIVE-RECORD-SW.
078900     IF FIRST-MODULE-NAME
079000         MOVE "N" TO FIRST-MODULE-NAME-SW
079100     ELSE
079200         PERFORM 1110-READ-SOURCE-FILE
079300             UNTIL SRCEFILE-EOF
079400                OR (ACTIVE-RECORD AND A-AREA NOT = SPACE).
079500     IF NOT SRCEFILE-EOF
079600         IF PARAGRAPH-MODULES
079700             IF MODULE-INDEX NOT > MODULE-LIMIT
079800                PERFORM 1130-UNSTRING-SOURCE-LINE
079900                SET MODULE-NUMBER (MODULE-INDEX) TO MODULE-INDEX
080000                MOVE SOURCE-WORD (1) TO MODULE-NAME (MODULE-INDEX)
080100                ADD 1 TO COBOL-MODULE-COUNT
080200                IF SOURCE-WORD (2) = "SECTION"
080300                    MOVE "X" TO MODULE-TYPE-FLAG (MODULE-INDEX)
080400                    ADD 1 TO COBOL-SECTION-COUNT
080500                    SET MODULE-INDEX UP BY 1
080600                ELSE
080700                    MOVE "P" TO MODULE-TYPE-FLAG (MODULE-INDEX)
080800                    ADD 1 TO COBOL-PARAGRAPH-COUNT
080900                    SET MODULE-INDEX UP BY 1
081000             ELSE
081100                 MOVE "Y" TO TABLE-OVERFLOW-SW.
081200     IF NOT SRCEFILE-EOF
081300         IF SECTION-MODULES
081400             PERFORM 1130-UNSTRING-SOURCE-LINE
081500             IF SOURCE-WORD (2) = "SECTION"
081600                 IF MODULE-INDEX NOT > MODULE-LIMIT
081700                     MOVE "X" TO MODULE-TYPE-FLAG (MODULE-INDEX)
081800                     SET MODULE-NUMBER (MODULE-INDEX)
081900                         TO MODULE-INDEX
082000                     MOVE SOURCE-WORD (1)
082100                         TO MODULE-NAME (MODULE-INDEX)
082200                     ADD 1 TO COBOL-SECTION-COUNT
082300                     ADD 1 TO COBOL-MODULE-COUNT
082400                     SET MODULE-INDEX UP BY 1
082500                 ELSE
082600                     MOVE "Y" TO TABLE-OVERFLOW-SW
082700             ELSE
082800                 ADD 1 TO COBOL-PARAGRAPH-COUNT.
082900*
083000 4000-LOAD-MODULE-CALLS.
083100*
083200     MOVE "N" TO COUNT-LINES-SW.
083300     MOVE "N" TO SRCEFILE-EOF-SW.
083400     PERFORM 4100-RESTART-PROC-DIVISION.
083500     PERFORM 4200-LOAD-CALLS-FOR-ONE-MODULE
083600         VARYING MODULE-INDEX FROM 1 BY 1
083700         UNTIL MODULE-INDEX > MODULE-COUNT.
083800     PERFORM 4800-COUNT-MODULE-CALLS.
083900*
084000 4100-RESTART-PROC-DIVISION.
084100*
084200     CLOSE SRCEFILE.
084300     OPEN INPUT SRCEFILE.
084400     PERFORM 1110-READ-SOURCE-FILE
084500         VARYING RESTART-COUNT FROM 1 BY 1
084600         UNTIL RESTART-COUNT > FIRST-PROC-NAME-RECORD-NO.
084700*
084800 4200-LOAD-CALLS-FOR-ONE-MODULE.
084900*
085000     MOVE "N" TO NEXT-PROCEDURE-NAME-SW.
085100     SET CALL-INDEX TO 1.
085200     PERFORM 4210-LOAD-ONE-MODULE-CALL
085300         UNTIL SRCEFILE-EOF
085400            OR NEXT-PROCEDURE-NAME.
085500*
085600 4210-LOAD-ONE-MODULE-CALL.
085700*
085800     MOVE "N" TO ACTIVE-RECORD-SW.
085900     PERFORM 1110-READ-SOURCE-FILE
086000         UNTIL SRCEFILE-EOF
086100            OR ACTIVE-RECORD.
086200     IF NOT SRCEFILE-EOF
086300         PERFORM 1130-UNSTRING-SOURCE-LINE
086400         IF A-AREA = SPACE
086500             MOVE "N" TO PERFORM-FOUND-SW
086600             MOVE "N" TO CALL-FOUND-SW
086700             MOVE "N" TO SORT-FOUND-SW
086800             MOVE "N" TO MERGE-FOUND-SW
086900             MOVE "N" TO INPUT-PROCEDURE-FOUND-SW
087000             MOVE "N" TO OUTPUT-PROCEDURE-FOUND-SW
087100             MOVE "N" TO GOTO-FOUND-SW
087200             PERFORM 4220-SEARCH-FOR-CALLING-VERB
087300                 VARYING SOURCE-WORD-INDEX FROM 1 BY 1
087400                 UNTIL SOURCE-WORD-INDEX > SOURCE-WORD-COUNT
087500                    OR PERFORM-FOUND
087600                    OR CALL-FOUND
087700                    OR SORT-FOUND
087800                    OR MERGE-FOUND
087900                    OR INPUT-PROCEDURE-FOUND
088000                    OR OUTPUT-PROCEDURE-FOUND
088100                    OR GOTO-FOUND
088200         ELSE
088300             IF PARAGRAPH-MODULES
088400                 MOVE "Y" TO NEXT-PROCEDURE-NAME-SW
088500             ELSE
088600                 IF SOURCE-WORD (2) = "SECTION"
088700                     MOVE "Y" TO NEXT-PROCEDURE-NAME-SW.
088800     IF NOT SRCEFILE-EOF
088900         IF A-AREA = SPACE
089000             IF PERFORM-FOUND
089100                 PERFORM 4300-LOAD-PERFORMED-PROCEDURE
089200             ELSE IF CALL-FOUND
089300                 PERFORM 4400-LOAD-CALLED-PROCEDURE
089400             ELSE IF SORT-FOUND
089500                 PERFORM 4500-LOAD-SORT-MERGE-PROCEDURE
089600             ELSE IF MERGE-FOUND
089700                 PERFORM 4500-LOAD-SORT-MERGE-PROCEDURE
089800             ELSE IF INPUT-PROCEDURE-FOUND
089900                 PERFORM 4600-LOAD-INPUT-PROCEDURE
090000             ELSE IF OUTPUT-PROCEDURE-FOUND
090100                 PERFORM 4700-LOAD-OUTPUT-PROCEDURE.
090200*
090300 4220-SEARCH-FOR-CALLING-VERB.
090400*
090500     IF SOURCE-WORD (SOURCE-WORD-INDEX) = "PERFORM"
090600         ADD 1 TO PERFORM-COUNT
090700         MOVE "Y" TO PERFORM-FOUND-SW.
090800     IF SOURCE-WORD (SOURCE-WORD-INDEX) = "CALL"
090900         ADD 1 TO CALL-COUNT
091000         MOVE "Y" TO CALL-FOUND-SW.
091100     IF SOURCE-WORD (SOURCE-WORD-INDEX) = "SORT"
091200         ADD 1 TO SORT-COUNT
091300         MOVE "Y" TO SORT-FOUND-SW.
091400     IF SOURCE-WORD (SOURCE-WORD-INDEX) = "MERGE"
091500         ADD 1 TO MERGE-COUNT
091600         MOVE "Y" TO MERGE-FOUND-SW.
091700     IF SOURCE-WORD (SOURCE-WORD-INDEX) = "GO"
091800         ADD 1 TO GOTO-COUNT
091900         MOVE "Y" TO GOTO-FOUND-SW.
092000     IF SOURCE-WORD (SOURCE-WORD-INDEX) = "INPUT"
092100         SET SOURCE-WORD-INDEX UP BY 1
092200         IF SOURCE-WORD (SOURCE-WORD-INDEX) = "PROCEDURE"
092300             MOVE "Y" TO INPUT-PROCEDURE-FOUND-SW
092400             ADD 1 TO SORT-MERGE-PROCEDURE-COUNT
092500         ELSE
092600             SET SOURCE-WORD-INDEX DOWN BY 1.
092700     IF SOURCE-WORD (SOURCE-WORD-INDEX) = "OUTPUT"
092800         SET SOURCE-WORD-INDEX UP BY 1
092900             IF SOURCE-WORD (SOURCE-WORD-INDEX) = "PROCEDURE"
093000                 MOVE "Y" TO OUTPUT-PROCEDURE-FOUND-SW
093100                 ADD 1 TO SORT-MERGE-PROCEDURE-COUNT
093200             ELSE
093300                 SET SOURCE-WORD-INDEX DOWN BY 1.
093400*
093500 4300-LOAD-PERFORMED-PROCEDURE.
093600*
093700     IF SOURCE-WORD (SOURCE-WORD-INDEX) NOT = SPACE
093800         MOVE SOURCE-WORD (SOURCE-WORD-INDEX) TO CALLED-PROC-NAME
093900         PERFORM 4310-SEARCH-FOR-CALLED-MODULE
094000         IF FOUND
094100             PERFORM 4320-SEARCH-FOR-DUPLICATE-CALL
094200             IF NOT DUPLICATE-CALL
094300                 IF CALL-INDEX NOT > CALL-LIMIT
094400                     MOVE CALLED-PROC-NUMBER
094500                     TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX)
094600                     ADD 1 TO MODULE-CALL-COUNT (MODULE-INDEX)
094700                     SET CALL-INDEX UP BY 1
094800                 ELSE
094900                     MOVE "Y" TO MODULE-CALL-OVERFLOW-SW
095000                     MOVE "Y" TO CALL-OVERFLOW-SW (MODULE-INDEX)
095100                 END-IF
095200             END-IF
095300         ELSE
095400             ADD 1 TO INLINE-PERFORM-COUNT
095500         END-IF
095600     ELSE
095700*    IF SOURCE-WORD (SOURCE-WORD-INDEX) = SPACE
095800         ADD 1 TO INLINE-PERFORM-COUNT.
095900*
096000 4310-SEARCH-FOR-CALLED-MODULE.
096100*
096200     SET INDEX-SAVE-AREA TO MODULE-INDEX.
096300     SET MODULE-INDEX TO 1.
096400     SEARCH MODULE-ENTRY
096500         WHEN MODULE-NAME (MODULE-INDEX) = CALLED-PROC-NAME
096600             SET CALLED-PROC-NUMBER TO MODULE-INDEX
096700             MOVE "Y" TO FOUND-SW
096800         WHEN MODULE-INDEX = MODULE-COUNT
096900             MOVE "N" TO FOUND-SW.
097000     SET MODULE-INDEX TO INDEX-SAVE-AREA.
097100*
097200 4320-SEARCH-FOR-DUPLICATE-CALL.
097300*
097400     SET INDEX-SAVE-AREA TO CALL-INDEX.
097500     MOVE "N" TO DUPLICATE-CALL-SW.
097600     PERFORM 4330-SEARCH-CALL-AREA
097700         VARYING CALL-INDEX FROM 1 BY 1
097800         UNTIL CALL-INDEX > MODULE-CALL-COUNT (MODULE-INDEX)
097900            OR DUPLICATE-CALL.
098000     SET CALL-INDEX TO INDEX-SAVE-AREA.
098100*
098200 4330-SEARCH-CALL-AREA.
098300*
098400     IF CALLED-MODULE (MODULE-INDEX, CALL-INDEX)
098500             = CALLED-PROC-NUMBER
098600         MOVE "Y" TO DUPLICATE-CALL-SW.
098700*
098800 4400-LOAD-CALLED-PROCEDURE.
098900*
099000     MOVE SOURCE-WORD (SOURCE-WORD-INDEX) TO CALLED-PROC-NAME.
099100     PERFORM 4310-SEARCH-FOR-CALLED-MODULE.
099200     IF FOUND
099300         PERFORM 4320-SEARCH-FOR-DUPLICATE-CALL
099400         IF NOT DUPLICATE-CALL
099500             IF CALL-INDEX NOT > CALL-LIMIT
099600                 MOVE CALLED-PROC-NUMBER
099700                     TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX)
099800                 ADD 1 TO MODULE-CALL-COUNT (MODULE-INDEX)
099900                 SET CALL-INDEX UP BY 1
100000             ELSE
100100                 MOVE "Y" TO MODULE-CALL-OVERFLOW-SW
100200                 MOVE "Y" TO CALL-OVERFLOW-SW (MODULE-INDEX).
100300     IF NOT FOUND
100400         PERFORM 4410-LOAD-SUBPROGRAM-MODULE
100500         IF NOT TABLE-OVERFLOW
100600             IF CALL-INDEX NOT > CALL-LIMIT
100700                 MOVE CALLED-PROC-NUMBER
100800                     TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX)
100900                 ADD 1 TO MODULE-CALL-COUNT (MODULE-INDEX)
101000                 SET CALL-INDEX UP BY 1
101100             ELSE
101200                 MOVE "Y" TO MODULE-CALL-OVERFLOW-SW
101300                 MOVE "Y" TO CALL-OVERFLOW-SW (MODULE-INDEX).
101400*
101500 4410-LOAD-SUBPROGRAM-MODULE.
101600*
101700     SET INDEX-SAVE-AREA TO MODULE-INDEX.
101800     SET MODULE-INDEX TO MODULE-COUNT.
101900     SET MODULE-INDEX UP BY 1.
102000     IF MODULE-INDEX NOT > MODULE-LIMIT
102100         SET MODULE-NUMBER (MODULE-INDEX) TO MODULE-INDEX
102200         MOVE CALLED-PROC-NAME TO MODULE-NAME (MODULE-INDEX)
102300         MOVE "S" TO MODULE-TYPE-FLAG (MODULE-INDEX)
102400         SET CALLED-PROC-NUMBER TO MODULE-INDEX
102500         SET MODULE-COUNT TO MODULE-INDEX
102600         MOVE "Y" TO PRINT-CALLED-SUBPROGRAMS-SW
102700         ADD 1 TO SUBPROGRAM-COUNT
102800     ELSE
102900         MOVE "Y" TO TABLE-OVERFLOW-SW.
103000     SET MODULE-INDEX TO INDEX-SAVE-AREA.
103100*
103200 4500-LOAD-SORT-MERGE-PROCEDURE.
103300*
103400     IF SORT-FOUND
103500         MOVE "(SORT)" TO CALLED-PROC-NAME
103600     ELSE
103700         MOVE "(MERGE)" TO CALLED-PROC-NAME.
103800     PERFORM 4310-SEARCH-FOR-CALLED-MODULE.
103900     IF FOUND
104000         PERFORM 4320-SEARCH-FOR-DUPLICATE-CALL
104100         IF NOT DUPLICATE-CALL
104200             IF CALL-INDEX NOT > CALL-LIMIT
104300                 MOVE CALLED-PROC-NUMBER
104400                     TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX)
104500                 ADD 1 TO MODULE-CALL-COUNT (MODULE-INDEX)
104600                 SET CALL-INDEX UP BY 1
104700             ELSE
104800                 MOVE "Y" TO MODULE-CALL-OVERFLOW-SW
104900                 MOVE "Y" TO CALL-OVERFLOW-SW (MODULE-INDEX).
105000     IF NOT FOUND
105100         PERFORM 4510-LOAD-SORT-MERGE-MODULE
105200         IF NOT TABLE-OVERFLOW
105300             IF CALL-INDEX NOT > CALL-LIMIT
105400                 MOVE CALLED-PROC-NUMBER
105500                     TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX)
105600                 ADD 1 TO MODULE-CALL-COUNT (MODULE-INDEX)
105700                 SET CALL-INDEX UP BY 1
105800             ELSE
105900                 MOVE "Y" TO MODULE-CALL-OVERFLOW-SW
106000                 MOVE "Y" TO CALL-OVERFLOW-SW (MODULE-INDEX).
106100*
106200 4510-LOAD-SORT-MERGE-MODULE.
106300*
106400     SET INDEX-SAVE-AREA TO MODULE-INDEX.
106500     SET MODULE-INDEX TO MODULE-COUNT.
106600     SET MODULE-INDEX UP BY 1.
106700     IF MODULE-INDEX NOT > MODULE-LIMIT
106800         SET MODULE-NUMBER (MODULE-INDEX) TO MODULE-INDEX
106900         MOVE CALLED-PROC-NAME TO MODULE-NAME (MODULE-INDEX)
107000         MOVE "T" TO MODULE-TYPE-FLAG (MODULE-INDEX)
107100         SET CALLED-PROC-NUMBER TO MODULE-INDEX
107200         SET MODULE-COUNT TO MODULE-INDEX
107300     ELSE
107400         MOVE "Y" TO TABLE-OVERFLOW-SW.
107500     SET MODULE-INDEX TO INDEX-SAVE-AREA.
107600*
107700 4600-LOAD-INPUT-PROCEDURE.
107800*
107900     IF SOURCE-WORD (SOURCE-WORD-INDEX) = "IS"
108000         SET SOURCE-WORD-INDEX UP BY 1.
108100     MOVE SOURCE-WORD (SOURCE-WORD-INDEX) TO CALLED-PROC-NAME.
108200     PERFORM 4310-SEARCH-FOR-CALLED-MODULE.
108300     IF FOUND
108400         PERFORM 4320-SEARCH-FOR-DUPLICATE-CALL
108500         IF NOT DUPLICATE-CALL
108600             IF CALL-INDEX > CALL-LIMIT
108700                 MOVE "Y" TO MODULE-CALL-OVERFLOW-SW
108800                 MOVE "Y" TO CALL-OVERFLOW-SW (MODULE-INDEX)
108900             ELSE
109000                 MOVE CALLED-PROC-NUMBER
109100                     TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX)
109200                 ADD 1 TO MODULE-CALL-COUNT (MODULE-INDEX)
109300                 IF CALL-INDEX > 1
109400                     PERFORM 4610-SWITCH-LAST-TWO-CALLS
109500                     SET CALL-INDEX UP BY 1
109600                 ELSE
109700                     SET CALL-INDEX UP BY 1.
109800*
109900 4610-SWITCH-LAST-TWO-CALLS.
110000*
110100     MOVE CALLED-MODULE (MODULE-INDEX, CALL-INDEX)
110200         TO CALLED-MODULE-SAVE-AREA.
110300     MOVE CALLED-MODULE (MODULE-INDEX, CALL-INDEX - 1)
110400         TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX).
110500     MOVE CALLED-MODULE-SAVE-AREA
110600         TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX - 1).
110700*
110800 4700-LOAD-OUTPUT-PROCEDURE.
110900*
111000     IF SOURCE-WORD (SOURCE-WORD-INDEX) = "IS"
111100         SET SOURCE-WORD-INDEX UP BY 1.
111200     MOVE SOURCE-WORD (SOURCE-WORD-INDEX) TO CALLED-PROC-NAME.
111300     PERFORM 4310-SEARCH-FOR-CALLED-MODULE.
111400     IF FOUND
111500         PERFORM 4320-SEARCH-FOR-DUPLICATE-CALL
111600         IF NOT DUPLICATE-CALL
111700             IF CALL-INDEX NOT > CALL-LIMIT
111800                 MOVE CALLED-PROC-NUMBER
111900                     TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX)
112000                 ADD 1 TO MODULE-CALL-COUNT (MODULE-INDEX)
112100                 SET CALL-INDEX UP BY 1
112200             ELSE
112300                 MOVE "Y" TO MODULE-CALL-OVERFLOW-SW
112400                 MOVE "Y" TO CALL-OVERFLOW-SW (MODULE-INDEX).
112500*
112600 4800-COUNT-MODULE-CALLS.
112700*
112800     PERFORM 4810-COUNT-CALLS-FROM-1-MODULE
112900         VARYING MODULE-INDEX FROM 1 BY 1
113000         UNTIL MODULE-INDEX > MODULE-COUNT.
113100     IF MODULE-CALL-COUNT (1) > ZERO
113200         MOVE 1 TO TIMES-CALLED (1)
113300     ELSE
113400         MOVE 1 TO TIMES-CALLED (2).
113500     PERFORM 4830-SET-CALLING-FLAGS
113600         VARYING MODULE-INDEX FROM 1 BY 1
113700         UNTIL MODULE-INDEX > MODULE-COUNT.
113800*
113900 4810-COUNT-CALLS-FROM-1-MODULE.
114000*
114100     PERFORM 4820-SEARCH-MODULE-ENTRIES
114200         VARYING CALL-INDEX FROM 1 BY 1
114300         UNTIL CALL-INDEX > MODULE-CALL-COUNT (MODULE-INDEX).
114400*
114500 4820-SEARCH-MODULE-ENTRIES.
114600*
114700     SET INDEX-SAVE-AREA TO MODULE-INDEX.
114800     SET MODULE-INDEX TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX).
114900     ADD 1 TO TIMES-CALLED (MODULE-INDEX).
115000     SET MODULE-INDEX TO INDEX-SAVE-AREA.
115100*
115200 4830-SET-CALLING-FLAGS.
115300*
115400     IF TIMES-CALLED (MODULE-INDEX) > 1
115500         MOVE "C" TO COMMON-MODULE-FLAG (MODULE-INDEX).
115600     IF TIMES-CALLED (MODULE-INDEX) = ZERO
115700         MOVE "Y" TO PRINT-UNCALLED-MODULES-SW.
115800*
115900 5000-PRINT-STRUCTURE-LISTING.
116000*
116100     SET MODULE-INDEX TO 1.
116200     MOVE SPACE TO PRINT-LINE.
116300     PERFORM 5001-PRINT-LEVEL-1.
116400     PERFORM 5002-PRINT-LEVEL-2
116500         VARYING CALL-INDEX FROM 1 BY 1
116600         UNTIL CALL-INDEX > MODULE-CALL-COUNT (MODULE-INDEX).
116700     IF CALL-OVERFLOW-SW (MODULE-INDEX) = "Y"
116800         MOVE CALL-OVERFLOW-MESSAGE TO PL2-NAME
116900         PERFORM 1180-PRINT-REPORT-LINE.
117000     MOVE "*" TO PL1-ASTERISK.                                    AST
117100     PERFORM 1180-PRINT-REPORT-LINE.                              AST
117200*
117300 5001-PRINT-LEVEL-1.
117400*
117500     MOVE "*" TO  PL1-ASTERISK.                                   AST
117600     PERFORM 1180-PRINT-REPORT-LINE.                              AST
117700     IF     MODULE-CALL-COUNT (MODULE-INDEX) = ZERO
117800        AND PROGRAM-SECTION (MODULE-INDEX)
117900         SET MODULE-INDEX UP BY 1.
118000     MOVE FULL-MODULE-NAME (MODULE-INDEX) TO PL1-NAME.
118100     PERFORM 1180-PRINT-REPORT-LINE.
118200*
118300 5002-PRINT-LEVEL-2.
118400*
118500     IF CALL-INDEX = 1                                            AST
118600         MOVE "*" TO PL1-ASTERISK                                 AST
118700         PERFORM 1180-PRINT-REPORT-LINE.                          AST
118800     MOVE ZERO TO NUMBER-OF-CALLS.
118900     SET MODULE-INDEX-SAVE-AREA-1 TO MODULE-INDEX.
119000     SET MODULE-INDEX TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX).
119100     MOVE FULL-MODULE-NAME (MODULE-INDEX) TO PL2-NAME.
119200     PERFORM 1180-PRINT-REPORT-LINE.
119300     IF NOT COMMON-MODULE (MODULE-INDEX)
119400         OR (COMMON-MODULE (MODULE-INDEX)
119500             AND NOT MODULE-PRINTED (MODULE-INDEX))
119600         MOVE "Y" TO MODULE-PRINTED-SW (MODULE-INDEX)
119700         SET CALL-INDEX-SAVE-AREA-1 TO CALL-INDEX
119800         PERFORM 5003-PRINT-LEVEL-3
119900             VARYING CALL-INDEX FROM 1 BY 1
120000             UNTIL CALL-INDEX > MODULE-CALL-COUNT (MODULE-INDEX)
120100         SET NUMBER-OF-CALLS TO CALL-INDEX
120200         SET CALL-INDEX TO CALL-INDEX-SAVE-AREA-1.
120300     IF CALL-OVERFLOW-SW (MODULE-INDEX) = "Y"
120400         MOVE "** CALL OVERFLOW **" TO PL3-NAME
120500         PERFORM 1180-PRINT-REPORT-LINE.
120600     SET MODULE-INDEX TO MODULE-INDEX-SAVE-AREA-1.
120700     IF NUMBER-OF-CALLS > 1                                       AST
120800         MOVE "*" TO PL2-ASTERISK                                 AST
120900         PERFORM 1180-PRINT-REPORT-LINE.                          AST
121000*
121100 5003-PRINT-LEVEL-3.
121200*
121300     IF CALL-INDEX = 1                                            AST
121400         MOVE "*" TO PL2-ASTERISK                                 AST
121500         PERFORM 1180-PRINT-REPORT-LINE.                          AST
121600     MOVE ZERO TO NUMBER-OF-CALLS.
121700     SET MODULE-INDEX-SAVE-AREA-2 TO MODULE-INDEX.
121800     SET MODULE-INDEX TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX).
121900     MOVE FULL-MODULE-NAME (MODULE-INDEX) TO PL3-NAME.
122000     PERFORM 1180-PRINT-REPORT-LINE.
122100     IF NOT COMMON-MODULE (MODULE-INDEX)
122200         OR (COMMON-MODULE (MODULE-INDEX)
122300             AND NOT MODULE-PRINTED (MODULE-INDEX))
122400         MOVE "Y" TO MODULE-PRINTED-SW (MODULE-INDEX)
122500         SET CALL-INDEX-SAVE-AREA-2 TO CALL-INDEX
122600         PERFORM 5004-PRINT-LEVEL-4
122700             VARYING CALL-INDEX FROM 1 BY 1
122800             UNTIL CALL-INDEX > MODULE-CALL-COUNT (MODULE-INDEX)
122900         SET NUMBER-OF-CALLS TO CALL-INDEX
123000         SET CALL-INDEX TO CALL-INDEX-SAVE-AREA-2.
123100     IF CALL-OVERFLOW-SW (MODULE-INDEX) = "Y"
123200         MOVE "** CALL OVERFLOW **" TO PL4-NAME
123300         PERFORM 1180-PRINT-REPORT-LINE.
123400     SET MODULE-INDEX TO MODULE-INDEX-SAVE-AREA-2.
123500     IF NUMBER-OF-CALLS > 1                                       AST
123600         MOVE "*" TO PL3-ASTERISK                                 AST
123700         PERFORM 1180-PRINT-REPORT-LINE.                          AST
123800*
123900 5004-PRINT-LEVEL-4.
124000*
124100     IF CALL-INDEX = 1                                            AST
124200         MOVE "*" TO PL3-ASTERISK                                 AST
124300         PERFORM 1180-PRINT-REPORT-LINE.                          AST
124400     MOVE ZERO TO NUMBER-OF-CALLS.
124500     SET MODULE-INDEX-SAVE-AREA-3 TO MODULE-INDEX.
124600     SET MODULE-INDEX TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX).
124700     MOVE FULL-MODULE-NAME (MODULE-INDEX) TO PL4-NAME.
124800     PERFORM 1180-PRINT-REPORT-LINE.
124900     IF NOT COMMON-MODULE (MODULE-INDEX)
125000         OR (COMMON-MODULE (MODULE-INDEX)
125100             AND NOT MODULE-PRINTED (MODULE-INDEX))
125200         MOVE "Y" TO MODULE-PRINTED-SW (MODULE-INDEX)
125300         SET CALL-INDEX-SAVE-AREA-3 TO CALL-INDEX
125400         PERFORM 5005-PRINT-LEVEL-5
125500             VARYING CALL-INDEX FROM 1 BY 1
125600             UNTIL CALL-INDEX > MODULE-CALL-COUNT (MODULE-INDEX)
125700         SET NUMBER-OF-CALLS TO CALL-INDEX
125800         SET CALL-INDEX TO CALL-INDEX-SAVE-AREA-3.
125900     IF CALL-OVERFLOW-SW (MODULE-INDEX) = "Y"
126000         MOVE "** CALL OVERFLOW **" TO PL5-NAME
126100         PERFORM 1180-PRINT-REPORT-LINE.
126200     SET MODULE-INDEX TO MODULE-INDEX-SAVE-AREA-3.
126300     IF NUMBER-OF-CALLS > 1                                       AST
126400         MOVE "*" TO PL4-ASTERISK                                 AST
126500         PERFORM 1180-PRINT-REPORT-LINE.                          AST
126600*
126700 5005-PRINT-LEVEL-5.
126800*
126900     IF CALL-INDEX = 1                                            AST
127000         MOVE "*" TO PL4-ASTERISK                                 AST
127100         PERFORM 1180-PRINT-REPORT-LINE.                          AST
127200     MOVE ZERO TO NUMBER-OF-CALLS.
127300     SET MODULE-INDEX-SAVE-AREA-4 TO MODULE-INDEX.
127400     SET MODULE-INDEX TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX).
127500     MOVE FULL-MODULE-NAME (MODULE-INDEX) TO PL5-NAME.
127600     PERFORM 1180-PRINT-REPORT-LINE.
127700     IF NOT COMMON-MODULE (MODULE-INDEX)
127800         OR (COMMON-MODULE (MODULE-INDEX)
127900             AND NOT MODULE-PRINTED (MODULE-INDEX))
128000         MOVE "Y" TO MODULE-PRINTED-SW (MODULE-INDEX)
128100         SET CALL-INDEX-SAVE-AREA-4 TO CALL-INDEX
128200         PERFORM 5006-PRINT-LEVEL-6
128300             VARYING CALL-INDEX FROM 1 BY 1
128400             UNTIL CALL-INDEX > MODULE-CALL-COUNT (MODULE-INDEX)
128500         SET NUMBER-OF-CALLS TO CALL-INDEX
128600         SET CALL-INDEX TO CALL-INDEX-SAVE-AREA-4.
128700     IF CALL-OVERFLOW-SW (MODULE-INDEX) = "Y"
128800         MOVE "** CALL OVERFLOW **" TO PL6-NAME
128900         PERFORM 1180-PRINT-REPORT-LINE.
129000     SET MODULE-INDEX TO MODULE-INDEX-SAVE-AREA-4.
129100     IF NUMBER-OF-CALLS > 1                                       AST
129200         MOVE "*" TO PL5-ASTERISK                                 AST
129300         PERFORM 1180-PRINT-REPORT-LINE.                          AST
129400*
129500 5006-PRINT-LEVEL-6.
129600*
129700     IF CALL-INDEX = 1                                            AST
129800         MOVE "*" TO PL5-ASTERISK                                 AST
129900         PERFORM 1180-PRINT-REPORT-LINE.                          AST
130000     MOVE ZERO TO NUMBER-OF-CALLS.
130100     SET MODULE-INDEX-SAVE-AREA-5 TO MODULE-INDEX.
130200     SET MODULE-INDEX TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX).
130300     MOVE FULL-MODULE-NAME (MODULE-INDEX) TO PL6-NAME.
130400     PERFORM 1180-PRINT-REPORT-LINE.
130500     IF NOT COMMON-MODULE (MODULE-INDEX)
130600         OR (COMMON-MODULE (MODULE-INDEX)
130700             AND NOT MODULE-PRINTED (MODULE-INDEX))
130800         MOVE "Y" TO MODULE-PRINTED-SW (MODULE-INDEX)
130900         SET CALL-INDEX-SAVE-AREA-5 TO CALL-INDEX
131000         PERFORM 5007-PRINT-LEVEL-7
131100             VARYING CALL-INDEX FROM 1 BY 1
131200             UNTIL CALL-INDEX > MODULE-CALL-COUNT (MODULE-INDEX)
131300         SET NUMBER-OF-CALLS TO CALL-INDEX
131400         SET CALL-INDEX TO CALL-INDEX-SAVE-AREA-5.
131500     IF CALL-OVERFLOW-SW (MODULE-INDEX) = "Y"
131600         MOVE "** CALL OVERFLOW **" TO PL7-NAME
131700         PERFORM 1180-PRINT-REPORT-LINE.
131800     SET MODULE-INDEX TO MODULE-INDEX-SAVE-AREA-5.
131900     IF NUMBER-OF-CALLS > 1                                       AST
132000         MOVE "*" TO PL6-ASTERISK                                 AST
132100         PERFORM 1180-PRINT-REPORT-LINE.                          AST
132200*
132300 5007-PRINT-LEVEL-7.
132400*
132500     IF CALL-INDEX = 1                                            AST
132600         MOVE "*" TO PL6-ASTERISK                                 AST
132700         PERFORM 1180-PRINT-REPORT-LINE.                          AST
132800     MOVE ZERO TO NUMBER-OF-CALLS.
132900     SET MODULE-INDEX-SAVE-AREA-6 TO MODULE-INDEX.
133000     SET MODULE-INDEX TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX).
133100     MOVE FULL-MODULE-NAME (MODULE-INDEX) TO PL7-NAME.
133200     PERFORM 1180-PRINT-REPORT-LINE.
133300     IF NOT COMMON-MODULE (MODULE-INDEX)
133400         OR (COMMON-MODULE (MODULE-INDEX)
133500             AND NOT MODULE-PRINTED (MODULE-INDEX))
133600         MOVE "Y" TO MODULE-PRINTED-SW (MODULE-INDEX)
133700         SET CALL-INDEX-SAVE-AREA-6 TO CALL-INDEX
133800         PERFORM 5008-PRINT-LEVEL-8
133900             VARYING CALL-INDEX FROM 1 BY 1
134000             UNTIL CALL-INDEX > MODULE-CALL-COUNT (MODULE-INDEX)
134100         SET NUMBER-OF-CALLS TO CALL-INDEX
134200         SET CALL-INDEX TO CALL-INDEX-SAVE-AREA-6.
134300     IF CALL-OVERFLOW-SW (MODULE-INDEX) = "Y"
134400         MOVE "** CALL OVERFLOW **" TO PL8-NAME
134500         PERFORM 1180-PRINT-REPORT-LINE.
134600     SET MODULE-INDEX TO MODULE-INDEX-SAVE-AREA-6.
134700     IF NUMBER-OF-CALLS > 1                                       AST
134800         MOVE "*" TO PL7-ASTERISK                                 AST
134900         PERFORM 1180-PRINT-REPORT-LINE.                          AST
135000*
135100 5008-PRINT-LEVEL-8.
135200*
135300     IF CALL-INDEX = 1                                            AST
135400         MOVE "*" TO PL7-ASTERISK                                 AST
135500         PERFORM 1180-PRINT-REPORT-LINE.                          AST
135600     MOVE ZERO TO NUMBER-OF-CALLS.
135700     SET MODULE-INDEX-SAVE-AREA-7 TO MODULE-INDEX.
135800     SET MODULE-INDEX TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX).
135900     MOVE FULL-MODULE-NAME (MODULE-INDEX) TO PL8-NAME.
136000     PERFORM 1180-PRINT-REPORT-LINE.
136100     IF NOT COMMON-MODULE (MODULE-INDEX)
136200         OR (COMMON-MODULE (MODULE-INDEX)
136300             AND NOT MODULE-PRINTED (MODULE-INDEX))
136400         MOVE "Y" TO MODULE-PRINTED-SW (MODULE-INDEX)
136500         SET CALL-INDEX-SAVE-AREA-7 TO CALL-INDEX
136600         PERFORM 5009-PRINT-LEVEL-9
136700             VARYING CALL-INDEX FROM 1 BY 1
136800             UNTIL CALL-INDEX > MODULE-CALL-COUNT (MODULE-INDEX)
136900         SET NUMBER-OF-CALLS TO CALL-INDEX
137000         SET CALL-INDEX TO CALL-INDEX-SAVE-AREA-7.
137100     IF CALL-OVERFLOW-SW (MODULE-INDEX) = "Y"
137200         MOVE "** CALL OVERFLOW **" TO PL9-NAME
137300         PERFORM 1180-PRINT-REPORT-LINE.
137400     SET MODULE-INDEX TO MODULE-INDEX-SAVE-AREA-7.
137500     IF NUMBER-OF-CALLS > 1                                       AST
137600         MOVE "*" TO PL8-ASTERISK                                 AST
137700         PERFORM 1180-PRINT-REPORT-LINE.                          AST
137800*
137900 5009-PRINT-LEVEL-9.
138000*
138100     IF CALL-INDEX = 1                                            AST
138200         MOVE "*" TO PL8-ASTERISK                                 AST
138300         PERFORM 1180-PRINT-REPORT-LINE.                          AST
138400     MOVE ZERO TO NUMBER-OF-CALLS.
138500     SET MODULE-INDEX-SAVE-AREA-8 TO MODULE-INDEX.
138600     SET MODULE-INDEX TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX).
138700     MOVE FULL-MODULE-NAME (MODULE-INDEX) TO PL9-NAME.
138800     PERFORM 1180-PRINT-REPORT-LINE.
138900     IF NOT COMMON-MODULE (MODULE-INDEX)
139000         OR (COMMON-MODULE (MODULE-INDEX)
139100             AND NOT MODULE-PRINTED (MODULE-INDEX))
139200         MOVE "Y" TO MODULE-PRINTED-SW (MODULE-INDEX)
139300         SET CALL-INDEX-SAVE-AREA-8 TO CALL-INDEX
139400         PERFORM 5010-PRINT-LEVEL-10
139500             VARYING CALL-INDEX FROM 1 BY 1
139600             UNTIL CALL-INDEX > MODULE-CALL-COUNT (MODULE-INDEX)
139700         SET NUMBER-OF-CALLS TO CALL-INDEX
139800         SET CALL-INDEX TO CALL-INDEX-SAVE-AREA-8.
139900     IF CALL-OVERFLOW-SW (MODULE-INDEX) = "Y"
140000         MOVE "** CALL OVERFLOW **" TO PL10-NAME
140100         PERFORM 1180-PRINT-REPORT-LINE.
140200     SET MODULE-INDEX TO MODULE-INDEX-SAVE-AREA-8.
140300     IF NUMBER-OF-CALLS > 1                                       AST
140400         MOVE "*" TO PL9-ASTERISK                                 AST
140500         PERFORM 1180-PRINT-REPORT-LINE.                          AST
140600*
140700 5010-PRINT-LEVEL-10.
140800*
140900     IF CALL-INDEX = 1                                            AST
141000         MOVE "*" TO PL9-ASTERISK                                 AST
141100         PERFORM 1180-PRINT-REPORT-LINE.                          AST
141200     MOVE ZERO TO NUMBER-OF-CALLS.
141300     SET MODULE-INDEX-SAVE-AREA-9 TO MODULE-INDEX.
141400     SET MODULE-INDEX TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX).
141500     MOVE FULL-MODULE-NAME (MODULE-INDEX) TO PL10-NAME.
141600     PERFORM 1180-PRINT-REPORT-LINE.
141700     IF NOT COMMON-MODULE (MODULE-INDEX)
141800         OR (COMMON-MODULE (MODULE-INDEX)
141900             AND NOT MODULE-PRINTED (MODULE-INDEX))
142000         MOVE "Y" TO MODULE-PRINTED-SW (MODULE-INDEX)
142100         SET CALL-INDEX-SAVE-AREA-9 TO CALL-INDEX
142200         PERFORM 5011-PRINT-LEVEL-11
142300             VARYING CALL-INDEX FROM 1 BY 1
142400             UNTIL CALL-INDEX > MODULE-CALL-COUNT (MODULE-INDEX)
142500         SET NUMBER-OF-CALLS TO CALL-INDEX
142600         SET CALL-INDEX TO CALL-INDEX-SAVE-AREA-9.
142700     IF CALL-OVERFLOW-SW (MODULE-INDEX) = "Y"
142800         MOVE "** CALL OVERFLOW **" TO PL11-NAME
142900         PERFORM 1180-PRINT-REPORT-LINE.
143000     SET MODULE-INDEX TO MODULE-INDEX-SAVE-AREA-9.
143100     IF NUMBER-OF-CALLS > 1                                       AST
143200         MOVE "*" TO PL10-ASTERISK                                AST
143300         PERFORM 1180-PRINT-REPORT-LINE.                          AST
143400*
143500 5011-PRINT-LEVEL-11.
143600*
143700     IF CALL-INDEX = 1                                            AST
143800         MOVE "*" TO PL10-ASTERISK                                AST
143900         PERFORM 1180-PRINT-REPORT-LINE.                          AST
144000     MOVE ZERO TO NUMBER-OF-CALLS.
144100     SET MODULE-INDEX-SAVE-AREA-10 TO MODULE-INDEX.
144200     SET MODULE-INDEX TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX).
144300     MOVE FULL-MODULE-NAME (MODULE-INDEX) TO PL11-NAME.
144400     PERFORM 1180-PRINT-REPORT-LINE.
144500     IF NOT COMMON-MODULE (MODULE-INDEX)
144600         OR (COMMON-MODULE (MODULE-INDEX)
144700             AND NOT MODULE-PRINTED (MODULE-INDEX))
144800         MOVE "Y" TO MODULE-PRINTED-SW (MODULE-INDEX)
144900         SET CALL-INDEX-SAVE-AREA-10 TO CALL-INDEX
145000         PERFORM 5012-PRINT-LEVEL-12
145100             VARYING CALL-INDEX FROM 1 BY 1
145200             UNTIL CALL-INDEX > MODULE-CALL-COUNT (MODULE-INDEX)
145300         SET NUMBER-OF-CALLS TO CALL-INDEX
145400         SET CALL-INDEX TO CALL-INDEX-SAVE-AREA-10.
145500     IF CALL-OVERFLOW-SW (MODULE-INDEX) = "Y"
145600         MOVE "** CALL OVERFLOW **" TO PL12-NAME
145700         PERFORM 1180-PRINT-REPORT-LINE.
145800     SET MODULE-INDEX TO MODULE-INDEX-SAVE-AREA-10.
145900     IF NUMBER-OF-CALLS > 1                                       AST
146000         MOVE "*" TO PL11-ASTERISK                                AST
146100         PERFORM 1180-PRINT-REPORT-LINE.                          AST
146200*
146300 5012-PRINT-LEVEL-12.
146400*
146500     IF CALL-INDEX = 1                                            AST
146600         MOVE "*" TO PL11-ASTERISK                                AST
146700         PERFORM 1180-PRINT-REPORT-LINE.                          AST
146800     MOVE ZERO TO NUMBER-OF-CALLS.
146900     SET MODULE-INDEX-SAVE-AREA-11 TO MODULE-INDEX.
147000     SET MODULE-INDEX TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX).
147100     MOVE FULL-MODULE-NAME (MODULE-INDEX) TO PL12-NAME.
147200     PERFORM 1180-PRINT-REPORT-LINE.
147300     IF NOT COMMON-MODULE (MODULE-INDEX)
147400         OR (COMMON-MODULE (MODULE-INDEX)
147500             AND NOT MODULE-PRINTED (MODULE-INDEX))
147600         MOVE "Y" TO MODULE-PRINTED-SW (MODULE-INDEX)
147700         SET CALL-INDEX-SAVE-AREA-11 TO CALL-INDEX
147800         PERFORM 5013-PRINT-LEVEL-13
147900             VARYING CALL-INDEX FROM 1 BY 1
148000             UNTIL CALL-INDEX > MODULE-CALL-COUNT (MODULE-INDEX)
148100         SET NUMBER-OF-CALLS TO CALL-INDEX
148200         SET CALL-INDEX TO CALL-INDEX-SAVE-AREA-11.
148300     IF CALL-OVERFLOW-SW (MODULE-INDEX) = "Y"
148400         MOVE "** CALL OVERFLOW **" TO PL13-NAME
148500         PERFORM 1180-PRINT-REPORT-LINE.
148600     SET MODULE-INDEX TO MODULE-INDEX-SAVE-AREA-11.
148700     IF NUMBER-OF-CALLS > 1                                       AST
148800         MOVE "*" TO PL12-ASTERISK                                AST
148900         PERFORM 1180-PRINT-REPORT-LINE.                          AST
149000*
149100 5013-PRINT-LEVEL-13.
149200*
149300     IF CALL-INDEX = 1                                            AST
149400         MOVE "*" TO PL12-ASTERISK                                AST
149500         PERFORM 1180-PRINT-REPORT-LINE.                          AST
149600     MOVE ZERO TO NUMBER-OF-CALLS.
149700     SET MODULE-INDEX-SAVE-AREA-12 TO MODULE-INDEX.
149800     SET MODULE-INDEX TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX).
149900     MOVE FULL-MODULE-NAME (MODULE-INDEX) TO PL13-NAME.
150000     PERFORM 1180-PRINT-REPORT-LINE.
150100     IF NOT COMMON-MODULE (MODULE-INDEX)
150200         OR (COMMON-MODULE (MODULE-INDEX)
150300             AND NOT MODULE-PRINTED (MODULE-INDEX))
150400         MOVE "Y" TO MODULE-PRINTED-SW (MODULE-INDEX)
150500         SET CALL-INDEX-SAVE-AREA-12 TO CALL-INDEX
150600         PERFORM 5014-PRINT-LEVEL-14
150700             VARYING CALL-INDEX FROM 1 BY 1
150800             UNTIL CALL-INDEX > MODULE-CALL-COUNT (MODULE-INDEX)
150900         SET NUMBER-OF-CALLS TO CALL-INDEX
151000         SET CALL-INDEX TO CALL-INDEX-SAVE-AREA-12.
151100     IF CALL-OVERFLOW-SW (MODULE-INDEX) = "Y"
151200         MOVE "** CALL OVERFLOW **" TO PL14-NAME
151300         PERFORM 1180-PRINT-REPORT-LINE.
151400     SET MODULE-INDEX TO MODULE-INDEX-SAVE-AREA-12.
151500     IF NUMBER-OF-CALLS > 1                                       AST
151600         MOVE "*" TO PL13-ASTERISK                                AST
151700         PERFORM 1180-PRINT-REPORT-LINE.                          AST
151800*
151900 5014-PRINT-LEVEL-14.
152000*
152100     IF CALL-INDEX = 1                                            AST
152200         MOVE "*" TO PL13-ASTERISK                                AST
152300         PERFORM 1180-PRINT-REPORT-LINE.                          AST
152400     MOVE ZERO TO NUMBER-OF-CALLS.
152500     SET MODULE-INDEX-SAVE-AREA-13 TO MODULE-INDEX.
152600     SET MODULE-INDEX TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX).
152700     MOVE FULL-MODULE-NAME (MODULE-INDEX) TO PL14-NAME.
152800     PERFORM 1180-PRINT-REPORT-LINE.
152900     IF NOT COMMON-MODULE (MODULE-INDEX)
153000         OR (COMMON-MODULE (MODULE-INDEX)
153100             AND NOT MODULE-PRINTED (MODULE-INDEX))
153200         MOVE "Y" TO MODULE-PRINTED-SW (MODULE-INDEX)
153300         SET CALL-INDEX-SAVE-AREA-13 TO CALL-INDEX
153400         PERFORM 5015-PRINT-LEVEL-15
153500             VARYING CALL-INDEX FROM 1 BY 1
153600             UNTIL CALL-INDEX > MODULE-CALL-COUNT (MODULE-INDEX)
153700         SET NUMBER-OF-CALLS TO CALL-INDEX
153800         SET CALL-INDEX TO CALL-INDEX-SAVE-AREA-13.
153900     IF CALL-OVERFLOW-SW (MODULE-INDEX) = "Y"
154000         MOVE "** CALL OVERFLOW **" TO PL15-NAME
154100         PERFORM 1180-PRINT-REPORT-LINE.
154200     SET MODULE-INDEX TO MODULE-INDEX-SAVE-AREA-13.
154300     IF NUMBER-OF-CALLS > 1                                       AST
154400         MOVE "*" TO PL14-ASTERISK                                AST
154500         PERFORM 1180-PRINT-REPORT-LINE.                          AST
154600*
154700 5015-PRINT-LEVEL-15.
154800*
154900     IF CALL-INDEX = 1                                            AST
155000         MOVE "*" TO PL14-ASTERISK                                AST
155100         PERFORM 1180-PRINT-REPORT-LINE.                          AST
155200     MOVE ZERO TO NUMBER-OF-CALLS.
155300     SET MODULE-INDEX-SAVE-AREA-14 TO MODULE-INDEX.
155400     SET MODULE-INDEX TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX).
155500     MOVE FULL-MODULE-NAME (MODULE-INDEX) TO PL15-NAME.
155600     PERFORM 1180-PRINT-REPORT-LINE.
155700     IF NOT COMMON-MODULE (MODULE-INDEX)
155800         OR (COMMON-MODULE (MODULE-INDEX)
155900             AND NOT MODULE-PRINTED (MODULE-INDEX))
156000         MOVE "Y" TO MODULE-PRINTED-SW (MODULE-INDEX)
156100         SET CALL-INDEX-SAVE-AREA-14 TO CALL-INDEX
156200         PERFORM 5016-PRINT-LEVEL-16
156300             VARYING CALL-INDEX FROM 1 BY 1
156400             UNTIL CALL-INDEX > MODULE-CALL-COUNT (MODULE-INDEX)
156500         SET NUMBER-OF-CALLS TO CALL-INDEX
156600         SET CALL-INDEX TO CALL-INDEX-SAVE-AREA-14.
156700     IF CALL-OVERFLOW-SW (MODULE-INDEX) = "Y"
156800         MOVE "** CALL OVERFLOW **" TO PL16-NAME
156900         PERFORM 1180-PRINT-REPORT-LINE.
157000     SET MODULE-INDEX TO MODULE-INDEX-SAVE-AREA-14.
157100     IF NUMBER-OF-CALLS > 1                                       AST
157200         MOVE "*" TO PL15-ASTERISK                                AST
157300         PERFORM 1180-PRINT-REPORT-LINE.                          AST
157400*
157500 5016-PRINT-LEVEL-16.
157600*
157700     IF CALL-INDEX = 1                                            AST
157800         MOVE "*" TO PL15-ASTERISK                                AST
157900         PERFORM 1180-PRINT-REPORT-LINE.                          AST
158000     MOVE ZERO TO NUMBER-OF-CALLS.
158100     SET MODULE-INDEX-SAVE-AREA-15 TO MODULE-INDEX.
158200     SET MODULE-INDEX TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX).
158300     MOVE FULL-MODULE-NAME (MODULE-INDEX) TO PL16-NAME.
158400     PERFORM 1180-PRINT-REPORT-LINE.
158500     IF NOT COMMON-MODULE (MODULE-INDEX)
158600         OR (COMMON-MODULE (MODULE-INDEX)
158700             AND NOT MODULE-PRINTED (MODULE-INDEX))
158800         MOVE "Y" TO MODULE-PRINTED-SW (MODULE-INDEX)
158900         SET CALL-INDEX-SAVE-AREA-15 TO CALL-INDEX
159000         PERFORM 5017-PRINT-LEVEL-17
159100             VARYING CALL-INDEX FROM 1 BY 1
159200             UNTIL CALL-INDEX > MODULE-CALL-COUNT (MODULE-INDEX)
159300         SET NUMBER-OF-CALLS TO CALL-INDEX
159400         SET CALL-INDEX TO CALL-INDEX-SAVE-AREA-15.
159500     IF CALL-OVERFLOW-SW (MODULE-INDEX) = "Y"
159600         MOVE "** CALL OVERFLOW **" TO PL17-NAME
159700         PERFORM 1180-PRINT-REPORT-LINE.
159800     SET MODULE-INDEX TO MODULE-INDEX-SAVE-AREA-15.
159900     IF NUMBER-OF-CALLS > 1                                       AST
160000         MOVE "*" TO PL16-ASTERISK                                AST
160100         PERFORM 1180-PRINT-REPORT-LINE.                          AST
160200*
160300 5017-PRINT-LEVEL-17.
160400*
160500     IF CALL-INDEX = 1                                            AST
160600         MOVE "*" TO PL16-ASTERISK                                AST
160700         PERFORM 1180-PRINT-REPORT-LINE.                          AST
160800     MOVE ZERO TO NUMBER-OF-CALLS.
160900     SET MODULE-INDEX-SAVE-AREA-16 TO MODULE-INDEX.
161000     SET MODULE-INDEX TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX).
161100     MOVE FULL-MODULE-NAME (MODULE-INDEX) TO PL17-NAME.
161200     PERFORM 1180-PRINT-REPORT-LINE.
161300     IF NOT COMMON-MODULE (MODULE-INDEX)
161400         OR (COMMON-MODULE (MODULE-INDEX)
161500             AND NOT MODULE-PRINTED (MODULE-INDEX))
161600         MOVE "Y" TO MODULE-PRINTED-SW (MODULE-INDEX)
161700         SET CALL-INDEX-SAVE-AREA-16 TO CALL-INDEX
161800         PERFORM 5018-PRINT-LEVEL-18
161900             VARYING CALL-INDEX FROM 1 BY 1
162000             UNTIL CALL-INDEX > MODULE-CALL-COUNT (MODULE-INDEX)
162100         SET NUMBER-OF-CALLS TO CALL-INDEX
162200         SET CALL-INDEX TO CALL-INDEX-SAVE-AREA-16.
162300     IF CALL-OVERFLOW-SW (MODULE-INDEX) = "Y"
162400         MOVE "** CALL OVERFLOW **" TO PL18-NAME
162500         PERFORM 1180-PRINT-REPORT-LINE.
162600     SET MODULE-INDEX TO MODULE-INDEX-SAVE-AREA-16.
162700     IF NUMBER-OF-CALLS > 1                                       AST
162800         MOVE "*" TO PL17-ASTERISK                                AST
162900         PERFORM 1180-PRINT-REPORT-LINE.                          AST
163000*
163100 5018-PRINT-LEVEL-18.
163200*
163300     IF CALL-INDEX = 1                                            AST
163400         MOVE "*" TO PL17-ASTERISK                                AST
163500         PERFORM 1180-PRINT-REPORT-LINE.                          AST
163600     MOVE ZERO TO NUMBER-OF-CALLS.
163700     SET MODULE-INDEX-SAVE-AREA-17 TO MODULE-INDEX.
163800     SET MODULE-INDEX TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX).
163900     MOVE FULL-MODULE-NAME (MODULE-INDEX) TO PL18-NAME.
164000     PERFORM 1180-PRINT-REPORT-LINE.
164100     IF NOT COMMON-MODULE (MODULE-INDEX)
164200         OR (COMMON-MODULE (MODULE-INDEX)
164300             AND NOT MODULE-PRINTED (MODULE-INDEX))
164400         MOVE "Y" TO MODULE-PRINTED-SW (MODULE-INDEX)
164500         SET CALL-INDEX-SAVE-AREA-17 TO CALL-INDEX
164600         PERFORM 5019-PRINT-LEVEL-19
164700             VARYING CALL-INDEX FROM 1 BY 1
164800             UNTIL CALL-INDEX > MODULE-CALL-COUNT (MODULE-INDEX)
164900         SET NUMBER-OF-CALLS TO CALL-INDEX
165000         SET CALL-INDEX TO CALL-INDEX-SAVE-AREA-17.
165100     IF CALL-OVERFLOW-SW (MODULE-INDEX) = "Y"
165200         MOVE "** CALL OVERFLOW **" TO PL19-NAME
165300         PERFORM 1180-PRINT-REPORT-LINE.
165400     SET MODULE-INDEX TO MODULE-INDEX-SAVE-AREA-17.
165500     IF NUMBER-OF-CALLS > 1                                       AST
165600         MOVE "*" TO PL18-ASTERISK                                AST
165700         PERFORM 1180-PRINT-REPORT-LINE.                          AST
165800*
165900 5019-PRINT-LEVEL-19.
166000*
166100     IF CALL-INDEX = 1                                            AST
166200         MOVE "*" TO PL18-ASTERISK                                AST
166300         PERFORM 1180-PRINT-REPORT-LINE.                          AST
166400     MOVE ZERO TO NUMBER-OF-CALLS.
166500     SET MODULE-INDEX-SAVE-AREA-18 TO MODULE-INDEX.
166600     SET MODULE-INDEX TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX).
166700     MOVE FULL-MODULE-NAME (MODULE-INDEX) TO PL19-NAME.
166800     PERFORM 1180-PRINT-REPORT-LINE.
166900     IF NOT COMMON-MODULE (MODULE-INDEX)
167000         OR (COMMON-MODULE (MODULE-INDEX)
167100             AND NOT MODULE-PRINTED (MODULE-INDEX))
167200         MOVE "Y" TO MODULE-PRINTED-SW (MODULE-INDEX)
167300         SET CALL-INDEX-SAVE-AREA-18 TO CALL-INDEX
167400         PERFORM 5020-PRINT-LEVEL-20
167500             VARYING CALL-INDEX FROM 1 BY 1
167600             UNTIL CALL-INDEX > MODULE-CALL-COUNT (MODULE-INDEX)
167700         SET NUMBER-OF-CALLS TO CALL-INDEX
167800         SET CALL-INDEX TO CALL-INDEX-SAVE-AREA-18.
167900     IF CALL-OVERFLOW-SW (MODULE-INDEX) = "Y"
168000         MOVE "** CALL OVERFLOW **" TO PL20-NAME
168100         PERFORM 1180-PRINT-REPORT-LINE.
168200     SET MODULE-INDEX TO MODULE-INDEX-SAVE-AREA-18.
168300     IF NUMBER-OF-CALLS > 1                                       AST
168400         MOVE "*" TO PL19-ASTERISK                                AST
168500         PERFORM 1180-PRINT-REPORT-LINE.                          AST
168600*
168700 5020-PRINT-LEVEL-20.
168800*
168900     IF CALL-INDEX = 1                                            AST
169000         MOVE "*" TO PL19-ASTERISK                                AST
169100         PERFORM 1180-PRINT-REPORT-LINE.                          AST
169200     MOVE ZERO TO NUMBER-OF-CALLS.
169300     SET MODULE-INDEX-SAVE-AREA-19 TO MODULE-INDEX.
169400     SET MODULE-INDEX TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX).
169500     MOVE FULL-MODULE-NAME (MODULE-INDEX) TO PL20-NAME.
169600     PERFORM 1180-PRINT-REPORT-LINE.
169700     IF NOT COMMON-MODULE (MODULE-INDEX)
169800         OR (COMMON-MODULE (MODULE-INDEX)
169900             AND NOT MODULE-PRINTED (MODULE-INDEX))
170000         MOVE "Y" TO MODULE-PRINTED-SW (MODULE-INDEX)
170100         SET CALL-INDEX-SAVE-AREA-19 TO CALL-INDEX
170200         PERFORM 5021-PRINT-LEVEL-21
170300             VARYING CALL-INDEX FROM 1 BY 1
170400             UNTIL CALL-INDEX > MODULE-CALL-COUNT (MODULE-INDEX)
170500         SET NUMBER-OF-CALLS TO CALL-INDEX
170600         SET CALL-INDEX TO CALL-INDEX-SAVE-AREA-19.
170700     IF CALL-OVERFLOW-SW (MODULE-INDEX) = "Y"
170800         MOVE "** CALL OVERFLOW **" TO PL21-NAME
170900         PERFORM 1180-PRINT-REPORT-LINE.
171000     SET MODULE-INDEX TO MODULE-INDEX-SAVE-AREA-19.
171100     IF NUMBER-OF-CALLS > 1                                       AST
171200         MOVE "*" TO PL20-ASTERISK                                AST
171300         PERFORM 1180-PRINT-REPORT-LINE.                          AST
171400*
171500 5021-PRINT-LEVEL-21.
171600*
171700     IF CALL-INDEX = 1                                            AST
171800         MOVE "*" TO PL20-ASTERISK                                AST
171900         PERFORM 1180-PRINT-REPORT-LINE.                          AST
172000     MOVE ZERO TO NUMBER-OF-CALLS.
172100     SET MODULE-INDEX-SAVE-AREA-20 TO MODULE-INDEX.
172200     SET MODULE-INDEX TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX).
172300     MOVE FULL-MODULE-NAME (MODULE-INDEX) TO PL21-NAME.
172400     PERFORM 1180-PRINT-REPORT-LINE.
172500     IF NOT COMMON-MODULE (MODULE-INDEX)
172600         OR (COMMON-MODULE (MODULE-INDEX)
172700             AND NOT MODULE-PRINTED (MODULE-INDEX))
172800         MOVE "Y" TO MODULE-PRINTED-SW (MODULE-INDEX)
172900         SET CALL-INDEX-SAVE-AREA-20 TO CALL-INDEX
173000         PERFORM 5022-PRINT-LEVEL-22
173100             VARYING CALL-INDEX FROM 1 BY 1
173200             UNTIL CALL-INDEX > MODULE-CALL-COUNT (MODULE-INDEX)
173300         SET NUMBER-OF-CALLS TO CALL-INDEX
173400         SET CALL-INDEX TO CALL-INDEX-SAVE-AREA-20.
173500     IF CALL-OVERFLOW-SW (MODULE-INDEX) = "Y"
173600         MOVE "** CALL OVERFLOW **" TO PL22-NAME
173700         PERFORM 1180-PRINT-REPORT-LINE.
173800     SET MODULE-INDEX TO MODULE-INDEX-SAVE-AREA-20.
173900     IF NUMBER-OF-CALLS > 1                                       AST
174000         MOVE "*" TO PL21-ASTERISK                                AST
174100         PERFORM 1180-PRINT-REPORT-LINE.                          AST
174200*
174300 5022-PRINT-LEVEL-22.
174400*
174500     IF CALL-INDEX = 1                                            AST
174600         MOVE "*" TO PL21-ASTERISK                                AST
174700         PERFORM 1180-PRINT-REPORT-LINE.                          AST
174800     MOVE ZERO TO NUMBER-OF-CALLS.
174900     SET MODULE-INDEX-SAVE-AREA-21 TO MODULE-INDEX.
175000     SET MODULE-INDEX TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX).
175100     MOVE FULL-MODULE-NAME (MODULE-INDEX) TO PL22-NAME.
175200     PERFORM 1180-PRINT-REPORT-LINE.
175300     IF NOT COMMON-MODULE (MODULE-INDEX)
175400         OR (COMMON-MODULE (MODULE-INDEX)
175500             AND NOT MODULE-PRINTED (MODULE-INDEX))
175600         MOVE "Y" TO MODULE-PRINTED-SW (MODULE-INDEX)
175700         SET CALL-INDEX-SAVE-AREA-21 TO CALL-INDEX
175800         PERFORM 5023-PRINT-LEVEL-23
175900             VARYING CALL-INDEX FROM 1 BY 1
176000             UNTIL CALL-INDEX > MODULE-CALL-COUNT (MODULE-INDEX)
176100         SET NUMBER-OF-CALLS TO CALL-INDEX
176200         SET CALL-INDEX TO CALL-INDEX-SAVE-AREA-21.
176300     IF CALL-OVERFLOW-SW (MODULE-INDEX) = "Y"
176400         MOVE "** CALL OVERFLOW **" TO PL23-NAME
176500         PERFORM 1180-PRINT-REPORT-LINE.
176600     SET MODULE-INDEX TO MODULE-INDEX-SAVE-AREA-21.
176700     IF NUMBER-OF-CALLS > 1                                       AST
176800         MOVE "*" TO PL22-ASTERISK                                AST
176900         PERFORM 1180-PRINT-REPORT-LINE.                          AST
177000*
177100 5023-PRINT-LEVEL-23.
177200*
177300     IF CALL-INDEX = 1                                            AST
177400         MOVE "*" TO PL22-ASTERISK                                AST
177500         PERFORM 1180-PRINT-REPORT-LINE.                          AST
177600     MOVE ZERO TO NUMBER-OF-CALLS.
177700     SET MODULE-INDEX-SAVE-AREA-22 TO MODULE-INDEX.
177800     SET MODULE-INDEX TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX).
177900     MOVE FULL-MODULE-NAME (MODULE-INDEX) TO PL23-NAME.
178000     PERFORM 1180-PRINT-REPORT-LINE.
178100     IF NOT COMMON-MODULE (MODULE-INDEX)
178200         OR (COMMON-MODULE (MODULE-INDEX)
178300             AND NOT MODULE-PRINTED (MODULE-INDEX))
178400         MOVE "Y" TO MODULE-PRINTED-SW (MODULE-INDEX)
178500         SET CALL-INDEX-SAVE-AREA-22 TO CALL-INDEX
178600         PERFORM 5024-PRINT-LEVEL-24
178700             VARYING CALL-INDEX FROM 1 BY 1
178800             UNTIL CALL-INDEX > MODULE-CALL-COUNT (MODULE-INDEX)
178900         SET NUMBER-OF-CALLS TO CALL-INDEX
179000         SET CALL-INDEX TO CALL-INDEX-SAVE-AREA-22.
179100     IF CALL-OVERFLOW-SW (MODULE-INDEX) = "Y"
179200         MOVE "** CALL OVERFLOW **" TO PL24-NAME
179300         PERFORM 1180-PRINT-REPORT-LINE.
179400     SET MODULE-INDEX TO MODULE-INDEX-SAVE-AREA-22.
179500     IF NUMBER-OF-CALLS > 1                                       AST
179600         MOVE "*" TO PL23-ASTERISK                                AST
179700         PERFORM 1180-PRINT-REPORT-LINE.                          AST
179800*
179900 5024-PRINT-LEVEL-24.
180000*
180100     IF CALL-INDEX = 1                                            AST
180200         MOVE "*" TO PL23-ASTERISK                                AST
180300         PERFORM 1180-PRINT-REPORT-LINE.                          AST
180400     MOVE ZERO TO NUMBER-OF-CALLS.
180500     SET MODULE-INDEX-SAVE-AREA-23 TO MODULE-INDEX.
180600     SET MODULE-INDEX TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX).
180700     MOVE FULL-MODULE-NAME (MODULE-INDEX) TO PL24-NAME.
180800     PERFORM 1180-PRINT-REPORT-LINE.
180900     IF NOT COMMON-MODULE (MODULE-INDEX)
181000         OR (COMMON-MODULE (MODULE-INDEX)
181100             AND NOT MODULE-PRINTED (MODULE-INDEX))
181200         MOVE "Y" TO MODULE-PRINTED-SW (MODULE-INDEX)
181300         SET CALL-INDEX-SAVE-AREA-23 TO CALL-INDEX
181400         PERFORM 5025-PRINT-LEVEL-25
181500             VARYING CALL-INDEX FROM 1 BY 1
181600             UNTIL CALL-INDEX > MODULE-CALL-COUNT (MODULE-INDEX)
181700         SET NUMBER-OF-CALLS TO CALL-INDEX
181800         SET CALL-INDEX TO CALL-INDEX-SAVE-AREA-23.
181900     IF CALL-OVERFLOW-SW (MODULE-INDEX) = "Y"
182000         MOVE "** CALL OVERFLOW **" TO PL5-NAME
182100         PERFORM 1180-PRINT-REPORT-LINE.
182200     SET MODULE-INDEX TO MODULE-INDEX-SAVE-AREA-23.
182300     IF NUMBER-OF-CALLS > 1                                       AST
182400         MOVE "*" TO PL24-ASTERISK                                AST
182500         PERFORM 1180-PRINT-REPORT-LINE.                          AST
182600*
182700 5025-PRINT-LEVEL-25.
182800*
182900     IF CALL-INDEX = 1                                            AST
183000         MOVE "*" TO PL24-ASTERISK                                AST
183100         PERFORM 1180-PRINT-REPORT-LINE.                          AST
183200     SET MODULE-INDEX-SAVE-AREA-24 TO MODULE-INDEX.
183300     SET MODULE-INDEX TO CALLED-MODULE (MODULE-INDEX, CALL-INDEX).
183400     MOVE FULL-MODULE-NAME (MODULE-INDEX) TO PL25-NAME.
183500     PERFORM 1180-PRINT-REPORT-LINE.
183600     IF     (MODULE-CALL-COUNT (MODULE-INDEX) NOT = ZERO)
183700        AND (NOT MODULE-PRINTED (MODULE-INDEX))
183800         MOVE "** LEVEL OVERFLOW **" TO PL25-NAME
183900         PERFORM 1180-PRINT-REPORT-LINE
184000         MOVE "Y" TO LEVEL-OVERFLOW-SW.
184100     SET MODULE-INDEX TO MODULE-INDEX-SAVE-AREA-24.
184200*
184300 6000-PRINT-DECLARATIVES.                                         DEC
184400*                                                                 DEC
184500     MOVE 99 TO LINE-COUNT.                                       DEC
184600     MOVE "N" TO SRCEFILE-EOF-SW.                                 DEC
184700     PERFORM 6100-RESTART-DECLARATIVES.                           DEC
184800     MOVE DECLARATIVES-HEADING TO SHL-HEADING.                    DEC
184900     MOVE SUMMARY-HEADING-LINE TO PRINT-LINE.                     DEC
185000     MOVE 2 TO SPACE-CONTROL.                                     DEC
185100     PERFORM 1180-PRINT-REPORT-LINE.                              DEC
185200     MOVE 2 TO SPACE-CONTROL.                                     DEC
185300     PERFORM 6200-PRINT-DECLARATIVE-LINE                          DEC
185400         VARYING RESTART-COUNT                                    DEC
185500             FROM FIRST-DECLARATIVE-RECORD-NO BY 1                DEC
185600         UNTIL RESTART-COUNT > LAST-DECLARATIVE-RECORD-NO.        DEC
185700*                                                                 DEC
185800 6100-RESTART-DECLARATIVES.                                       DEC
185900*                                                                 DEC
186000     CLOSE SRCEFILE.                                              DEC
186100     OPEN INPUT SRCEFILE.                                         DEC
186200     PERFORM 1110-READ-SOURCE-FILE                                DEC
186300         VARYING RESTART-COUNT FROM 1 BY 1                        DEC
186400         UNTIL RESTART-COUNT > FIRST-DECLARATIVE-RECORD-NO.       DEC
186500*                                                                 DEC
186600 6200-PRINT-DECLARATIVE-LINE.                                     DEC
186700*                                                                 DEC
186800     PERFORM 1110-READ-SOURCE-FILE.                               DEC
186900*                                                                 DEC
187000     IF ACTIVE-RECORD                                             DEC
187100         IF A-AREA NOT = SPACE                                    DEC
187200             PERFORM 1130-UNSTRING-SOURCE-LINE                    DEC
187300             IF SOURCE-WORD (2) = "SECTION"                       DEC
187400                 MOVE "*" TO PL1-ASTERISK                         DEC
187500                 PERFORM 1180-PRINT-REPORT-LINE                   DEC
187600                 MOVE DATA-AREA TO DL-CODE                        DEC
187700                 PERFORM 1180-PRINT-REPORT-LINE                   DEC
187800                 MOVE "*" TO PL1-ASTERISK                         DEC
187900                 PERFORM 1180-PRINT-REPORT-LINE.                  DEC
188000*                                                                 DEC
188100     IF ACTIVE-RECORD                                             DEC
188200         IF A-AREA = SPACE                                        DEC
188300             IF NOT USE-STATEMENT                                 DEC
188400                 PERFORM 1130-UNSTRING-SOURCE-LINE                DEC
188500                 PERFORM 6210-SEARCH-FOR-USE-VERB                 DEC
188600                     VARYING SOURCE-WORD-INDEX FROM 1 BY 1        DEC
188700                     UNTIL SOURCE-WORD-INDEX > SOURCE-WORD-COUNT  DEC
188800                        OR USE-STATEMENT                          DEC
188900                     IF USE-STATEMENT                             DEC
189000                         MOVE DATA-AREA TO DL-CODE                DEC
189100                         PERFORM 1180-PRINT-REPORT-LINE           DEC
189200                         MOVE ZERO TO PERIOD-COUNT                DEC
189300                         INSPECT DATA-AREA TALLYING PERIOD-COUNT  DEC
189400                             FOR ALL "."                          DEC
189500                         IF PERIOD-COUNT > ZERO                   DEC
189600                             MOVE "N" TO USE-STATEMENT-SW         DEC
189700                         ELSE                                     DEC
189800                             NEXT SENTENCE                        DEC
189900                     ELSE                                         DEC
190000                         NEXT SENTENCE                            DEC
190100                 ELSE                                             DEC
190200                     MOVE DATA-AREA TO DECLARATIVE-LINE           DEC
190300                     PERFORM 1180-PRINT-REPORT-LINE               DEC
190400                     MOVE ZERO TO PERIOD-COUNT                    DEC
190500                     INSPECT DATA-AREA TALLYING PERIOD-COUNT      DEC
190600                         FOR ALL "."                              DEC
190700                     IF PERIOD-COUNT > ZERO                       DEC
190800                         MOVE "N" TO USE-STATEMENT-SW.            DEC
190900*                                                                 DEC
191000 6210-SEARCH-FOR-USE-VERB.                                        DEC
191100*                                                                 DEC
191200     IF SOURCE-WORD (SOURCE-WORD-INDEX) = "USE"                   DEC
191300         MOVE "Y" TO USE-STATEMENT-SW.                            DEC
191400*                                                                 DEC
191500 7000-PRINT-PROGRAM-SUMMARY.
191600*
191700     MOVE 99 TO LINE-COUNT.
191800     IF    TABLE-OVERFLOW
191900        OR CALL-OVERFLOW
192000        OR LEVEL-OVERFLOW
192100         PERFORM 7100-PRINT-ERROR-MESSAGES.
192200     IF PRINT-UNCALLED-MODULES
192300         PERFORM 7200-PRINT-UNCALLED-MODULES.
192400     IF PRINT-CALLED-SUBPROGRAMS
192500         PERFORM 7300-PRINT-CALLED-SUBPROGRAMS.
192600     PERFORM 7400-PRINT-PROGRAM-STATISTICS.
192700*
192800 7100-PRINT-ERROR-MESSAGES.
192900*
193000     MOVE ERROR-MESSAGES-HEADING TO SHL-HEADING.
193100     MOVE SUMMARY-HEADING-LINE TO PRINT-LINE.
193200     MOVE 2 TO SPACE-CONTROL.
193300     PERFORM 1180-PRINT-REPORT-LINE.
193400     MOVE 2 TO SPACE-CONTROL.
193500     IF TABLE-OVERFLOW
193600         MOVE TABLE-OVERFLOW-MESSAGE-2 TO PRINT-LINE
193700         PERFORM 1180-PRINT-REPORT-LINE.
193800     IF CALL-OVERFLOW
193900         MOVE CALL-OVERFLOW-MESSAGE TO PRINT-LINE
194000         PERFORM 1180-PRINT-REPORT-LINE.
194100     IF LEVEL-OVERFLOW
194200         MOVE LEVEL-OVERFLOW-MESSAGE TO PRINT-LINE
194300         PERFORM 1180-PRINT-REPORT-LINE.
194400*
194500 7200-PRINT-UNCALLED-MODULES.
194600*
194700     MOVE UNCALLED-MODULES-HEADING TO SHL-HEADING.
194800     MOVE SUMMARY-HEADING-LINE TO PRINT-LINE.
194900     MOVE 2 TO SPACE-CONTROL.
195000     PERFORM 1180-PRINT-REPORT-LINE.
195100     MOVE 2 TO SPACE-CONTROL.
195200     PERFORM 7210-PRINT-UNCALLED-MODULE
195300         VARYING MODULE-INDEX FROM 1 BY 1
195400         UNTIL MODULE-INDEX > MODULE-COUNT.
195500*
195600 7210-PRINT-UNCALLED-MODULE.
195700*
195800     IF TIMES-CALLED (MODULE-INDEX) = ZERO
195900         MOVE MODULE-NAME (MODULE-INDEX) TO ML-MODULE-NAME
196000         PERFORM 1180-PRINT-REPORT-LINE.
196100*
196200 7300-PRINT-CALLED-SUBPROGRAMS.
196300*
196400     MOVE CALLED-SUBPROGRAMS-HEADING TO SHL-HEADING.
196500     MOVE SUMMARY-HEADING-LINE TO PRINT-LINE.
196600     MOVE 2 TO SPACE-CONTROL.
196700     PERFORM 1180-PRINT-REPORT-LINE.
196800     MOVE 2 TO SPACE-CONTROL.
196900     PERFORM 7310-PRINT-CALLED-SUBPROGRAM
197000         VARYING MODULE-INDEX FROM 1 BY 1
197100         UNTIL MODULE-INDEX > MODULE-COUNT.
197200*
197300 7310-PRINT-CALLED-SUBPROGRAM.
197400*
197500     IF SUBPROGRAM (MODULE-INDEX)
197600         MOVE MODULE-NAME (MODULE-INDEX) TO ML-MODULE-NAME
197700         PERFORM 1180-PRINT-REPORT-LINE.
197800*
197900 7400-PRINT-PROGRAM-STATISTICS.
198000*
198100     MOVE PROGRAM-STATISTICS-HEADING TO SHL-HEADING.
198200     MOVE SUMMARY-HEADING-LINE              TO PRINT-LINE.
198300     MOVE 2                                 TO SPACE-CONTROL.
198400     PERFORM 1180-PRINT-REPORT-LINE.
198500     MOVE "TOTAL LINES IN PROGRAM:"         TO SL-DESCRIPTION.
198600     MOVE TOTAL-LINE-COUNT                  TO SL-COUNT.
198700     MOVE 2                                 TO SPACE-CONTROL.
198800     PERFORM 1180-PRINT-REPORT-LINE.
198900     MOVE "TOTAL LINES MINUS COMMENTS:"     TO SL-DESCRIPTION.
199000     MOVE SOURCE-LINE-COUNT                 TO SL-COUNT.
199100     MOVE 1                                 TO SPACE-CONTROL.
199200     PERFORM 1180-PRINT-REPORT-LINE.
199300     MOVE "PD LINES MINUS COMMENTS:"        TO SL-DESCRIPTION.
199400     MOVE PD-LINE-COUNT                     TO SL-COUNT.
199500     PERFORM 1180-PRINT-REPORT-LINE.
199600*
199700     MOVE "NUMBER OF COBOL SECTIONS:"       TO SL-DESCRIPTION.
199800     MOVE COBOL-SECTION-COUNT               TO SL-COUNT.
199900     MOVE 2                                 TO SPACE-CONTROL.
200000     PERFORM 1180-PRINT-REPORT-LINE.
200100     MOVE "NUMBER OF COBOL PARAGRAPHS:"     TO SL-DESCRIPTION.
200200     MOVE COBOL-PARAGRAPH-COUNT             TO SL-COUNT.
200300     PERFORM 1180-PRINT-REPORT-LINE.
200400     MOVE "NUMBER OF SUBPROGRAMS USED:"     TO SL-DESCRIPTION.
200500     MOVE SUBPROGRAM-COUNT                  TO SL-COUNT.
200600     PERFORM 1180-PRINT-REPORT-LINE.
200700     MOVE "AVG. LINES PER COBOL MODULE:"    TO SL-DESCRIPTION.
200800     IF COBOL-MODULE-COUNT NOT = ZERO
200900         DIVIDE PD-LINE-COUNT BY COBOL-MODULE-COUNT
201000             GIVING SL-COUNT ROUNDED
201100     ELSE
201200         MOVE PD-LINE-COUNT                 TO SL-COUNT.
201300     PERFORM 1180-PRINT-REPORT-LINE.
201400*
201500     MOVE "NUMBER OF PERFORM STATEMENTS:"   TO SL-DESCRIPTION.
201600     MOVE PERFORM-COUNT                     TO SL-COUNT.
201700     MOVE 2                                 TO SPACE-CONTROL.
201800     PERFORM 1180-PRINT-REPORT-LINE.
201900     MOVE "NUMBER OF INLINE PERFORMS:"      TO SL-DESCRIPTION.
202000     MOVE INLINE-PERFORM-COUNT              TO SL-COUNT.
202100     PERFORM 1180-PRINT-REPORT-LINE.
202200     MOVE "NUMBER OF CALL STATEMENTS:"      TO SL-DESCRIPTION.
202300     MOVE CALL-COUNT                        TO SL-COUNT.
202400     PERFORM 1180-PRINT-REPORT-LINE.
202500     MOVE "NUMBER OF SORT STATEMENTS:"      TO SL-DESCRIPTION.
202600     MOVE SORT-COUNT                        TO SL-COUNT.
202700     PERFORM 1180-PRINT-REPORT-LINE.
202800     MOVE "NUMBER OF MERGE STATEMENTS:"     TO SL-DESCRIPTION.
202900     MOVE MERGE-COUNT                       TO SL-COUNT.
203000     PERFORM 1180-PRINT-REPORT-LINE.
203100     MOVE "NO. OF SORT/MERGE PROCEDURES:"   TO SL-DESCRIPTION.
203200     MOVE SORT-MERGE-PROCEDURE-COUNT        TO SL-COUNT.
203300     PERFORM 1180-PRINT-REPORT-LINE.
203400     MOVE "NUMBER OF GO TO STATEMENTS:"     TO SL-DESCRIPTION.
203500     MOVE GOTO-COUNT                        TO SL-COUNT.
203600     PERFORM 1180-PRINT-REPORT-LINE.
./ ADD NAME=PAYMNTC  0120-01289-01302-1139-02601-00092-00000-BC0THOR
000100 IDENTIFICATION DIVISION.                                         @
000200 PROGRAM-ID.    PAYMNTC.                                          @
000300 AUTHOR. DICK THORNTON.                                           @
000400***************************************************************** @
000500*REMARKS. PAYMAINT CREATES AND MAINTAINS THE VSAM PAYROLL MASTER* @
000600*         FILE USING TRANSACTION RECORDS.                       * @
000700*      THE INCOMING PAYROLL FILE TRANSACTION FILE IS APPLIED TO * @
000800*      THE CURRENT VSAM PAYROLL MASTER FILE. WHEN ALL           * @
000900*      TRANSACTIONS HAVE BEEN PROCESSED, JOB TOTALS ARE PRINTED.* @
001000*      FOR EACH TRANSACTION RECORD READ, THE FOLLOWING          * @
001100*      PROCESSING IS DONE:                                      * @
001200*        1. IDENTIFY THE TRANSACTION TYPE AS ADD, CHANGE, OR    * @
001300*           DELETE.                                             * @
001400*        2. EDIT AND VALIDATE ALL FIELDS FOR CORRECT DATA TYPE  * @
001500*           AND CONTENT.                                        * @
001600*        3. VERIFY THAT UPDATES AND DELETES REFER TO EXISTING   * @
001700*           MASTER FILE RECORDS, AND THAT ADDED RECORDS DO NOT  * @
001800*           PRESENTLY EXIST.                                    * @
001900*        4. PRINT AN ERROR REPORT SHOWING ALL ERRORS FOUND.     * @
002000*        5. FOR DELETES, WHERE THE CURRENT MASTER FILE RECORD   * @
002100*           IS MARKED "ACTIVE", SET THE RECORD STATUS BYTE TO   * @
002200*           'D' AND REWRITE THE RECORD. WHEN THE CURRENT MASTER * @
002300*           FILE RECORD IS MARKED DELETED, ISSUE A DELETE FOR   * @
002400*           THE RECORD. PRINT RESULTS OF THE DELETION TO THE    * @
002500*           TRANSACTION REPORT.                                 * @
002600*        6. FOR UPDATES, REPLACE THE DATA IN THE CORRESPONDING  * @
002700*           FIELDS OF THE MASTER FILE RECORD AND REWRITE THE    * @
002800*           RECORD. BLANK FIELDS IN TRANSACTION RECORDS ARE     * @
002900*           IGNORED.SHOW THE CONTENT OF CHANGED FIELDS ON THE   * @
003000*           TRANSACTION REPORT, GIVING BOTH BEFORE AND AFTER    * @
003100*           FIELD VALUES. WHEN A NON-NUMERIC FIELD IN A TRANS-  * @
003200*           ACTION RECORD CONTAINS ALL '#', THE CURRENT VALUE   * @
003300*           THE PAYROLL MASTER FILE RECORD WILL BE ERASED TO    * @
003400*           BLANKS. THIS DOES NOT APPLY TO LAST NAME, FIRST NAME* @
003500*           ADDRESS LINE 1, CITY, STATE, ZIP-5, EMPLOYEE TYPE,  * @
003600*           JOB TITLE, DEPARTMENT, LOCATION, AND COST CENTER.   * @
003700*        7. SOCIAL SECURITY NUMBER CANNOT BE CHANGED. TO DO THIS* @
003800*           REQUIRES THE CURRENT RECORD BE DELETED, AND A NEW   * @
003900*           RECORD ADDED WITH THE CORRECT SOCIAL SECURITY NUMBER* @
004000*        8. FOR ADDS, BUILD A NEW MASTER FILE RECORD AND WRITE  * @
004100*           IT TO THE VSAM MASTER FILE. PRINT THE NEW RECORD    * @
004200*           DATA ON THE TRANSACTION REPORT. NOTE THAT ADD       * @
004300*           TRANSACTIONS REQUIRE 5 TRANSACTION RECORDS, WHICH   * @
004400*           MUST BE IN ORDER IN THE TRANSACTION FILE: A1, A2,   * @
004500*           A3, A4, A5. IF ANY OF THE ADD TRANSACTION RECORDS   * @
004600*           ARE MISSING OR OUT OF ORDER THE NEW RECORD WILL NOT * @
004700*           BE WRITTEN TO THE MASTER FILE.                      * @
004800*        8. TO PROVIDE FOR A VERIFICATION RUN IN WHICH NO UPDATE* @
004900*           IS MADE TO THE MASTER FILE, A PARM FIELD IS REQUIRED* @
005000*           ON THE JCL EXEC STATEMENT. WHEN PARM=VERIFY, ALL    * @
005100*           FUNCTIONS ARE PERFORMED EXCEPT ACTUAL CHANGES TO THE* @
005200*           PAYROLL MASTER FILE. WHEN PARM=UPDATE, ALL FUNCTIONS* @
005300*           INCLUDING MASTER FILE CHANGES ARE DONE.             * @
005400*           NOTE: DURING A PARM=VERIFY RUN, CHANGES CANNOT BE   * @
005500*           SPECIFIED FOR A NEW MASTER FILE RECORD ADDED IN THIS* @
005600*           RUN, SINCE THE RECORD WILL NOT EXIST.               * @
005700***************************************************************** @
005800 ENVIRONMENT DIVISION.                                            @
005900 CONFIGURATION SECTION.                                           @
006000 SPECIAL-NAMES.                                                   @
006100     C01 IS TOP-OF-PAGE                                           @
006200     CLASS ADDRESS-CHARACTERS IS 'A' THRU 'I', 'J' THRU 'R',      @
006300                          'S' THRU 'Z', ' ', '-', '/', '.',       @
006400                          '#', '%', '&', ':', '''', ','           @
006500     CLASS NAME-CHARACTERS IS 'A' THRU 'I', 'J' THRU 'R',         @
006600                          'S' THRU 'Z', ' ', '-'                  @
006700     CLASS ALPHANUMERIC-DATA IS 'A' THRU 'I', 'J' THRU 'R',       @
006800                          'S' THRU 'Z', ' ', '-', '0' THRU '9'.   @
006900 INPUT-OUTPUT SECTION.                                            @
007000 FILE-CONTROL.                                                    @
007100     SELECT TRANSACTION-FILE ASSIGN TO TRANFILE.                  @
007200     SELECT ERROR-REPORT ASSIGN TO ERRORS.                        @
007300     SELECT TRANSACTION-REPORT ASSIGN TO TRANSRPT.                @
007400     SELECT PAYROLL-MASTER-FILE ASSIGN TO PAYMASTR                @
007500            ORGANIZATION IS INDEXED                               @
007600            ACCESS IS DYNAMIC                                     @
007700            RECORD KEY IS PR-SOCIAL-SECURITY-NBR                  @
007800            STATUS IS WS-VSAM-FILE-STATUS.                        @
007900 DATA DIVISION.                                                   @
008000 FILE SECTION.                                                    @
008100 FD  PAYROLL-MASTER-FILE                                          @
008200     RECORD CONTAINS 564 CHARACTERS.                              @
008300     COPY PAYRECRF.                                               @
008400                                                                  @
008500 FD  TRANSACTION-FILE                                             @
008600     BLOCK CONTAINS 0 RECORDS                                     @
008700     RECORD CONTAINS 80 CHARACTERS                                @
008800     RECORDING MODE IS F                                          @
008900     LABEL RECORDS ARE STANDARD.                                  @
009000 01  TRANSACTION-RECORD.                                          @     10
009100     05  TR-TYPE                    PIC X.                        @     20
009200         88  TR-ADD                   VALUE 'A'.                  @     30
009300         88  TR-CHANGE                VALUE 'C'.                  @     40
009400         88  TR-DELETE                VALUE 'D'.                  @     40
009500     05  TR-ADD-SEQ-NBR             PIC X.                        @
009600     05  TR-SOCIAL-SECURITY-NBR     PIC X(9).                     @
009700     05  FILLER                     PIC X(61).                    @
009800     05  TR-SEQUENCE-NUMBER         PIC X(8).                     @
009900 01  TRANSACTION-DELETE-RECORD.                                   @
010000     05  TR-DEL-TYPE                PIC X.                        @
010100         88  TR-DEL-DELETE            VALUE 'D'.                  @     30
010200     05  FILLER                     PIC X.                        @
010300     05  TR-DEL-SOCIAL-SECURITY-NBR PIC X(9).                     @
010400     05  FILLER                     PIC X(69).                    @
010500 01  TRANSACTION-ADD-CHANGE1.                                     @
010600     05  TR-AC1-TYPE                PIC XX.                       @     20
010700         88  TR-ADD1                  VALUE 'A1'.                 @     30
010800         88  TR-CHANGE1               VALUE 'C1'.                 @     30
010900     05  TR-AC1-SOCIAL-SECURITY-NBR PIC X(9).                     @
011000     05  TR-AC1-LAST-NAME           PIC X(12).                    @
011100     05  TR-AC1-FIRST-NAME          PIC X(12).                    @
011200     05  TR-AC1-INITIAL             PIC X.                        @
011300     05  TR-AC1-NAME-SUFFIX         PIC XXX.                      @
011400     05  TR-AC1-ADDRESS-LINE-1      PIC X(25).                    @
011500     05  FILLER                     PIC X(16).                    @
011600 01  TRANSACTION-ADD-CHANGE2.                                     @
011700     05  TR-AC2-TYPE                PIC XX.                       @     20
011800         88  TR-ADD2                  VALUE 'A2'.                 @     30
011900         88  TR-CHANGE2               VALUE 'C2'.                 @     30
012000     05  TR-AC2-SOCIAL-SECURITY-NBR PIC X(9).                     @
012100     05  TR-AC2-ADDRESS-LINE2       PIC X(25).                    @
012200     05  TR-AC2-CITY                PIC X(24).                    @
012300     05  TR-AC2-STATE               PIC X(2).                     @
012400     05  TR-AC2-ZIP-5               PIC X(5).                     @
012500     05  TR-AC2-ZIP-LAST-4          PIC X(4).                     @
012600     05  FILLER                     PIC X(9).                     @
012700 01  TRANSACTION-ADD-CHANGE3.                                     @
012800     05  TR-AC3-TYPE                PIC XX.                       @     20
012900         88  TR-ADD3                  VALUE 'A3'.                 @     30
013000         88  TR-CHANGE3               VALUE 'C3'.                 @     30
013100     05  TR-AC3-SOCIAL-SECURITY-NBR PIC X(9).                     @
013200     05  TR-AC3-EMPLOYEE-TYPE       PIC X.                        @
013300     05  TR-AC3-JOB-TITLE           PIC X(35).                    @
013400     05  TR-AC3-DEPARTMENT          PIC X(20).                    @
013500     05  TR-AC3-COST-CENTER         PIC XX.                       @
013600     05  FILLER                     PIC X(11).                    @
013700 01  TRANSACTION-ADD-CHANGE4.                                     @
013800     05  TR-AC4-TYPE                PIC XX.                       @     20
013900         88  TR-ADD4                  VALUE 'A4'.                 @     30
014000         88  TR-CHANGE4               VALUE 'C4'.                 @     30
014100     05  TR-AC4-SOCIAL-SECURITY-NBR PIC X(9).                     @
014200     05  TR-AC4-LOCATION            PIC X(20).                    @
014300     05  TR-AC4-SEMI-MTHLY-SALARY-9 PIC S9(7)V99.                 @
014400     05  TR-AC4-SEMI-MTHLY-SALARY-X REDEFINES                     @
014500         TR-AC4-SEMI-MTHLY-SALARY-9 PIC X(9).                     @
014600     05  FILLER REDEFINES TR-AC4-SEMI-MTHLY-SALARY-X.             @
014700         10  TR-AC4-BLANKS          PIC X(4).                     @
014800         10  TR-AC4-HOURLY-RATE-9   PIC S9(3)V99.                 @
014900         10  TR-AC4-HOURLY-RATE-X   REDEFINES                     @
015000             TR-AC4-HOURLY-RATE-9   PIC X(5).                     @
015100     05  TR-AC4-STATE-EXEMPTION-9   PIC S99.                      @
015200     05  TR-AC4-STATE-EXEMPTION-X   REDEFINES                     @
015300         TR-AC4-STATE-EXEMPTION-9   PIC XX.                       @
015400     05  TR-AC4-FED-EXEMPTION-9     PIC S99.                      @
015500     05  TR-AC4-FED-EXEMPTION-X     REDEFINES                     @
015600         TR-AC4-FED-EXEMPTION-9     PIC XX.                       @
015700     05  TR-AC4-FILING-STATUS       PIC X.                        @
015800         88  TR-AC4-VALID-FILING-STATUS VALUES ARE                @
015900                                    'U', 'H', 'J', 'S'.           @
016000     05  TR-AC4-HEALTH-INSURANCE-9  PIC S9(3)V99.                 @
016100     05  TR-AC4-HEALTH-INSURANCE-X  REDEFINES                     @
016200         TR-AC4-HEALTH-INSURANCE-9  PIC X(5).                     @
016300     05  TR-AC4-DENTAL-INSURANCE-9  PIC S9(3)V99.                 @
016400     05  TR-AC4-DENTAL-INSURANCE-X  REDEFINES                     @
016500         TR-AC4-DENTAL-INSURANCE-9  PIC X(5).                     @
016600     05  TR-AC4-THRIFT-PLAN-PCT-9   PIC S99V9.                    @
016700     05  TR-AC4-THRIFT-PLAN-PCT-X   REDEFINES                     @
016800         TR-AC4-THRIFT-PLAN-PCT-9   PIC X(3).                     @
016900     05  TR-AC4-HEALTH-CARE-FLEX-9  PIC S9(5)V99.                 @
017000     05  TR-AC4-HEALTH-CARE-FLEX-X  REDEFINES                     @
017100         TR-AC4-HEALTH-CARE-FLEX-9  PIC X(7).                     @
017200     05  TR-AC4-CHILD-CARE-FLEX-9   PIC S9(5)V99.                 @
017300     05  TR-AC4-CHILD-CARE-FLEX-X   REDEFINES                     @
017400         TR-AC4-CHILD-CARE-FLEX-9   PIC X(7).                     @
017500     05  FILLER                     PIC X(8).                     @
017600 01  TRANSACTION-ADD-CHANGE5.                                     @
017700     05  TR-AC5-TYPE                PIC XX.                       @     20
017800         88  TR-ADD5                  VALUE 'A5'.                 @     30
017900         88  TR-CHANGE5               VALUE 'C5'.                 @     30
018000     05  TR-AC5-SOCIAL-SECURITY-NBR PIC X(9).                     @
018100     05  TR-AC5-CREDIT-UNION-9      PIC S9(7)V99.                 @
018200     05  TR-AC5-CREDIT-UNION-X      REDEFINES                     @
018300         TR-AC5-CREDIT-UNION-9      PIC X(9).                     @
018400     05  TR-AC5-UGF-9               PIC S9(5)V99.                 @
018500     05  TR-AC5-UGF-X               REDEFINES                     @
018600         TR-AC5-UGF-9               PIC X(7).                     @
018700     05  TR-AC5-CHILDREN-INSURANC-9 PIC S9(3)V99.                 @
018800     05  TR-AC5-CHILDREN-INSURANC-X REDEFINES                     @
018900         TR-AC5-CHILDREN-INSURANC-9 PIC X(5).                     @
019000     05  TR-AC5-SPOUSE-INSURANCE-9  PIC S9(3)V99.                 @
019100     05  TR-AC5-SPOUSE-INSURANCE-X  REDEFINES                     @
019200         TR-AC5-SPOUSE-INSURANCE-9  PIC X(5).                     @
019300     05  TR-AC5-SUPPLEMENTAL-LIFE-9 PIC S9(3)V99.                 @
019400     05  TR-AC5-SUPPLEMENTAL-LIFE-X REDEFINES                     @
019500         TR-AC5-SUPPLEMENTAL-LIFE-9 PIC X(5).                     @
019600     05  TR-AC5-LONG-TERM-DISBLTY-9 PIC S9(3)V99.                 @
019700     05  TR-AC5-LONG-TERM-DISBLTY-X REDEFINES                     @
019800         TR-AC5-LONG-TERM-DISBLTY-9 PIC X(5).                     @
019900     05  TR-AC5-EMPLOYEE-ASSOC-9    PIC S9V99.                    @
020000     05  TR-AC5-EMPLOYEE-ASSOC-X    REDEFINES                     @
020100         TR-AC5-EMPLOYEE-ASSOC-9    PIC X(3).                     @
020200     05  TR-AC5-TAX-IMPUTED-INC-9   PIC S9(5)V99.                 @
020300     05  TR-AC5-TAX-IMPUTED-INC-X   REDEFINES                     @
020400         TR-AC5-TAX-IMPUTED-INC-9   PIC X(7).                     @
020500     05  TR-AC5-NONEL-PTO-ALLOT-9   PIC S99V99.                   @
020600     05  TR-AC5-NONEL-PTO-ALLOT-X   REDEFINES                     @
020700         TR-AC5-NONEL-PTO-ALLOT-9   PIC X(4).                     @
020800     05  TR-AC5-EL-PTO-ALLOT-9      PIC S99V99.                   @
020900     05  TR-AC5-EL-PTO-ALLOT-X      REDEFINES                     @
021000         TR-AC5-EL-PTO-ALLOT-9      PIC X(4).                     @
021100     05  FILLER                     PIC X(15).                    @
021200 01  TRANSACTION-CHANGE6.                                         @
021300     05  TR-CHG6-TYPE               PIC XX.                       @     20
021400         88  TR-CHANGE6               VALUE 'C6'.                 @     30
021500     05  TR-CHG6-SOCIAL-SECURITY-NBR PIC X(9).                    @
021600     05  TR-CHG6-NONEL-PTO-CARRY-9  PIC S99V99.                   @
021700     05  TR-CHG6-NONEL-PTO-CARRY-X  REDEFINES                     @
021800         TR-CHG6-NONEL-PTO-CARRY-9  PIC X(4).                     @
021900     05  TR-CHG6-NONEL-PTO-TAKEN-9  PIC S99V99.                   @
022000     05  TR-CHG6-NONEL-PTO-TAKEN-X  REDEFINES                     @
022100         TR-CHG6-NONEL-PTO-TAKEN-9  PIC X(4).                     @
022200     05  TR-CHG6-ELECT-PTO-BOUGHT-9 PIC S99V99.                   @
022300     05  TR-CHG6-ELECT-PTO-BOUGHT-X REDEFINES                     @
022400         TR-CHG6-ELECT-PTO-BOUGHT-9 PIC X(4).                     @
022500     05  TR-CHG6-ELECT-PTO-SOLD-9   PIC S99V99.                   @
022600     05  TR-CHG6-ELECT-PTO-SOLD-X   REDEFINES                     @
022700         TR-CHG6-ELECT-PTO-SOLD-9   PIC X(4).                     @
022800     05  TR-CHG6-ELECT-PTO-TAKEN-9  PIC S99V99.                   @
022900     05  TR-CHG6-ELECT-PTO-TAKEN-X  REDEFINES                     @
023000         TR-CHG6-ELECT-PTO-TAKEN-9  PIC X(4).                     @
023100     05  TR-CHG6-CUR-REGULAR-EARN-9 PIC S9(7)V99.                 @
023200     05  TR-CHG6-CUR-REGULAR-EARN-X REDEFINES                     @
023300         TR-CHG6-CUR-REGULAR-EARN-9 PIC X(9).                     @
023400     05  TR-CHG6-CUR-HOLIDAY-EARN-9 PIC S9(5)V99.                 @
023500     05  TR-CHG6-CUR-HOLIDAY-EARN-X REDEFINES                     @
023600         TR-CHG6-CUR-HOLIDAY-EARN-9 PIC X(7).                     @
023700     05  TR-CHG6-CUR-PTO-EARNINGS-9 PIC S9(5)V99.                 @
023800     05  TR-CHG6-CUR-PTO-EARNINGS-X REDEFINES                     @
023900         TR-CHG6-CUR-PTO-EARNINGS-9 PIC X(7).                     @
024000     05  TR-CHG6-CUR-FLEX-DOLLARS-9 PIC S9(5)V99.                 @
024100     05  TR-CHG6-CUR-FLEX-DOLLARS-X REDEFINES                     @
024200         TR-CHG6-CUR-FLEX-DOLLARS-9 PIC X(7).                     @
024300     05  TR-CHG6-CUR-HEALTHY-RTRN-9 PIC S9(5)V99.                 @
024400     05  TR-CHG6-CUR-HEALTHY-RTRN-X REDEFINES                     @
024500         TR-CHG6-CUR-HEALTHY-RTRN-9 PIC X(7).                     @
024600     05  FILLER                     PIC X(12).                    @
024700 01  TRANSACTION-CHANGE7.                                         @
024800     05  TR-CHG7-TYPE               PIC XX.                       @     20
024900         88  TR-CHANGE7               VALUE 'C7'.                 @     30
025000     05  TR-CHG7-SOCIAL-SECURITY-NBR PIC X(9).                    @
025100     05  TR-CHG7-CUR-MEDICAL-WAIV-9 PIC S9(5)V99.                 @
025200     05  TR-CHG7-CUR-MEDICAL-WAIV-X REDEFINES                     @
025300         TR-CHG7-CUR-MEDICAL-WAIV-9 PIC X(7).                     @
025400     05  TR-CHG7-CUR-BONUS-9        PIC S9(5)V99.                 @
025500     05  TR-CHG7-CUR-BONUS-X        REDEFINES                     @
025600         TR-CHG7-CUR-BONUS-9        PIC X(7).                     @
025700     05  TR-CHG7-CUR-UGF-BONUS-9    PIC S9(5)V99.                 @
025800     05  TR-CHG7-CUR-UGF-BONUS-X    REDEFINES                     @
025900         TR-CHG7-CUR-UGF-BONUS-9    PIC X(7).                     @
026000     05  TR-CHG7-CUR-FLOAT-HOL-9    PIC S9(5)V99.                 @
026100     05  TR-CHG7-CUR-FLOAT-HOL-X    REDEFINES                     @
026200         TR-CHG7-CUR-FLOAT-HOL-9    PIC X(7).                     @
026300     05  TR-CHG7-YTD-REG-EARN-9     PIC S9(7)V99.                 @
026400     05  TR-CHG7-YTD-REG-EARN-X     REDEFINES                     @
026500         TR-CHG7-YTD-REG-EARN-9     PIC X(9).                     @
026600     05  TR-CHG7-YTD-HOL-EARN-9     PIC S9(5)V99.                 @
026700     05  TR-CHG7-YTD-HOL-EARN-X     REDEFINES                     @
026800         TR-CHG7-YTD-HOL-EARN-9     PIC X(7).                     @
026900     05  TR-CHG7-YTD-PTO-EARNINGS-9 PIC S9(5)V99.                 @
027000     05  TR-CHG7-YTD-PTO-EARNINGS-X REDEFINES                     @
027100         TR-CHG7-YTD-PTO-EARNINGS-9 PIC X(7).                     @
027200     05  TR-CHG7-YTD-FLEX-DOLLARS-9 PIC S9(5)V99.                 @
027300     05  TR-CHG7-YTD-FLEX-DOLLARS-X REDEFINES                     @
027400         TR-CHG7-YTD-FLEX-DOLLARS-9 PIC X(7).                     @
027500     05  FILLER                     PIC X(11).                    @
027600 01  TRANSACTION-CHANGE8.                                         @
027700     05  TR-CHG8-TYPE               PIC XX.                       @     20
027800         88  TR-CHANGE8               VALUE 'C8'.                 @     30
027900     05  TR-CHG8-SOCIAL-SECURITY-NBR PIC X(9).                    @
028000     05  TR-CHG8-YTD-HEALTHY-RETRN-9 PIC S9(5)V99.                @
028100     05  TR-CHG8-YTD-HEALTHY-RETRN-X REDEFINES                    @
028200         TR-CHG8-YTD-HEALTHY-RETRN-9 PIC X(7).                    @
028300     05  TR-CHG8-YTD-MEDICAL-WAIV-9 PIC S9(5)V99.                 @
028400     05  TR-CHG8-YTD-MEDICAL-WAIV-X REDEFINES                     @
028500         TR-CHG8-YTD-MEDICAL-WAIV-9 PIC X(7).                     @
028600     05  TR-CHG8-YTD-BONUS-9        PIC S9(5)V99.                 @
028700     05  TR-CHG8-YTD-BONUS-X        REDEFINES                     @
028800         TR-CHG8-YTD-BONUS-9        PIC X(7).                     @
028900     05  TR-CHG8-YTD-UGF-BONUS-9    PIC S9(5)V99.                 @
029000     05  TR-CHG8-YTD-UGF-BONUS-X    REDEFINES                     @
029100         TR-CHG8-YTD-UGF-BONUS-9    PIC X(7).                     @
029200     05  TR-CHG8-YTD-FLOAT-HOL-9   PIC S9(5)V99.                  @
029300     05  TR-CHG8-YTD-FLOAT-HOL-X   REDEFINES                      @
029400         TR-CHG8-YTD-FLOAT-HOL-9   PIC X(7).                      @
029500     05  TR-CHG8-CUR-FED-TAX-9      PIC S9(7)V99.                 @
029600     05  TR-CHG8-CUR-FED-TAX-X      REDEFINES                     @
029700         TR-CHG8-CUR-FED-TAX-9      PIC X(9).                     @
029800     05  TR-CHG8-CUR-FICA-MHI-9     PIC S9(5)V99.                 @
029900     05  TR-CHG8-CUR-FICA-MHI-X     REDEFINES                     @
030000         TR-CHG8-CUR-FICA-MHI-9     PIC X(7).                     @
030100     05  TR-CHG8-CUR-OASDI-9        PIC S9(5)V99.                 @
030200     05  TR-CHG8-CUR-OASDI-X        REDEFINES                     @
030300         TR-CHG8-CUR-OASDI-9        PIC X(7).                     @
030400     05  FILLER                     PIC X(11).                    @
030500 01  TRANSACTION-CHANGE9.                                         @
030600     05  TR-CHG9-TYPE               PIC XX.                       @     20
030700         88  TR-CHANGE9               VALUE 'C9'.                 @     30
030800     05  TR-CHG9-SOCIAL-SECURITY-NBR PIC X(9).                    @
030900     05  TR-CHG9-CUR-STATE-TAX-9    PIC S9(5)V99.                 @
031000     05  TR-CHG9-CUR-STATE-TAX-X    REDEFINES                     @
031100         TR-CHG9-CUR-STATE-TAX-9    PIC X(7).                     @
031200     05  TR-CHG9-YTD-FED-TAX-9      PIC S9(7)V99.                 @
031300     05  TR-CHG9-YTD-FED-TAX-X      REDEFINES                     @
031400         TR-CHG9-YTD-FED-TAX-9      PIC X(9).                     @
031500     05  TR-CHG9-YTD-FICA-MHI-9     PIC S9(5)V99.                 @
031600     05  TR-CHG9-YTD-FICA-MHI-X     REDEFINES                     @
031700         TR-CHG9-YTD-FICA-MHI-9     PIC X(7).                     @
031800     05  TR-CHG9-YTD-OASDI-9        PIC S9(5)V99.                 @
031900     05  TR-CHG9-YTD-OASDI-X        REDEFINES                     @
032000         TR-CHG9-YTD-OASDI-9        PIC X(7).                     @
032100     05  TR-CHG9-YTD-STATE-TAX-9    PIC S9(5)V99.                 @
032200     05  TR-CHG9-YTD-STATE-TAX-X    REDEFINES                     @
032300         TR-CHG9-YTD-STATE-TAX-9    PIC X(7).                     @
032400     05  TR-CHG9-CUR-THRIFT-PLAN-9  PIC S9(5)V99.                 @
032500     05  TR-CHG9-CUR-THRIFT-PLAN-X  REDEFINES                     @
032600         TR-CHG9-CUR-THRIFT-PLAN-9  PIC X(7).                     @
032700     05  TR-CHG9-CUR-MED-INS-9      PIC S9(5)V99.                 @
032800     05  TR-CHG9-CUR-MED-INS-X      REDEFINES                     @
032900         TR-CHG9-CUR-MED-INS-9      PIC X(7).                     @
033000     05  TR-CHG9-CUR-DENTAL-INS-9   PIC S9(5)V99.                 @
033100     05  TR-CHG9-CUR-DENTAL-INS-X   REDEFINES                     @
033200         TR-CHG9-CUR-DENTAL-INS-9   PIC X(7).                     @
033300     05  FILLER                     PIC X(11).                    @
033400 01  TRANSACTION-CHANGEA.                                         @
033500     05  TR-CHGA-TYPE               PIC XX.                       @     20
033600         88  TR-CHANGEA               VALUE 'CA'.                 @     30
033700     05  TR-CHGA-SOCIAL-SECURITY-NBR PIC X(9).                    @
033800     05  TR-CHGA-CUR-HLTHCARE-FLX-9 PIC S9(5)V99.                 @
033900     05  TR-CHGA-CUR-HLTHCARE-FLX-X REDEFINES                     @
034000         TR-CHGA-CUR-HLTHCARE-FLX-9 PIC X(7).                     @
034100     05  TR-CHGA-CUR-CHILCARE-FLX-9 PIC S9(5)V99.                 @
034200     05  TR-CHGA-CUR-CHILCARE-FLX-X REDEFINES                     @
034300         TR-CHGA-CUR-CHILCARE-FLX-9 PIC X(7).                     @
034400     05  TR-CHGA-YTD-THRIFT-PLAN-9  PIC S9(5)V99.                 @
034500     05  TR-CHGA-YTD-THRIFT-PLAN-X  REDEFINES                     @
034600         TR-CHGA-YTD-THRIFT-PLAN-9  PIC X(7).                     @
034700     05  TR-CHGA-YTD-MEDICAL-INS-9  PIC S9(5)V99.                 @
034800     05  TR-CHGA-YTD-MEDICAL-INS-X  REDEFINES                     @
034900         TR-CHGA-YTD-MEDICAL-INS-9  PIC X(7).                     @
035000     05  TR-CHGA-YTD-DENTAL-INS-9   PIC S9(5)V99.                 @
035100     05  TR-CHGA-YTD-DENTAL-INS-X   REDEFINES                     @
035200         TR-CHGA-YTD-DENTAL-INS-9   PIC X(7).                     @
035300     05  TR-CHGA-YTD-HLTHCARE-FLX-9 PIC S9(5)V99.                 @
035400     05  TR-CHGA-YTD-HLTHCARE-FLX-X REDEFINES                     @
035500         TR-CHGA-YTD-HLTHCARE-FLX-9 PIC X(7).                     @
035600     05  TR-CHGA-YTD-CHILCARE-FLX-9 PIC S9(5)V99.                 @
035700     05  TR-CHGA-YTD-CHILCARE-FLX-X REDEFINES                     @
035800         TR-CHGA-YTD-CHILCARE-FLX-9 PIC X(7).                     @
035900     05  TR-CHGA-CUR-CREDIT-UNION-9 PIC S9(5)V99.                 @
036000     05  TR-CHGA-CUR-CREDIT-UNION-X REDEFINES                     @
036100         TR-CHGA-CUR-CREDIT-UNION-9 PIC X(7).                     @
036200     05  FILLER                     PIC X(13).                    @
036300 01  TRANSACTION-CHANGEB.                                         @
036400     05  TR-CHGB-TYPE               PIC XX.                       @     20
036500         88  TR-CHANGEB               VALUE 'CB'.                 @     30
036600     05  TR-CHGB-SOCIAL-SECURITY-NBR PIC X(9).                    @
036700     05  TR-CHGB-CUR-UGF-9          PIC S9(5)V99.                 @
036800     05  TR-CHGB-CUR-UGF-X          REDEFINES                     @
036900         TR-CHGB-CUR-UGF-9          PIC X(7).                     @
037000     05  TR-CHGB-CUR-CHILDREN-INS-9 PIC S9(5)V99.                 @
037100     05  TR-CHGB-CUR-CHILDREN-INS-X REDEFINES                     @
037200         TR-CHGB-CUR-CHILDREN-INS-9 PIC X(7).                     @
037300     05  TR-CHGB-CUR-SPOUSE-INS-9   PIC S9(5)V99.                 @
037400     05  TR-CHGB-CUR-SPOUSE-INS-X   REDEFINES                     @
037500         TR-CHGB-CUR-SPOUSE-INS-9   PIC X(7).                     @
037600     05  TR-CHGB-CUR-LTD-INS-9      PIC S9(5)V99.                 @
037700     05  TR-CHGB-CUR-LTD-INS-X      REDEFINES                     @
037800         TR-CHGB-CUR-LTD-INS-9      PIC X(7).                     @
037900     05  TR-CHGB-CUR-EMPL-ASSOC-9   PIC S9(5)V99.                 @
038000     05  TR-CHGB-CUR-EMPL-ASSOC-X   REDEFINES                     @
038100         TR-CHGB-CUR-EMPL-ASSOC-9   PIC X(7).                     @
038200     05  TR-CHGB-YTD-CREDIT-UNION-9 PIC S9(5)V99.                 @
038300     05  TR-CHGB-YTD-CREDIT-UNION-X REDEFINES                     @
038400         TR-CHGB-YTD-CREDIT-UNION-9 PIC X(7).                     @
038500     05  TR-CHGB-YTD-UGF-9          PIC S9(5)V99.                 @
038600     05  TR-CHGB-YTD-UGF-X          REDEFINES                     @
038700         TR-CHGB-YTD-UGF-9          PIC X(7).                     @
038800     05  TR-CHGB-YTD-CHILDREN-INS-9 PIC S9(5)V99.                 @
038900     05  TR-CHGB-YTD-CHILDREN-INS-X REDEFINES                     @
039000         TR-CHGB-YTD-CHILDREN-INS-9 PIC X(7).                     @
039100     05  FILLER                     PIC X(13).                    @
039200 01  TRANSACTION-CHANGEC.                                         @
039300     05  TR-CHGC-TYPE               PIC XX.                       @     20
039400         88  TR-CHANGEC               VALUE 'CC'.                 @     30
039500     05  TR-CHGC-SOCIAL-SECURITY-NBR PIC X(9).                    @
039600     05  TR-CHGC-YTD-SPOUSE-INS-9   PIC S9(5)V99.                 @
039700     05  TR-CHGC-YTD-SPOUSE-INS-X   REDEFINES                     @
039800         TR-CHGC-YTD-SPOUSE-INS-9   PIC X(7).                     @
039900     05  TR-CHGC-YTD-LTD-INSUR-9    PIC S9(5)V99.                 @
040000     05  TR-CHGC-YTD-LTD-INSUR-X    REDEFINES                     @
040100         TR-CHGC-YTD-LTD-INSUR-9    PIC X(7).                     @
040200     05  TR-CHGC-YTD-EMPLOYEE-ASS-9  PIC S9(5)V99.                @
040300     05  TR-CHGC-YTD-EMPLOYEE-ASS-X  REDEFINES                    @
040400         TR-CHGC-YTD-EMPLOYEE-ASS-9  PIC X(7).                    @
040500     05  TR-CHGC-CUR-NONEL-PTO-TKN-9 PIC S999V99.                 @
040600     05  TR-CHGC-CUR-NONEL-PTO-TKN-X REDEFINES                    @
040700         TR-CHGC-CUR-NONEL-PTO-TKN-9 PIC X(5).                    @
040800     05  TR-CHGC-CUR-NONEL-PTO-BAL-9 PIC S999V99.                 @
040900     05  TR-CHGC-CUR-NONEL-PTO-BAL-X REDEFINES                    @
041000         TR-CHGC-CUR-NONEL-PTO-BAL-9 PIC X(5).                    @
041100     05  TR-CHGC-CUR-EL-PTO-TKN-9   PIC S999V99.                  @
041200     05  TR-CHGC-CUR-EL-PTO-TKN-X   REDEFINES                     @
041300         TR-CHGC-CUR-EL-PTO-TKN-9   PIC X(5).                     @
041400     05  TR-CHGC-CUR-EL-PTO-BOT-9   PIC S999V99.                  @
041500     05  TR-CHGC-CUR-EL-PTO-BOT-X   REDEFINES                     @
041600         TR-CHGC-CUR-EL-PTO-BOT-9   PIC X(5).                     @
041700     05  TR-CHGC-CUR-EL-PTO-SOLD-9  PIC S999V99.                  @
041800     05  TR-CHGC-CUR-EL-PTO-SOLD-X  REDEFINES                     @
041900         TR-CHGC-CUR-EL-PTO-SOLD-9  PIC X(5).                     @
042000     05  TR-CHGC-CUR-EL-PTO-TAKEN-9 PIC S999V99.                  @
042100     05  TR-CHGC-CUR-EL-PTO-TAKEN-X REDEFINES                     @
042200         TR-CHGC-CUR-EL-PTO-TAKEN-9 PIC X(5).                     @
042300     05  TR-CHGC-CUR-EL-PTO-BAL-9   PIC S999V99.                  @
042400     05  TR-CHGC-CUR-EL-PTO-BAL-X   REDEFINES                     @
042500         TR-CHGC-CUR-EL-PTO-BAL-9   PIC X(5).                     @
042600     05  FILLER                     PIC X(13).                    @
042700 01  TRANSACTION-CHANGED.                                         @
042800     05  TR-CHGD-TYPE               PIC XX.                       @     20
042900         88  TR-CHANGED               VALUE 'CD'.                 @     30
043000     05  TR-CHGD-SOCIAL-SECURITY-NBR PIC X(9).                    @
043100     05  TR-CHGD-YTD-NONEL-PTO-TKN-9 PIC S999V99.                 @
043200     05  TR-CHGD-YTD-NONEL-PTO-TKN-X REDEFINES                    @
043300         TR-CHGD-YTD-NONEL-PTO-TKN-9 PIC X(5).                    @
043400     05  TR-CHGD-YTD-NONEL-PTO-BAL-9 PIC S999V99.                 @
043500     05  TR-CHGD-YTD-NONEL-PTO-BAL-X REDEFINES                    @
043600         TR-CHGD-YTD-NONEL-PTO-BAL-9 PIC X(5).                    @
044000     05  TR-CHGD-YTD-EL-PTO-BOT-9   PIC S999V99.                  @
044100     05  TR-CHGD-YTD-EL-PTO-BOT-X   REDEFINES                     @
044200         TR-CHGD-YTD-EL-PTO-BOT-9   PIC X(5).                     @
044300     05  TR-CHGD-YTD-EL-PTO-SOLD-9  PIC S999V99.                  @
044400     05  TR-CHGD-YTD-EL-PTO-SOLD-X  REDEFINES                     @
044500         TR-CHGD-YTD-EL-PTO-SOLD-9  PIC X(5).                     @
044600     05  TR-CHGD-YTD-EL-PTO-TKN-9   PIC S999V99.                  @
044700     05  TR-CHGD-YTD-EL-PTO-TKN-X   REDEFINES                     @
044800         TR-CHGD-YTD-EL-PTO-TKN-9   PIC X(5).                     @
044900     05  TR-CHGD-YTD-EL-PTO-BAL-9   PIC S999V99.                  @
045000     05  TR-CHGD-YTD-EL-PTO-BAL-X   REDEFINES                     @
045100         TR-CHGD-YTD-EL-PTO-BAL-9   PIC X(5).                     @
045200     05  FILLER                     PIC X(34).                    @
045300                                                                  @
045400 FD  ERROR-REPORT                                                 @
045500     BLOCK CONTAINS 0 RECORDS                                     @
045600     RECORD CONTAINS 133 CHARACTERS                               @
045700     RECORDING MODE IS F                                          @
045800     LABEL RECORDS ARE STANDARD.                                  @
045900 01  ERROR-LINE.                                                  @     10
046000     05  ER-CC                      PIC X.                        @     20
046100     05  ER-DATA                    PIC X(132).                   @     30
046200 01  ERROR-VSAM-LINE.                                             @
046300     05  FILLER                     PIC X.                        @
046400     05  ER-VSAM-LIT1               PIC X(17).                    @
046500     05  ER-VSAM-STATUS-CODE        PIC XX.                       @
046600     05  ER-VSAM-LIT2               PIC XX.                       @
046700     05  ER-VSAM-MSG                PIC X(80).                    @
046800     05  FILLER                     PIC X(31).                    @
046900 01  ERROR-TRANSACTION-LINE.                                      @
047000     05  FILLER                     PIC X.                        @
047100     05  ER-TRAN-ERROR-MSG          PIC X(37).                    @
047200     05  FILLER                     PIC X.                        @
047300     05  ER-TRAN-RECORD             PIC X(80).                    @
047400     05  FILLER                     PIC X(14).                    @
047500                                                                  @
047600 FD  TRANSACTION-REPORT                                           @
047700     BLOCK CONTAINS 0 RECORDS                                     @
047800     RECORD CONTAINS 133 CHARACTERS                               @
047900     RECORDING MODE IS F                                          @
048000     LABEL RECORDS ARE STANDARD.                                  @
048100 01  TRANSACTION-LINE.                                            @     10
048200     05  TL-CC                      PIC X.                        @
048300     05  TL-DATA                    PIC X(132).                   @
048400 01  TL-EOJ-COUNTS.                                               @     10
048500     05  FILLER                     PIC X.                        @     20
048600     05  TL-EOJ-COUNTER             PIC ZZ,ZZZ,ZZ9.               @     30
048700     05  FILLER                     PIC X.                        @     20
048800     05  TL-EOJ-COUNT-NAME          PIC X(121).                   @     20
048900                                                                  @
049000 WORKING-STORAGE SECTION.                                         @
049100 77  FILLER                         PIC X(36)  VALUE              @
049200     'PAYMAINT WORKING STORAGE BEGINS HERE'.                      @
049300 01  WS-SWITCHES-AND-INDICATORS.                                  @
049400     05  WS-END-OF-TRANFILE-SWITCH  PIC X VALUE 'N'.              @
049500         88  WS-END-OF-TRANFILE-DATA  VALUE IS 'Y'.               @
049600         88  WS-MORE-DATA-TO-PROCESS  VALUE IS 'N'.               @
049700     05  WS-UPDATE-SWITCH           PIC X VALUE ' '.              @
049800         88  WS-UPDATE-RUN            VALUE 'U'.                  @
049900         88  WS-VERIFY-RUN            VALUE 'V'.                  @
050000     05  WS-ERROR-INDICATOR         PIC X VALUE 'S'.              @
050100         88  WS-SUCCESSFUL-OPERATION  VALUE 'S'.                  @
050200         88  WS-OPERATION-FAILED      VALUE 'F'.                  @
050300     05  WS-TRAN-RECORD-READ-SWITCH PIC X VALUE 'N'.              @
050400         88  WS-TRAN-RECORD-ALREADY-READ VALUE 'Y'.               @
050500     05  WS-CHANGE-ERROR-INDICATOR  PIC X.                        @
050600         88  WS-CHANGE-SUCCESSFUL     VALUE 'N'.                  @
050700         88  WS-CHANGE-FAILED         VALUE 'Y'.                  @
050800                                                                  @
050900 01  WS-MISCELLANEOUS-WORK-AREAS.                                 @
051000     05  WS-ERROR-RECORDS-WRITTEN   PIC S9(8) COMP-3 VALUE +0.    @
051100     05  WS-TRANSACTIONS-READ       PIC S9(8) COMP-3 VALUE +0.    @
051200     05  WS-DELETE-TRANSACTIONS-READ PIC S9(5) COMP-3 VALUE +0.   @
051300     05  WS-ADD-TRANSACTIONS-READ   PIC S9(5) COMP-3 VALUE +0.    @
051400     05  WS-CHANGE-TRANSACTIONS-READ PIC S9(5) COMP-3 VALUE +0.   @
051500     05  WS-PAYROLL-RECORDS-READ    PIC S9(5) COMP-3 VALUE +0.    @
051600     05  WS-PAYROLL-RECORDS-WRITTEN PIC S9(5) COMP-3 VALUE +0.    @
051700     05  WS-PAYROLL-RECORDS-UPDATED PIC S9(5) COMP-3 VALUE +0.    @
051800     05  WS-PAYROLL-RECORDS-DELETED   PIC S9(5) COMP-3 VALUE +0.  @
051900     05  WS-PAYROLL-RECORDS-MARKED    PIC S9(5) COMP-3 VALUE +0.  @
052000     05  WS-CLEARED-PAYROLL-RECORD  PIC X(564).                   @
052100     05  WS-LINE-COUNT              PIC S99 COMP-3 VALUE +0.      @
052200     05  WS-LINE-SPACING            PIC 9 VALUE 1.                @
052300     05  WS-PAGE-NUMBER             PIC S9(4) COMP-3 VALUE +0.    @
052400     05  WS-TODAYS-DATE.                                          @
052500         10  WS-TODAYS-YEAR         PIC X(4).                     @
052600         10  WS-TODAYS-MONTH        PIC XX.                       @
052700         10  WS-TODAYS-DAY          PIC XX.                       @
052800     05  WS-HELD-ADDS               PIC S9 COMP-3.                @
052900     05  WS-HOLD-ADD1               PIC X(80).                    @
053000     05  WS-HOLD-ADD2               PIC X(80).                    @
053100     05  WS-HOLD-ADD3               PIC X(80).                    @
053200     05  WS-HOLD-ADD4               PIC X(80).                    @
053300     05  WS-HOLD-ADD5               PIC X(80).                    @
053400                                                                  @
053500 01  WS-HEADING-LINE-1.                                           @
053600     05  FILLER                     PIC X VALUE '2'.              @
053700     05  FILLER                     PIC X(8) VALUE 'SKELETON'.    @
053800     05  FILLER                     PIC X VALUE ' '.              @
053900     05  WS-HEADING-DATE.                                         @
054000         10  WS-HEADING-MONTH       PIC X(2).                     @
054100         10  FILLER                 PIC X VALUE '/'.              @
054200         10  WS-HEADING-DAY         PIC XX.                       @
054300         10  FILLER                 PIC X VALUE '/'.              @
054400         10  WS-HEADING-YEAR        PIC X(4).                     @
054500     05  FILLER                     PIC X(42) VALUE SPACES.       @
054600     05  FILLER                     PIC X(21) VALUE               @
054700                                   'CENTERED REPORT TITLE'.       @
054800     05  FILLER                     PIC X(41) VALUE SPACES.       @
054900     05  FILLER                     PIC X(5) VALUE 'PAGE '.       @
055000     05  WS-HEADING-PAGE-NUMBER     PIC ZZZ9.                     @
055100                                                                  @
055200 01  WS-VSAM-ERROR-DATA.                                          @
055300     05 WS-VSAM-FILE-STATUS         PIC XX    VALUE 'ZZ'.         @
055400         88  WS-VSAM-SUCCESSFUL       VALUE '00'.                 @
055500         88  WS-DUPLICATE-KEY-OK      VALUE '02'.                 @
055600         88  WS-LENGTH-DIFF-OK        VALUE '04'.                 @
055700         88  WS-OPENCLOSE-OPT-OK      VALUE '07'.                 @
055800         88  WS-END-OF-FILE           VALUE '10'.                 @
055900         88  WS-RELKEY-PAST-END       VALUE '14'.                 @
056000         88  WS-KEY-SEQ-ERROR         VALUE '21'.                 @
056100         88  WS-DUPL-KEY-WRITE-ERROR  VALUE '22'.                 @
056200         88  WS-RECD-NOT-FOUND        VALUE '23'.                 @
056300         88  WS-WRITE-PAST-END-ERROR  VALUE '24'.                 @
056400         88  WS-PERMANENT-ERROR       VALUE '30'.                 @
056500         88  WS-BOUNDARY-VIOLATION    VALUE '34'.                 @
056600         88  WS-FILE-NOT-FOUND        VALUE '35'.                 @
056700         88  WS-OPEN-FAILED           VALUE '37'.                 @
056800         88  WS-OPEN-FOR-CLOSE-LOCK   VALUE '38'.                 @
056900         88  WS-OPEN-CONFLICT-INFO    VALUE '39'.                 @
057000         88  WS-OPEN-FOR-OPEN-FILE    VALUE '41'.                 @
057100         88  WS-CLOSE-FOR-NOT-OPEN    VALUE '42'.                 @
057200         88  WS-REWRITE-SEQUENCE-ERROR VALUE '43'.                @
057300         88  WS-REWRITE-SIZE-ERROR    VALUE '44'.                 @
057400         88  WS-NO-NEXT-RECORD-ERROR  VALUE '46'.                 @
057500         88  WS-READ-FOR-OUTPUT-FILE  VALUE '47'.                 @
057600         88  WS-WRITE-FOR-INPUT-FILE  VALUE '48'.                 @
057700         88  WS-DEL-REWRITE-NOT-IO    VALUE '49'.                 @
057800         88  WS-IMPLEMENTOR-ERROR     VALUE '90'.                 @
057900         88  WS-PASSWORD-FAIL         VALUE '91'.                 @
058000         88  WS-LOGIC-ERROR           VALUE '92'.                 @
058100         88  WS-RESOURCE-NOT-AVAIL    VALUE '93'.                 @
058200         88  WS-FILE-POSITION-ERROR   VALUE '94'.                 @
058300         88  WS-INCOMPLETE-INFO-ERROR VALUE '95'.                 @
058400         88  WS-OPEN-MISSING-DD       VALUE '96'.                 @
058500         88  WS-OPEN-VERIFY-OK        VALUE '97'.                 @
058600     05  WS-VSAM-ERROR-MSG-TABLE.                                 @
058700         10 FILLER                  PIC X(80) VALUE               @
058800            '02READ SUCCESSFUL. RECORD HAS DUPLICATE KEY. DUPLICAT@
058900-           'E KEYS OK FOR THE FILE.    '.                        @
059000         10 FILLER                  PIC X(80) VALUE               @
059100            '04READ SUCCESSFUL. RECORD LENGTH DIFFERS FROM FIXED F@
059200-           'ILE ATTRIBUTES FOR THE FILE'.                        @
059300         10 FILLER                  PIC X(80) VALUE               @
059400            '07CLOSE OR OPEN SUCCESSFUL. REEL OPTION IGNORED AS FI@
059500-           'LE IS ON A NON-REEL DEVICE.'.                        @
059600         10 FILLER                  PIC X(80) VALUE               @
059700            '10READ FAILED DUE TO NORMAL END OF FILE OR OPTIONAL F@
059800-           'ILE NOT PRESENT.           '.                        @
059900         10 FILLER                  PIC X(80) VALUE               @
060000            '14READ FAILED. RELATIVE RECORD NUMBER GIVEN IS GREATE@
060100-           'R THAN SIZE OF KEY FIELD.  '.                        @
060200         10 FILLER                  PIC X(80) VALUE               @
060300            '21REWRITE FAILED. IT WOULD HAVE RESULTED KEYS BEING O@
060400-           'UT OF SEQUENCE IN THE FILE.'.                        @
060500         10 FILLER                  PIC X(80) VALUE               @
060600            '22WRITE FAILED. IT WOULD HAVE CREATED A RECORD WITH A@
060700-           'DUPLICATE KEY IN THE FILE. '.                        @
060800         10 FILLER                  PIC X(80) VALUE               @
060900            '23READ OR START FAILED. THE REQUESTED RECORD CANNOT B@
061000-           'E FOUND IN THE FILE.       '.                        @
061100         10 FILLER                  PIC X(80) VALUE               @
061200            '24WRITE FAILED. BEYOND END OF EXTERNALLY DEFINED FILE@
061300-           ' LIMITS OR REL KEY TOO BIG.'.                        @
061400         10 FILLER                  PIC X(80) VALUE               @
061500            '30PERMANENT ERROR CONDITION WITH NO FURTHER INFORMATI@
061600-           'ON AVAILABLE.              '.                        @
061700         10 FILLER                  PIC X(80) VALUE               @
061800            '34BOUNDARY VIOLATION. ATTEMPTED TO WRITE BEYOND THE E@
061900-           'XTERNALLY DEFINED FILE AREA'.                        @
062000         10 FILLER                  PIC X(80) VALUE               @
062100            '35OPEN FAILED. NON-OPTIONAL FILE NOT PRESENT FOR AN O@
062200-           'PEN INPUT, I-O OR EXTEND.  '.                        @
062300         10 FILLER                  PIC X(80) VALUE               @
062400            '37OPEN FAILED. FILE DOES NOT SUPPORT THE OPEN OPTION @
062500-           'SPECIFIED.                 '.                        @
062600         10 FILLER                  PIC X(80) VALUE               @
062700            '38OPEN FAILED. THE FILE WAS PREVIOUSLY CLOSED WITH LO@
062800-           'CK.                        '.                        @
062900         10 FILLER                  PIC X(80) VALUE               @
063000            '39OPEN FAILED. CONFLICT BETWEEN PROGRAM SPECIFIED AND@
063100-           'AND ACTUAL FILE ATTRIBUTES.'.                        @
063200         10 FILLER                  PIC X(80) VALUE               @
063300            '41OPEN FAILED. FILE WAS ALREADY OPEN.'.              @
063400         10 FILLER                  PIC X(80) VALUE               @
063500            '42CLOSE FAILED. FILE WAS NOT OPEN.'.                 @
063600         10 FILLER                  PIC X(80) VALUE               @
063700            '43REWRITE FAILED. LAST PREVIOUS OPERATION WAS NOT A S@
063800-           'UCCESSFUL READ.            '.                        @
063900         10 FILLER                  PIC X(80) VALUE               @
064000            '44(RE)WRITE FAILED. RECORD SIZE DIFFERS FROM ORIGINAL@
064100-           'OR OUTSIDE OF SIZE LIMITS. '.                        @
064200         10 FILLER                  PIC X(80) VALUE               @
064300            '46READ FAILED. READING PAST END OF FILE OR PRECEDING @
064400-           'READ FAILED.               '.                        @
064500         10 FILLER                  PIC X(80) VALUE               @
064600            '47READ FAILED. FILE WAS NOT OPEN FOR INPUT OR I-O.'. @
064700         10 FILLER                  PIC X(80) VALUE               @
064800            '48WRITE FAILED. FILE WAS NOT OPEN FOR I-O, OUTPUT, OR@
064900-           ' EXTEND MODE.              '.                        @
065000         10 FILLER                  PIC X(80) VALUE               @
065100            '49DELETE OR REWRITE FAILED. FILE WAS NOT OPEN IN THE @
065200-           'I-O MODE.                  '.                        @
065300         10 FILLER                  PIC X(80) VALUE               @
065400            '90IMPLEMENTOR DEFINED CONDITION WITH NO ADDITIONAL IN@
065500-           'FORMATION.                 '.                        @
065600         10 FILLER                  PIC X(80) VALUE               @
065700            '91PASSWORD FAILURE.'.                                @
065800         10 FILLER                  PIC X(80) VALUE               @
065900            '92LOGIC ERROR.'.                                     @
066000         10 FILLER                  PIC X(80) VALUE               @
066100            '93RESOURCE NOT AVAILABLE.'.                          @
066200         10 FILLER                  PIC X(80) VALUE               @
066300            '94NO FILE POSITION INDICATOR FOR SEQUENTIAL REQUEST. @
066400-           ' '.                                                  @
066500         10 FILLER                  PIC X(80) VALUE               @
066600            '95INVALID OR INCOMPLETE FILE INFORMATION.'.          @
066700         10 FILLER                  PIC X(80) VALUE               @
066800            '96OPEN FAILED. NO DD STATEMENT FOUND FOR OPTIONAL FIL@
066900-           'E OPENED FOR OUTPUT/EXTEND.'.                        @
067000         10 FILLER                  PIC X(80) VALUE               @
067100            '97OPEN SUCCESSFUL. FILE INTEGRITY WAS VERIFIED.'.    @
067200         10 FILLER                  PIC X(80) VALUE               @
067300            '  UNKNOWN VSAM FILE STATUS CODE RECEIVED.'.          @
067400     05  WS-VSAM-ERROR-ENTRY REDEFINES WS-VSAM-ERROR-MSG-TABLE    @
067500                                    OCCURS 32 TIMES               @
067600                                    INDEXED BY IX.                @
067700         10 WS-VSAM-ERROR-CODE      PIC XX.                       @
067800         10 WS-VSAM-ERROR-MESSAGE   PIC X(78).                    @
067900                                                                  @
068000 LINKAGE SECTION.                                                 @
068100 01  LS-EXEC-PARM-FIELD.                                          @
068200     05  LS-EXEC-PARM-LENGTH        PIC S9(4) COMP.               @
068300     05  LS-EXEC-PARM-DATA          PIC X(8).                     @
068400                                                                  @
068500 PROCEDURE DIVISION USING LS-EXEC-PARM-FIELD.                     @
068600                                                                  @
068700 A100-EXECUTIVE-CONTROL.                                          @
068800     PERFORM A200-INITIALIZATION THRU A200-EXIT.                  @
068900     PERFORM B100-MAINLINE-PROCESSING THRU B100-EXIT UNTIL        @
069000         WS-END-OF-TRANFILE-DATA.                                 @
069100     PERFORM Z100-END-OF-PROCESSING THRU Z100-EXIT.               @
069200     GOBACK.                                                      @
069300 A100-EXIT. EXIT.                                                 @
069400                                                                  @
069500 A200-INITIALIZATION.                                             @
069600     IF LS-EXEC-PARM-LENGTH = 6 AND LS-EXEC-PARM-DATA = 'VERIFY'  @
069700         MOVE 'V' TO WS-UPDATE-SWITCH                             @
069800     ELSE                                                         @
069900         IF LS-EXEC-PARM-LENGTH = 6 AND                           @
070000             LS-EXEC-PARM-DATA = 'UPDATE'                         @
070100                 MOVE 'U' TO WS-UPDATE-SWITCH                     @
070200         ELSE                                                     @
070300             DISPLAY 'PAYMAINT ABENDING: BAD EXEC PARM FIELD.'    @
070400             CALL 'COBABEND'.                                     @
070500     OPEN INPUT  TRANSACTION-FILE,                                @
070600          OUTPUT ERROR-REPORT, TRANSACTION-REPORT,                @
070700          I-O    PAYROLL-MASTER-FILE.                             @
070800     IF WS-VSAM-FILE-STATUS = '00' OR '97'                        @
070900          MOVE '00' TO WS-VSAM-FILE-STATUS                        @
071000          GO TO A100-EXIT                                         @
071100     ELSE                                                         @
071200          PERFORM X100-VSAM-ERRORS THRU X100-EXIT.                @
071300     ACCEPT WS-TODAYS-DATE FROM DATE YYYYMMDD.                    @
071400     MOVE WS-TODAYS-YEAR TO WS-HEADING-YEAR.                      @
071500     MOVE WS-TODAYS-MONTH TO WS-HEADING-MONTH.                    @
071600     MOVE WS-TODAYS-DAY TO WS-HEADING-DAY.                        @
071700     MOVE SPACES TO TRANSACTION-LINE.                             @
071800     MOVE SPACES TO ERROR-LINE.                                   @
071900     MOVE SPACES TO PAYROLL-RECORD.                               @
072000     MOVE 'A' TO PR-STATUS-INDICATOR                              @
072100     MOVE ZEROS TO PR-SEMI-MONTHLY-SALARY, PR-STATE-EXEMPTION,    @
072200         PR-FED-EXEMPTION, PR-HEALTH-INSURANCE,                   @
072300         PR-DENTAL-INSURANCE, PR-THRIFT-PLAN-PERCENT,             @
072400         PR-HEALTH-CARE-FLEX, PR-CHILD-CARE-FLEX,                 @
072500         PR-CREDIT-UNION, PR-UGF, PR-CHILDREN-INSURANCE,          @
072600         PR-SPOUSE-INSURANCE, PR-SUPPLEMENTAL-LIFE,               @
072700         PR-LONG-TERM-DISABILITY, PR-EMPLOYEE-ASSOCIATION,        @
072800         PR-TAXABLE-IMPUTED-INCOME, PR-NONELECTIVE-PTO-CARRYOVER, @
072900         PR-NONELECTIVE-PTO-ALLOTTED, PR-NONELECTIVE-PTO-TAKEN,   @
073000         PR-ELECTIVE-PTO-ALLOTTED, PR-ELECTIVE-PTO-BOUGHT,        @
073100         PR-ELECTIVE-PTO-SOLD, PR-ELECTIVE-PTO-TAKEN,             @
073200         PR-CUR-REGULAR-EARNINGS, PR-CUR-HOLIDAY-EARNINGS,        @
073300         PR-CUR-PTO-EARNINGS, PR-CUR-FLEX-DOLLARS,                @
073400         PR-CUR-HEALTHY-RETURNS, PR-CUR-MEDICAL-WAIVED,           @
073500         PR-CUR-BONUS, PR-CUR-UGF-BONUS,                          @
073600         PR-CUR-FLOATING-HOLIDAY, PR-YTD-REGULAR-EARNINGS,        @
073700         PR-YTD-HOLIDAY-EARNINGS, PR-YTD-PTO-EARNINGS,            @
073800         PR-YTD-FLEX-DOLLARS, PR-YTD-HEALTHY-RETURNS,             @
073900         PR-YTD-MEDICAL-WAIVED, PR-YTD-BONUS,                     @
074000         PR-YTD-UGF-BONUS, PR-YTD-FLOATING-HOLIDAY,               @
074100         PR-CUR-FED-TAX, PR-CUR-FICA-MHI,                         @
074200         PR-CUR-OASDI, PR-CUR-STATE-TAX,                          @
074300         PR-YTD-FED-TAX, PR-YTD-FICA-MHI,                         @
074400         PR-YTD-OASDI, PR-YTD-STATE-TAX,                          @
074500         PR-CUR-THRIFT-PLAN, PR-CUR-MEDICAL-INSURANCE,            @
074600         PR-CUR-DENTAL-INSURANCE, PR-CUR-HEALTH-CARE-FLEX,        @
074700         PR-CUR-CHILD-CARE-FLEX, PR-YTD-THRIFT-PLAN,              @
074800         PR-YTD-MEDICAL-INSURANCE, PR-YTD-DENTAL-INSURANCE,       @
074900         PR-YTD-HEALTH-CARE-FLEX, PR-YTD-CHILD-CARE-FLEX,         @
075000         PR-CUR-CREDIT-UNION, PR-CUR-UGF,                         @
075100         PR-CUR-CHILDREN-INSURANCE, PR-CUR-SPOUSE-INSURANCE,      @
075200         PR-CUR-LTD-INSURANCE, PR-CUR-EMPLOYEE-ASSOC,             @
075300         PR-YTD-CREDIT-UNION, PR-YTD-UGF,                         @
075400         PR-YTD-CHILDREN-INSURANCE, PR-YTD-SPOUSE-INSURANCE,      @
075500         PR-YTD-LTD-INSURANCE, PR-YTD-EMPLOYEE-ASSOC,             @
075600         PR-CUR-NONELECTIVE-PTO-TAKEN,                            @
075700         PR-CUR-NONELECTIVE-PTO-BALANCE,                          @
075800         PR-CUR-ELECTIVE-PTO-TAKEN, PR-CUR-ELECTIVE-PTO-BOUGHT,   @
075900         PR-CUR-ELECTIVE-PTO-SOLD, PR-CUR-ELECTIVE-PTO-TAKEN,     @
076000         PR-CUR-ELECTIVE-PTO-BALANCE,                             @
076100         PR-YTD-NONELECTIVE-PTO-TAKEN,                            @
076200         PR-YTD-NONELECTIVE-PTO-BALANCE,                          @
076300         PR-YTD-ELECTIVE-PTO-TAKEN,                               @
076400         PR-YTD-ELECTIVE-PTO-BOUGHT, PR-YTD-ELECTIVE-PTO-SOLD,    @
076500         PR-YTD-ELECTIVE-PTO-TAKEN, PR-YTD-ELECTIVE-PTO-BALANCE.  @
076600     MOVE PAYROLL-RECORD TO WS-CLEARED-PAYROLL-RECORD.            @
076700 A200-EXIT. EXIT.                                                 @
076800                                                                  @
076900 B100-MAINLINE-PROCESSING.                                        @
077000     PERFORM T100-READ-TRANSACTION-FILE THRU T100-EXIT.           @
077100     IF WS-MORE-DATA-TO-PROCESS                                   @
077200        PERFORM D100-PROCESS-THE-RECORD THRU D100-EXIT.           @
077300 B100-EXIT. EXIT.                                                 @
077400                                                                  @
077500 D100-PROCESS-THE-RECORD.                                         @
077600     MOVE 'S' TO WS-ERROR-INDICATOR                               @
077700     MOVE TR-SOCIAL-SECURITY-NBR TO PR-SOCIAL-SECURITY-NBR.       @
077800     PERFORM T200-READ-PAYROLL-MASTER THRU T200-EXIT.             @
077900     IF WS-OPERATION-FAILED                                       @
078000         GO TO D100-EXIT.                                         @
078100     IF TR-DELETE                                                 @     30
078200         PERFORM D200-PROCESS-DELETES THRU D200-EXIT              @
078300     ELSE IF TR-ADD                                               @     30
078400         PERFORM D300-PROCESS-ADDS THRU D300-EXIT                 @
078500     ELSE IF TR-CHANGE                                            @     40
078600         PERFORM D400-PROCESS-CHANGES THRU D400-EXIT              @
078700     ELSE                                                         @
078800         MOVE 'INVALID TRANSACTION CODE IN COLUMN 1:' TO          @
078900             ER-TRAN-ERROR-MSG                                    @
079000         PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT.          @
079100 D100-EXIT. EXIT.                                                 @
079200                                                                  @
079300 D200-PROCESS-DELETES.                                            @
079400     ADD +1 TO WS-DELETE-TRANSACTIONS-READ.                       @
079500     IF WS-RECD-NOT-FOUND                                         @
079600         MOVE 'DELETE FOR RECORD NOT ON FILE:' TO                 @
079700             ER-TRAN-ERROR-MSG                                    @
079800         PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT           @
079900         GO TO D200-EXIT.                                         @
080000     PERFORM T500-DELETE-PAYROLL-MASTER THRU T500-EXIT.           @
080100     IF WS-SUCCESSFUL-OPERATION                                   @
080200         ADD +1 TO WS-PAYROLL-RECORDS-DELETED.                    @
080300 D200-EXIT. EXIT.                                                 @
080400                                                                  @
080500***************************************************************** @
080600* PROCESS ADD TRANSACTIONS. EACH ADD TRANSACTION REQUIRES 5     * @
080700* TRANSACTIONS, WHICH MUST BE ENTERED IN SEQUENCE: A1, A2, A3,  * @
080800* A4, AND A5. IF ANY RECORDS ARE MISSING OR OUT OF ORDER, THE   * @
080900* TRANSACTION IS DROPPED.                                       * @
081000***************************************************************** @
081100 D300-PROCESS-ADDS.                                               @
081200     ADD +1 TO WS-ADD-TRANSACTIONS-READ.                          @
081300     MOVE WS-CLEARED-PAYROLL-RECORD TO PAYROLL-RECORD.            @
081400     IF WS-RECD-NOT-FOUND                                         @
081500         NEXT SENTENCE                                            @
081600     ELSE                                                         @
081700         MOVE 'ADD FOR RECORD ALREADY ON FILE:' TO                @
081800             ER-TRAN-ERROR-MSG                                    @
081900         PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT           @
082000         GO TO D300-EXIT.                                         @
082100     IF TR-ADD1                                                   @
082200         NEXT SENTENCE                                            @
082300     ELSE                                                         @
082400         MOVE 'ADD TRANSACTION RECORDS OUT OF ORDER' TO           @
082500             ER-TRAN-ERROR-MSG                                    @
082600         PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT           @
082700         GO TO D300-EXIT.                                         @
082800     IF TR-AC1-SOCIAL-SECURITY-NBR IS NUMERIC                     @
082900         MOVE TR-AC1-SOCIAL-SECURITY-NBR TO                       @
083000             PR-SOCIAL-SECURITY-NBR                               @
083100     ELSE                                                         @
083200         MOVE 'INVALID SOCIAL SECURITY NUMBER' TO                 @
083300             ER-TRAN-ERROR-MSG                                    @
083400         PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT           @
083500         GO TO D300-EXIT.                                         @
083600     IF TR-AC1-LAST-NAME IS NAME-CHARACTERS                       @
083700         MOVE TR-AC1-LAST-NAME TO                                 @
083800             PR-LAST-NAME                                         @
083900     ELSE                                                         @
084000         MOVE 'LAST NAME CONTAINS INVALID CHARACTERS' TO          @
084100             ER-TRAN-ERROR-MSG                                    @
084200         PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT           @
084300         GO TO D300-EXIT.                                         @
084400     IF TR-AC1-FIRST-NAME IS NAME-CHARACTERS                      @
084500         MOVE TR-AC1-FIRST-NAME TO                                @
084600             PR-FIRST-NAME                                        @
084700     ELSE                                                         @
084800         MOVE 'FIRST NAME CONTAINS INVALID CHARACTERS' TO         @
084900             ER-TRAN-ERROR-MSG                                    @
085000         PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT           @
085100         GO TO D300-EXIT.                                         @
085200     IF TR-AC1-INITIAL IS ALPHABETIC                              @
085300         MOVE TR-AC1-INITIAL TO                                   @
085400             PR-INITIAL                                           @
085500     ELSE                                                         @
085600         MOVE 'FIRST NAME CONTAINS INVALID CHARACTERS' TO         @
085700             ER-TRAN-ERROR-MSG                                    @
085800         PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT           @
085900         GO TO D300-EXIT.                                         @
086000     IF TR-AC1-NAME-SUFFIX IS ALPHABETIC                          @
086100         MOVE TR-AC1-NAME-SUFFIX TO                               @
086200             PR-NAME-SUFFIX                                       @
086300     ELSE                                                         @
086400         MOVE 'NAME SUFFIX CONTAINS INVALID CHARACTERS' TO        @
086500             ER-TRAN-ERROR-MSG                                    @
086600         PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT           @
086700         GO TO D300-EXIT.                                         @
086800     IF TR-AC1-ADDRESS-LINE-1 IS ADDRESS-CHARACTERS               @
086900         MOVE TR-AC1-ADDRESS-LINE-1 TO                            @
087000             PR-ADDRESS-LINE-1                                    @
087100     ELSE                                                         @
087200         MOVE 'NAME SUFFIX CONTAINS INVALID CHARACTERS' TO        @
087300             ER-TRAN-ERROR-MSG                                    @
087400         PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT           @
087500         GO TO D300-EXIT.                                         @
087600     MOVE TRANSACTION-ADD-CHANGE1 TO WS-HOLD-ADD1.                @
087700     MOVE 1 TO WS-HELD-ADDS.                                      @
087800*    ************************************************************ @
087900*    * THE SECOND (A2) TRANSACTION IS READ AND PROCESSED.       * @
088000*    ************************************************************ @
088100     PERFORM T100-READ-TRANSACTION-FILE THRU T100-EXIT.           @
088200     IF WS-END-OF-TRANFILE-DATA                                   @
088300         MOVE 'MISSING RECORDS FOR ADD TRANSACTION' TO            @
088400             ER-TRAN-ERROR-MSG                                    @
088500         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
088600         GO TO D300-EXIT.                                         @
088700     IF TR-ADD2                                                   @
088800         MOVE 'N' TO WS-TRAN-RECORD-READ-SWITCH                   @
088900     ELSE                                                         @
089000         MOVE 'ADD TRANSACTION RECORDS OUT OF ORDER' TO           @
089100             ER-TRAN-ERROR-MSG                                    @
089200         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
089300         MOVE 'Y' TO WS-TRAN-RECORD-READ-SWITCH                   @
089400         GO TO D300-EXIT.                                         @
089500     MOVE TRANSACTION-ADD-CHANGE2 TO WS-HOLD-ADD2.                @
089600     MOVE 2 TO WS-HELD-ADDS.                                      @
089700     IF TR-AC2-SOCIAL-SECURITY-NBR IS EQUAL TO                    @
089800         PR-SOCIAL-SECURITY-NBR                                   @
089900             NEXT SENTENCE                                        @
090000     ELSE                                                         @
090100         MOVE 'SOCIAL SECURITY MISMATCH ON A2' TO                 @
090200             ER-TRAN-ERROR-MSG                                    @
090300         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
090400         GO TO D300-EXIT.                                         @
090500     IF TR-AC2-ADDRESS-LINE2 IS ADDRESS-CHARACTERS                @
090600         MOVE TR-AC2-ADDRESS-LINE2 TO                             @
090700             PR-ADDRESS-LINE-2                                    @
090800     ELSE                                                         @
090900         MOVE 'ADDRESS LINE 2 CONTAINS INVALID CHARACTERS' TO     @
091000             ER-TRAN-ERROR-MSG                                    @
091100         PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT           @
091200         GO TO D300-EXIT.                                         @
091300     IF TR-AC2-CITY IS NAME-CHARACTERS                            @
091400         MOVE TR-AC2-CITY TO                                      @
091500             PR-CITY                                              @
091600     ELSE                                                         @
091700         MOVE 'CITY CONTAINS INVALID CHARACTERS' TO               @
091800             ER-TRAN-ERROR-MSG                                    @
091900         PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT           @
092000         GO TO D300-EXIT.                                         @
092100     IF TR-AC2-STATE IS ALPHABETIC                                @
092200         MOVE TR-AC2-STATE TO                                     @
092300             PR-STATE                                             @
092400     ELSE                                                         @
092500         MOVE 'STATE CONTAINS INVALID CHARACTERS' TO              @
092600             ER-TRAN-ERROR-MSG                                    @
092700         PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT           @
092800         GO TO D300-EXIT.                                         @
092900     IF TR-AC2-ZIP-5 IS NUMERIC AND                               @
093000        TR-AC2-ZIP-5 IS NOT EQUAL TO SPACES                       @
093100             MOVE TR-AC2-ZIP-5 TO                                 @
093200                 PR-ZIP-5                                         @
093300     ELSE                                                         @
093400         MOVE 'ZIP-5 CONTAINS INVALID CHARACTERS' TO              @
093500             ER-TRAN-ERROR-MSG                                    @
093600         PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT           @
093700         GO TO D300-EXIT.                                         @
093800     IF TR-AC2-ZIP-LAST-4 IS NUMERIC OR                           @
093900        TR-AC2-ZIP-LAST-4 IS EQUAL TO ALL SPACES                  @
094000             MOVE TR-AC2-ZIP-LAST-4 TO                            @
094100                 PR-ZIP-LAST4                                     @
094200     ELSE                                                         @
094300         MOVE 'ZIP-LAST-4 CONTAINS INVALID CHARACTERS' TO         @
094400             ER-TRAN-ERROR-MSG                                    @
094500         PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT           @
094600         GO TO D300-EXIT.                                         @
094700*    ************************************************************ @
094800*    * THE THIRD (A3) TRANSACTION IS READ AND PROCESSED.        * @
094900*    ************************************************************ @
095000     PERFORM T100-READ-TRANSACTION-FILE THRU T100-EXIT.           @
095100     IF WS-END-OF-TRANFILE-DATA                                   @
095200         MOVE 'MISSING RECORDS FOR ADD TRANSACTION' TO            @
095300             ER-TRAN-ERROR-MSG                                    @
095400         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
095500         GO TO D300-EXIT.                                         @
095600     IF TR-ADD3                                                   @
095700         MOVE 'N' TO WS-TRAN-RECORD-READ-SWITCH                   @
095800     ELSE                                                         @
095900         MOVE 'ADD TRANSACTION RECORDS OUT OF ORDER' TO           @
096000             ER-TRAN-ERROR-MSG                                    @
096100         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
096200         MOVE 'Y' TO WS-TRAN-RECORD-READ-SWITCH                   @
096300         GO TO D300-EXIT.                                         @
096400     MOVE TRANSACTION-ADD-CHANGE3 TO WS-HOLD-ADD3.                @
096500     MOVE 3 TO WS-HELD-ADDS.                                      @
096600     IF TR-AC3-SOCIAL-SECURITY-NBR IS EQUAL TO                    @
096700         PR-SOCIAL-SECURITY-NBR                                   @
096800             NEXT SENTENCE                                        @
096900     ELSE                                                         @
097000         MOVE 'SOCIAL SECURITY MISMATCH ON A3' TO                 @
097100             ER-TRAN-ERROR-MSG                                    @
097200         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
097300         GO TO D300-EXIT.                                         @
097400     IF TR-AC3-EMPLOYEE-TYPE IS EQUAL TO 'S' OR 'H' OR 'P' OR 'C' @
097500         MOVE TR-AC3-EMPLOYEE-TYPE TO                             @
097600             PR-EMPLOYEE-TYPE                                     @
097700     ELSE                                                         @
097800         MOVE 'INVALID EMPLOYEE TYPE' TO                          @
097900             ER-TRAN-ERROR-MSG                                    @
098000         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
098100         GO TO D300-EXIT.                                         @
098200     IF TR-AC3-JOB-TITLE IS NAME-CHARACTERS                       @
098300         MOVE TR-AC3-JOB-TITLE TO                                 @
098400             PR-JOB-TITLE                                         @
098500     ELSE                                                         @
098600         MOVE 'JOB TITLE CONTAINS INVALID CHARACTERS' TO          @
098700             ER-TRAN-ERROR-MSG                                    @
098800         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
098900         GO TO D300-EXIT.                                         @
099000     IF TR-AC3-DEPARTMENT IS NAME-CHARACTERS                      @
099100         MOVE TR-AC3-DEPARTMENT TO                                @
099200             PR-DEPARTMENT                                        @
099300     ELSE                                                         @
099400         MOVE 'DEPARTMENT HAS INVALID CHARACTERS' TO              @
099500             ER-TRAN-ERROR-MSG                                    @
099600         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
099700         GO TO D300-EXIT.                                         @
099800     IF TR-AC3-COST-CENTER IS ALPHANUMERIC-DATA                   @
099900         MOVE TR-AC3-COST-CENTER TO                               @
100000             PR-COST-CENTER                                       @
100100     ELSE                                                         @
100200         MOVE 'COST CENTER HAS INVALID CHARACTERS' TO             @
100300             ER-TRAN-ERROR-MSG                                    @
100400         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
100500         GO TO D300-EXIT.                                         @
100600*    ************************************************************ @
100700*    * THE FOURTH (A4) TRANSACTION IS READ AND PROCESSED.       * @
100800*    ************************************************************ @
100900     PERFORM T100-READ-TRANSACTION-FILE THRU T100-EXIT.           @
101000     IF WS-END-OF-TRANFILE-DATA                                   @
101100         MOVE 'MISSING RECORDS FOR ADD TRANSACTION' TO            @
101200             ER-TRAN-ERROR-MSG                                    @
101300         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
101400         GO TO D300-EXIT.                                         @
101500     IF TR-ADD4                                                   @
101600         MOVE 'N' TO WS-TRAN-RECORD-READ-SWITCH                   @
101700     ELSE                                                         @
101800         MOVE 'ADD TRANSACTION RECORDS OUT OF ORDER' TO           @
101900             ER-TRAN-ERROR-MSG                                    @
102000         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
102100         MOVE 'Y' TO WS-TRAN-RECORD-READ-SWITCH                   @
102200         GO TO D300-EXIT.                                         @
102300     MOVE TRANSACTION-ADD-CHANGE4 TO WS-HOLD-ADD4.                @
102400     MOVE 4 TO WS-HELD-ADDS.                                      @
102500     IF TR-AC4-SOCIAL-SECURITY-NBR IS EQUAL TO                    @
102600         PR-SOCIAL-SECURITY-NBR                                   @
102700             NEXT SENTENCE                                        @
102800     ELSE                                                         @
102900         MOVE 'SOCIAL SECURITY MISMATCH ON A4' TO                 @
103000             ER-TRAN-ERROR-MSG                                    @
103100         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
103200         GO TO D300-EXIT.                                         @
103300     IF TR-AC4-LOCATION IS NAME-CHARACTERS AND                    @
103400        TR-AC4-LOCATION IS EQUAL TO SPACES                        &
103500             MOVE TR-AC4-LOCATION TO                              @
103600                 PR-LOCATION                                      @
103700     ELSE                                                         @
103800         MOVE 'LOCATION CONTAINS INVALID CHARACTERS' TO           @
103900             ER-TRAN-ERROR-MSG                                    @
104000         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
104100         GO TO D300-EXIT.                                         @
104200     IF TR-AC4-SEMI-MTHLY-SALARY-X IS NUMERIC                     @
104300         MOVE TR-AC4-SEMI-MTHLY-SALARY-9 TO                       @
104400             PR-SEMI-MONTHLY-SALARY                               @
104500     ELSE                                                         @
104600         IF TR-AC4-HOURLY-RATE-X IS NUMERIC AND                   @
104700             TR-AC4-BLANKS IS EQUAL TO SPACES                     @
104800                 MOVE TR-AC4-HOURLY-RATE-9 TO                     @
104900                     PR-HOURLY-RATE                               @
105000         ELSE                                                     @
105100             MOVE 'INVALID HOURLY RATE' TO                        @
105200                 ER-TRAN-ERROR-MSG                                @
105300             PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT @
105400             GO TO D300-EXIT.                                     @
105500     IF TR-AC4-STATE-EXEMPTION-X IS NUMERIC                       @
105600         MOVE TR-AC4-STATE-EXEMPTION-9 TO                         @
105700             PR-STATE-EXEMPTION                                   @
105800     ELSE                                                         @
105900         MOVE 'INVALID STATE EXEMPTION' TO                        @
106000             ER-TRAN-ERROR-MSG                                    @
106100         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
106200         GO TO D300-EXIT.                                         @
106300     IF TR-AC4-FED-EXEMPTION-X IS NUMERIC                         @
106400         MOVE TR-AC4-FED-EXEMPTION-9 TO                           @
106500             PR-FED-EXEMPTION                                     @
106600     ELSE                                                         @
106700         MOVE 'INVALID FED EXEMPTION' TO                          @
106800             ER-TRAN-ERROR-MSG                                    @
106900         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
107000         GO TO D300-EXIT.                                         @
107100     IF TR-AC4-VALID-FILING-STATUS                                @
107200         MOVE TR-AC4-FILING-STATUS TO                             @
107300             PR-FILING-STATUS                                     @
107400     ELSE                                                         @
107500         MOVE 'FILING STATUS IS INVALID' TO                       @
107600             ER-TRAN-ERROR-MSG                                    @
107700         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
107800         GO TO D300-EXIT.                                         @
107900     IF TR-AC4-HEALTH-INSURANCE-X IS NUMERIC                      @
108000         MOVE TR-AC4-HEALTH-INSURANCE-9 TO                        @
108100             PR-HEALTH-INSURANCE                                  @
108200     ELSE                                                         @
108300         MOVE 'HEALTH-INSURANCE IS INVALID' TO                    @
108400             ER-TRAN-ERROR-MSG                                    @
108500         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
108600         GO TO D300-EXIT.                                         @
108700     IF TR-AC4-DENTAL-INSURANCE-X IS NUMERIC                      @
108800         MOVE TR-AC4-DENTAL-INSURANCE-9 TO                        @
108900             PR-DENTAL-INSURANCE                                  @
109000     ELSE                                                         @
109100         MOVE 'DENTAL INSURANCE IS INVALID' TO                    @
109200             ER-TRAN-ERROR-MSG                                    @
109300         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
109400         GO TO D300-EXIT.                                         @
109500     IF TR-AC4-THRIFT-PLAN-PCT-X IS NUMERIC                       @
109600         MOVE TR-AC4-THRIFT-PLAN-PCT-9 TO                         @
109700             PR-THRIFT-PLAN-PERCENT                               @
109800     ELSE                                                         @
109900         MOVE 'INVALID THRIFT-PLAN-PCT' TO                        @
110000             ER-TRAN-ERROR-MSG                                    @
110100         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
110200         GO TO D300-EXIT.                                         @
110300     IF TR-AC4-HEALTH-CARE-FLEX-X IS NUMERIC                      @
110400         MOVE TR-AC4-HEALTH-CARE-FLEX-9 TO                        @
110500             PR-HEALTH-CARE-FLEX                                  @
110600     ELSE                                                         @
110700         MOVE 'HEALTH-CARE-FLEX INVALID' TO                       @
110800             ER-TRAN-ERROR-MSG                                    @
110900         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
111000         GO TO D300-EXIT.                                         @
111100     IF TR-AC4-CHILD-CARE-FLEX-X IS NUMERIC                       @
111200         MOVE TR-AC4-CHILD-CARE-FLEX-9 TO                         @
111300             PR-CHILD-CARE-FLEX                                   @
111400     ELSE                                                         @
111500         MOVE 'INVALID CHILD-CARE-FLEX' TO                        @
111600             ER-TRAN-ERROR-MSG                                    @
111700         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
111800         GO TO D300-EXIT.                                         @
111900*    ************************************************************ @
112000*    * THE FIFTH (A5) TRANSACTION IS READ AND PROCESSED.        * @
112100*    ************************************************************ @
112200     PERFORM T100-READ-TRANSACTION-FILE THRU T100-EXIT.           @
112300     IF WS-END-OF-TRANFILE-DATA                                   @
112400         MOVE 'MISSING RECORDS FOR ADD TRANSACTION' TO            @
112500             ER-TRAN-ERROR-MSG                                    @
112600         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
112700         GO TO D300-EXIT.                                         @
112800     IF TR-ADD5                                                   @
112900         MOVE 'N' TO WS-TRAN-RECORD-READ-SWITCH                   @
113000     ELSE                                                         @
113100         MOVE 'ADD TRANSACTION RECORDS OUT OF ORDER' TO           @
113200             ER-TRAN-ERROR-MSG                                    @
113300         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
113400         MOVE 'Y' TO WS-TRAN-RECORD-READ-SWITCH                   @
113500         GO TO D300-EXIT.                                         @
113600     MOVE TRANSACTION-ADD-CHANGE5 TO WS-HOLD-ADD5.                @
113700     MOVE 5 TO WS-HELD-ADDS.                                      @
113800     IF TR-AC5-SOCIAL-SECURITY-NBR IS EQUAL TO                    @
113900         PR-SOCIAL-SECURITY-NBR                                   @
114000             NEXT SENTENCE                                        @
114100     ELSE                                                         @
114200         MOVE 'SOCIAL SECURITY MISMATCH ON A5' TO                 @
114300             ER-TRAN-ERROR-MSG                                    @
114400         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
114500         GO TO D300-EXIT.                                         @
114600     IF TR-AC5-CREDIT-UNION-X IS NUMERIC                          @
114700         MOVE TR-AC5-CREDIT-UNION-9 TO                            @
114800             PR-CREDIT-UNION                                      @
114900     ELSE                                                         @
115000         MOVE 'INVALID CREDIT-UNION AMOUNT' TO                    @
115100             ER-TRAN-ERROR-MSG                                    @
115200         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
115300         GO TO D300-EXIT.                                         @
115400     IF TR-AC5-UGF-X IS NUMERIC                                   @
115500         MOVE TR-AC5-UGF-9 TO                                     @
115600             PR-UGF                                               @
115700     ELSE                                                         @
115800         MOVE 'UGF AMOUNT INVALID' TO                             @
115900             ER-TRAN-ERROR-MSG                                    @
116000         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
116100         GO TO D300-EXIT.                                         @
116200     IF TR-AC5-CHILDREN-INSURANC-X IS NUMERIC                     @
116300         MOVE TR-AC5-CHILDREN-INSURANC-9 TO                       @
116400             PR-CHILDREN-INSURANCE                                @
116500     ELSE                                                         @
116600         MOVE 'INVALID CHILDREN-INSURANCE' TO                     @
116700             ER-TRAN-ERROR-MSG                                    @
116800         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
116900         GO TO D300-EXIT.                                         @
117000     IF TR-AC5-SPOUSE-INSURANCE-X IS NUMERIC                      @
117100         MOVE TR-AC5-SPOUSE-INSURANCE-9 TO                        @
117200             PR-SPOUSE-INSURANCE                                  @
117300     ELSE                                                         @
117400         MOVE 'INVALID SPOUSE-INSURANCE' TO                       @
117500             ER-TRAN-ERROR-MSG                                    @
117600         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
117700         GO TO D300-EXIT.                                         @
117800     IF TR-AC5-SUPPLEMENTAL-LIFE-X IS NUMERIC                     @
117900         MOVE TR-AC5-SUPPLEMENTAL-LIFE-9 TO                       @
118000             PR-SUPPLEMENTAL-LIFE                                 @
118100     ELSE                                                         @
118200         MOVE 'INVALID SUPPLEMENTAL-LIFE' TO                      @
118300             ER-TRAN-ERROR-MSG                                    @
118400         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
118500         GO TO D300-EXIT.                                         @
118600     IF TR-AC5-LONG-TERM-DISBLTY-X IS NUMERIC                     @
118700         MOVE TR-AC5-LONG-TERM-DISBLTY-9 TO                       @
118800             PR-LONG-TERM-DISABILITY                              @
118900     ELSE                                                         @
119000         MOVE 'INVALID LONG-TERM-DISABILITY' TO                   @
119100             ER-TRAN-ERROR-MSG                                    @
119200         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
119300         GO TO D300-EXIT.                                         @
119400     IF TR-AC5-EMPLOYEE-ASSOC-X IS NUMERIC                        @
119500         MOVE TR-AC5-EMPLOYEE-ASSOC-9 TO                          @
119600             PR-EMPLOYEE-ASSOCIATION                              @
119700     ELSE                                                         @
119800         MOVE 'EMPLOYEE-ASSOC INVALID               ' TO          @
119900             ER-TRAN-ERROR-MSG                                    @
120000         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
120100         GO TO D300-EXIT.                                         @
120200     IF TR-AC5-TAX-IMPUTED-INC-X IS NUMERIC                       @
120300         MOVE TR-AC5-TAX-IMPUTED-INC-9 TO                         @
120400             PR-TAXABLE-IMPUTED-INCOME                            @
120500     ELSE                                                         @
120600         MOVE '                                     ' TO          @
120700             ER-TRAN-ERROR-MSG                                    @
120800         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
120900         GO TO D300-EXIT.                                         @
121000     IF TR-AC5-NONEL-PTO-ALLOT-X IS NUMERIC                       @
121100         MOVE TR-AC5-NONEL-PTO-ALLOT-9 TO                         @
121200             PR-NONELECTIVE-PTO-ALLOTTED                          @
121300     ELSE                                                         @
121400         MOVE 'INVALID NONELECTIVEO-ALLOTTED' TO                  @
121500             ER-TRAN-ERROR-MSG                                    @
121600         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
121700         GO TO D300-EXIT.                                         @
121800     IF TR-AC5-EL-PTO-ALLOT-X IS NUMERIC                          @
121900         MOVE TR-AC5-EL-PTO-ALLOT-9 TO                            @
122000             PR-ELECTIVE-PTO-ALLOTTED                             @
122100     ELSE                                                         @
122200         MOVE 'INVALID ELECTIVE-PTO-ALLOTTED' TO                  @
122300             ER-TRAN-ERROR-MSG                                    @
122400         PERFORM X510-TRANSACTION-SEQUENCE-ERR THRU X510-EXIT     @
122500         GO TO D300-EXIT.                                         @
122600     PERFORM T300-WRITE-PAYROLL-MASTER THRU T300-EXIT.            @
122700     IF WS-SUCCESSFUL-OPERATION                                   @
122800         ADD +1 TO WS-PAYROLL-RECORDS-DELETED.                    @
122900 D300-EXIT. EXIT.                                                 @
123000                                                                  @
123100                                                                  @
123200 D400-PROCESS-CHANGES.                                            @
123300     ADD +1 TO WS-CHANGE-TRANSACTIONS-READ.                       @
123400     IF WS-RECD-NOT-FOUND                                         @
123500         MOVE 'CHANGE FOR RECORD NOT ON FILE:' TO                 @
123600             ER-TRAN-ERROR-MSG                                    @
123700         PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT           @
123800         GO TO D400-EXIT.                                         @
123900     MOVE 'Y' TO WS-CHANGE-ERROR-INDICATOR.                       @
124000     EVALUATE TR-AC1-TYPE                                         @
124100         WHEN 'C1' PERFORM D401-PROCESS-C1 THRU D401-EXIT         @
124200         WHEN 'C2' PERFORM D402-PROCESS-C2 THRU D402-EXIT         @
124300         WHEN 'C3' PERFORM D403-PROCESS-C3 THRU D403-EXIT         @
124400         WHEN 'C4' PERFORM D404-PROCESS-C4 THRU D404-EXIT         @
124500         WHEN 'C5' PERFORM D405-PROCESS-C5 THRU D405-EXIT         @
124600         WHEN 'C6' PERFORM D406-PROCESS-C6 THRU D406-EXIT         @
124700         WHEN 'C7' PERFORM D407-PROCESS-C7 THRU D407-EXIT         @
124800         WHEN 'C8' PERFORM D408-PROCESS-C8 THRU D408-EXIT         @
124900         WHEN 'C9' PERFORM D409-PROCESS-C9 THRU D409-EXIT         @
125000         WHEN 'CA' PERFORM D40A-PROCESS-CA THRU D40A-EXIT         @
125100         WHEN 'CB' PERFORM D40B-PROCESS-CB THRU D40B-EXIT         @
125200         WHEN 'CC' PERFORM D40C-PROCESS-CC THRU D40C-EXIT         @
125300         WHEN 'CD' PERFORM D40D-PROCESS-CD THRU D40D-EXIT         @
125400         WHEN OTHER                                               @
125500         MOVE 'INVALID CHANGE SEQUENCE NUMBER' TO                 @
125600             ER-TRAN-ERROR-MSG                                    @
125700         PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT           @
125800         GO TO D400-EXIT.                                         @
125900     IF WS-CHANGE-SUCCESSFUL                                      @
126000         PERFORM T400-UPDATE-PAYROLL-MASTER THRU T400-EXIT        @
126100             IF WS-SUCCESSFUL-OPERATION                           @
126200                 ADD +1 TO WS-PAYROLL-RECORDS-DELETED.            @
126300 D400-EXIT. EXIT.                                                 @
126400                                                                  @
126500 D401-PROCESS-C1.                                                 @
126600     IF TR-AC1-LAST-NAME IS EQUAL TO SPACES                       @
126700         NEXT SENTENCE                                            @
126800     ELSE                                                         @
126900         IF TR-AC1-LAST-NAME IS NAME-CHARACTERS                   @
127000             MOVE TR-AC1-LAST-NAME TO PR-LAST-NAME                @
127100         ELSE                                                     @
127200             MOVE 'INVALID LAST NAME' TO                          @
127300                 ER-TRAN-ERROR-MSG                                @
127400             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
127500             GO TO D401-EXIT.                                     @
127600     IF TR-AC1-FIRST-NAME IS EQUAL TO SPACES                      @
127700         NEXT SENTENCE                                            @
127800     ELSE                                                         @
127900         IF TR-AC1-FIRST-NAME IS NAME-CHARACTERS                  @
128000             MOVE TR-AC1-FIRST-NAME TO PR-FIRST-NAME              @
128100         ELSE                                                     @
128200             MOVE 'INVALID FIRST NAME' TO                         @
128300                 ER-TRAN-ERROR-MSG                                @
128400             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
128500             GO TO D401-EXIT.                                     @
128600     IF TR-AC1-INITIAL IS EQUAL TO SPACES                         @
128700         NEXT SENTENCE                                            @
128800     ELSE                                                         @
128900         IF TR-AC1-INITIAL IS ALPHABETIC                          @
129000             MOVE TR-AC1-INITIAL TO PR-INITIAL                    @
129100         ELSE                                                     @
129200             MOVE 'INVALID MIDDLE INITIAL' TO                     @
129300                 ER-TRAN-ERROR-MSG                                @
129400             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
129500             GO TO D401-EXIT.                                     @
129600     IF TR-AC1-NAME-SUFFIX IS ADDRESS-CHARACTERS                  @
129700         MOVE TR-AC1-NAME-SUFFIX TO PR-NAME-SUFFIX                @
129800     ELSE                                                         @
129900         MOVE 'INVALID NAME SUFFIX' TO                            @
130000             ER-TRAN-ERROR-MSG                                    @
130100         PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT           @
130200         GO TO D401-EXIT.                                         @
130300     IF TR-AC1-ADDRESS-LINE-1 IS ADDRESS-CHARACTERS               @
130400         MOVE TR-AC1-ADDRESS-LINE-1 TO PR-ADDRESS-LINE-1          @
130500     ELSE                                                         @
130600         MOVE 'INVALID ADDRESS LINE 1' TO                         @
130700             ER-TRAN-ERROR-MSG                                    @
130800         PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT           @
130900         GO TO D401-EXIT.                                         @
131000     MOVE 'N' TO WS-CHANGE-ERROR-INDICATOR.                       @
131100 D401-EXIT. EXIT.                                                 @
131200                                                                  @
131300 D402-PROCESS-C2.                                                 @
131400     IF TR-AC2-ADDRESS-LINE2 IS EQUAL TO SPACES                   @
131500         NEXT SENTENCE                                            @
131600     ELSE                                                         @
131700         IF TR-AC2-ADDRESS-LINE2 IS EQUAL TO ALL '#'              @
131800             MOVE SPACES TO PR-ADDRESS-LINE-2                     @
131900         ELSE                                                     @
132000             IF TR-AC2-ADDRESS-LINE2 IS ADDRESS-CHARACTERS        @
132100                 MOVE TR-AC2-ADDRESS-LINE2 TO                     @
132200                     PR-ADDRESS-LINE-2                            @
132300             ELSE                                                 @
132400                 MOVE 'INVALID ADDRESS LINE 2' TO                 @
132500                     ER-TRAN-ERROR-MSG                            @
132600                 PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT   @
132700                 GO TO D402-EXIT.                                 @
132800     IF TR-AC2-CITY IS EQUAL TO SPACES                            @
132900         NEXT SENTENCE                                            @
133000     ELSE                                                         @
133100         IF TR-AC2-CITY IS NAME-CHARACTERS                        @
133200             MOVE TR-AC2-CITY TO PR-CITY                          @
133300         ELSE                                                     @
133400             MOVE 'INVALID CITY' TO                               @
133500                 ER-TRAN-ERROR-MSG                                @
133600             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
133700             GO TO D402-EXIT.                                     @
133800     IF TR-AC2-STATE IS EQUAL TO SPACES                           @
133900         NEXT SENTENCE                                            @
134000     ELSE                                                         @
134100         IF TR-AC2-STATE IS ALPHABETIC                            @
134200             MOVE TR-AC2-STATE TO PR-STATE                        @
134300         ELSE                                                     @
134400             MOVE 'INVALID STATE' TO                              @
134500                 ER-TRAN-ERROR-MSG                                @
134600             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
134700             GO TO D402-EXIT.                                     @
134800     IF TR-AC2-ZIP-5 IS EQUAL TO SPACES                           @
134900         NEXT SENTENCE                                            @
135000     ELSE                                                         @
135100         IF TR-AC2-ZIP-5 IS NUMERIC                               @
135200             MOVE TR-AC2-ZIP-5 TO PR-ZIP-5                        @
135300         ELSE                                                     @
135400             MOVE 'INVALID ZIP-5' TO                              @
135500                 ER-TRAN-ERROR-MSG                                @
135600             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
135700             GO TO D402-EXIT.                                     @
135800     IF TR-AC2-ZIP-LAST-4 IS EQUAL TO SPACES                      @
135900         NEXT SENTENCE                                            @
136000     ELSE                                                         @
136100         IF TR-AC2-ZIP-LAST-4 IS EQUAL TO ALL '#'                 @
136200             MOVE SPACES TO PR-ZIP-LAST4                          @
136300         ELSE                                                     @
136400             IF TR-AC2-ZIP-LAST-4 IS NUMERIC                      @
136500                 MOVE TR-AC2-ZIP-LAST-4 TO PR-ZIP-LAST4           @
136600             ELSE                                                 @
136700                 MOVE 'INVALID ZIP-LAST-4' TO                     @
136800                     ER-TRAN-ERROR-MSG                            @
136900                 PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT   @
137000                 GO TO D402-EXIT.                                 @
137100     MOVE 'N' TO WS-CHANGE-ERROR-INDICATOR.                       @
137200 D402-EXIT. EXIT.                                                 @
137300                                                                  @
137400 D403-PROCESS-C3.                                                 @
137500     IF TR-AC3-EMPLOYEE-TYPE IS EQUAL TO SPACE                    @
137600         NEXT SENTENCE                                            @
137700     ELSE                                                         @
137800         IF TR-AC3-EMPLOYEE-TYPE = 'S' OR 'H' OR 'P' OR 'C'       @
137900             MOVE TR-AC3-EMPLOYEE-TYPE TO                         @
138000                     PR-EMPLOYEE-TYPE                             @
138100             ELSE                                                 @
138200                 MOVE 'INVALID EMPLOYEE TYPE' TO                  @
138300                     ER-TRAN-ERROR-MSG                            @
138400                 PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT   @
138500                 GO TO D403-EXIT.                                 @
138600     IF TR-AC3-JOB-TITLE IS EQUAL TO SPACE                        @
138700         NEXT SENTENCE                                            @
138800     ELSE                                                         @
138900         IF TR-AC3-JOB-TITLE IS NAME-CHARACTERS                   @
139000             MOVE TR-AC3-JOB-TITLE TO PR-JOB-TITLE                @
139100             ELSE                                                 @
139200                 MOVE 'INVALID JOB TITLE' TO                      @
139300                     ER-TRAN-ERROR-MSG                            @
139400                 PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT   @
139500                 GO TO D403-EXIT.                                 @
139600     IF TR-AC3-DEPARTMENT IS EQUAL TO SPACE                       @
139700         NEXT SENTENCE                                            @
139800     ELSE                                                         @
139900         IF TR-AC3-DEPARTMENT IS NAME-CHARACTERS                  @
140000             MOVE TR-AC3-DEPARTMENT TO PR-DEPARTMENT              @
140100             ELSE                                                 @
140200                 MOVE 'INVALID DEPARTMENT' TO                     @
140300                     ER-TRAN-ERROR-MSG                            @
140400                 PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT   @
140500                 GO TO D403-EXIT.                                 @
140600     IF TR-AC3-COST-CENTER IS EQUAL TO SPACE                      @
140700         NEXT SENTENCE                                            @
140800     ELSE                                                         @
140900         IF TR-AC3-COST-CENTER IS ADDRESS-CHARACTERS              @
141000             MOVE TR-AC3-COST-CENTER TO PR-COST-CENTER            @
141100             ELSE                                                 @
141200                 MOVE 'INVALID COST-CENTER' TO                    @
141300                     ER-TRAN-ERROR-MSG                            @
141400                 PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT   @
141500                 GO TO D403-EXIT.                                 @
141600     MOVE 'N' TO WS-CHANGE-ERROR-INDICATOR.                       @
141700 D403-EXIT. EXIT.                                                 @
141800                                                                  @
141900 D404-PROCESS-C4.                                                 @
142000     IF TR-AC4-LOCATION IS EQUAL TO SPACES                        @
142100         NEXT SENTENCE                                            @
142200     ELSE                                                         @
142300         IF TR-AC4-LOCATION IS ADDRESS-CHARACTERS                 @
142400             MOVE TR-AC4-LOCATION TO                              @
142500                     PR-LOCATION                                  @
142600             ELSE                                                 @
142700                 MOVE 'INVALID LOCATION' TO                       @
142800                     ER-TRAN-ERROR-MSG                            @
142900                 PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT   @
143000                 GO TO D404-EXIT.                                 @
143100     IF TR-AC4-DENTAL-INSURANCE-X IS EQUAL TO SPACES              @
143200         NEXT SENTENCE                                            @
143300     ELSE                                                         @
143400         IF TR-AC4-DENTAL-INSURANCE-X IS NUMERIC                  @
143500             MOVE TR-AC4-DENTAL-INSURANCE-9 TO                    @
143600                     PR-DENTAL-INSURANCE                          @
143700             ELSE                                                 @
143800                 MOVE 'INVALID DENTAL-INSURANCE' TO               @
143900                     ER-TRAN-ERROR-MSG                            @
144000                 PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT   @
144100                 GO TO D404-EXIT.                                 @
144200     IF TR-AC4-SEMI-MTHLY-SALARY-X IS NUMERIC                     @
144300         MOVE TR-AC4-SEMI-MTHLY-SALARY-9 TO                       @
144400                 PR-SEMI-MONTHLY-SALARY                           @
144500     ELSE                                                         @
144600         IF TR-AC4-BLANKS IS EQUAL TO SPACES AND                  @
144700            TR-AC4-HOURLY-RATE-X IS NUMERIC                       @
144800                MOVE TR-AC4-HOURLY-RATE-9 TO                      @
144900                    PR-HOURLY-RATE                                @
145000         ELSE                                                     @
145100             IF TR-AC4-SEMI-MTHLY-SALARY-X IS EQUAL TO SPACES     @
145200                 NEXT SENTENCE                                    @
145300         ELSE                                                     @
145400             MOVE 'INVALID SEMI-MTHLY-SALARY' TO                  @
145500                 ER-TRAN-ERROR-MSG                                @
145600             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
145700             GO TO D404-EXIT.                                     @
145800     IF TR-AC4-STATE-EXEMPTION-X IS EQUAL TO SPACES               @
145900         NEXT SENTENCE                                            @
146000     ELSE                                                         @
146100         IF TR-AC4-STATE-EXEMPTION-X IS NUMERIC                   @
146200             MOVE TR-AC4-STATE-EXEMPTION-9 TO                     @
146300                     PR-STATE-EXEMPTION                           @
146400             ELSE                                                 @
146500                 MOVE 'INVALID STATE-EXEMPTION' TO                @
146600                     ER-TRAN-ERROR-MSG                            @
146700                 PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT   @
146800                 GO TO D404-EXIT.                                 @
146900     IF TR-AC4-FED-EXEMPTION-X IS EQUAL TO SPACES                 @
147000         NEXT SENTENCE                                            @
147100     ELSE                                                         @
147200         IF TR-AC4-FED-EXEMPTION-X IS NUMERIC                     @
147300             MOVE TR-AC4-FED-EXEMPTION-9 TO                       @
147400                     PR-FED-EXEMPTION                             @
147500             ELSE                                                 @
147600                 MOVE 'INVALID FED-EXEMPTION' TO                  @
147700                     ER-TRAN-ERROR-MSG                            @
147800                 PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT   @
147900                 GO TO D404-EXIT.                                 @
148000     IF TR-AC4-FILING-STATUS IS EQUAL TO SPACES                   @
148100         NEXT SENTENCE                                            @
148200     ELSE                                                         @
148300         IF TR-AC4-VALID-FILING-STATUS                            @
148400             MOVE TR-AC4-FILING-STATUS TO                         @
148500                     PR-FILING-STATUS                             @
148600             ELSE                                                 @
148700                 MOVE 'INVALID FILING STATUS' TO                  @
148800                     ER-TRAN-ERROR-MSG                            @
148900                 PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT   @
149000                 GO TO D404-EXIT.                                 @
149100     IF TR-AC4-HEALTH-INSURANCE-X IS EQUAL TO SPACES              @
149200         NEXT SENTENCE                                            @
149300     ELSE                                                         @
149400         IF TR-AC4-HEALTH-INSURANCE-X IS NUMERIC                  @
149500             MOVE TR-AC4-HEALTH-INSURANCE-9 TO                    @
149600                     PR-HEALTH-INSURANCE                          @
149700             ELSE                                                 @
149800                 MOVE 'INVALID HEALTH-INSURANCE' TO               @
149900                     ER-TRAN-ERROR-MSG                            @
150000                 PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT   @
150100                 GO TO D404-EXIT.                                 @
150200     IF TR-AC4-DENTAL-INSURANCE-X IS EQUAL TO SPACES              @
150300         NEXT SENTENCE                                            @
150400     ELSE                                                         @
150500         IF TR-AC4-DENTAL-INSURANCE-X IS NUMERIC                  @
150600             MOVE TR-AC4-DENTAL-INSURANCE-9 TO                    @
150700                     PR-DENTAL-INSURANCE                          @
150800             ELSE                                                 @
150900                 MOVE 'INVALID DENTAL-INSURANCE' TO               @
151000                     ER-TRAN-ERROR-MSG                            @
151100                 PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT   @
151200                 GO TO D404-EXIT.                                 @
151300     IF TR-AC4-THRIFT-PLAN-PCT-X IS EQUAL TO SPACES               @
151400         NEXT SENTENCE                                            @
151500     ELSE                                                         @
151600         IF TR-AC4-THRIFT-PLAN-PCT-X IS NUMERIC                   @
151700             MOVE TR-AC4-THRIFT-PLAN-PCT-9 TO                     @
151800                     PR-THRIFT-PLAN-PERCENT                       @
151900             ELSE                                                 @
152000                 MOVE 'INVALID THRIFT-PLAN-PCT' TO                @
152100                     ER-TRAN-ERROR-MSG                            @
152200                 PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT   @
152300                 GO TO D404-EXIT.                                 @
152400     IF TR-AC4-HEALTH-CARE-FLEX-X IS EQUAL TO SPACES              @
152500         NEXT SENTENCE                                            @
152600     ELSE                                                         @
152700         IF TR-AC4-HEALTH-CARE-FLEX-X IS NUMERIC                  @
152800             MOVE TR-AC4-HEALTH-CARE-FLEX-9 TO                    @
152900                     PR-HEALTH-CARE-FLEX                          @
153000             ELSE                                                 @
153100                 MOVE 'INVALID HEALTH-CARE-FLEX' TO               @
153200                     ER-TRAN-ERROR-MSG                            @
153300                 PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT   @
153400                 GO TO D404-EXIT.                                 @
153500     IF TR-AC4-CHILD-CARE-FLEX-X IS EQUAL TO SPACES               @
153600         NEXT SENTENCE                                            @
153700     ELSE                                                         @
153800         IF TR-AC4-CHILD-CARE-FLEX-X IS NUMERIC                   @
153900             MOVE TR-AC4-CHILD-CARE-FLEX-9 TO                     @
154000                     PR-CHILD-CARE-FLEX                           @
154100             ELSE                                                 @
154200                 MOVE 'INVALID CHILD-CARE-FLEX' TO                @
154300                     ER-TRAN-ERROR-MSG                            @
154400                 PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT   @
154500                 GO TO D404-EXIT.                                 @
154600     MOVE 'N' TO WS-CHANGE-ERROR-INDICATOR.                       @
154700 D404-EXIT. EXIT.                                                 @
154800                                                                  @
154900 D405-PROCESS-C5.                                                 @
155000     IF TR-AC5-CREDIT-UNION-X IS EQUAL TO SPACES                  @
155100         NEXT SENTENCE                                            @
155200     ELSE                                                         @
155300         IF TR-AC5-CREDIT-UNION-X IS NUMERIC                      @
155400             MOVE TR-AC5-CREDIT-UNION-9 TO                        @
155500                 PR-CREDIT-UNION                                  @
155600         ELSE                                                     @
155700             MOVE 'INVALID CREDIT UNION AMOUNT' TO                @
155800                 ER-TRAN-ERROR-MSG                                @
155900             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
156000             GO TO D405-EXIT.                                     @
156100     IF TR-AC5-UGF-X IS EQUAL TO SPACES                           @
156200         NEXT SENTENCE                                            @
156300     ELSE                                                         @
156400         IF TR-AC5-UGF-X IS NUMERIC                               @
156500             MOVE TR-AC5-UGF-9 TO                                 @
156600                 PR-UGF                                           @
156700         ELSE                                                     @
156800             MOVE 'INVALID UGF' TO                                @
156900                 ER-TRAN-ERROR-MSG                                @
157000             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
157100             GO TO D405-EXIT.                                     @
157200     IF TR-AC5-CHILDREN-INSURANC-X IS EQUAL TO SPACES             @
157300         NEXT SENTENCE                                            @
157400     ELSE                                                         @
157500         IF TR-AC5-CHILDREN-INSURANC-X IS NUMERIC                 @
157600             MOVE TR-AC5-CHILDREN-INSURANC-9 TO                   @
157700                 PR-CHILDREN-INSURANCE                            @
157800         ELSE                                                     @
157900             MOVE 'INVALID CHILDREN-INSURANCE' TO                 @
158000                 ER-TRAN-ERROR-MSG                                @
158100             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
158200             GO TO D405-EXIT.                                     @
158300     IF TR-AC5-SPOUSE-INSURANCE-X IS EQUAL TO SPACES              @
158400         NEXT SENTENCE                                            @
158500     ELSE                                                         @
158600         IF TR-AC5-SPOUSE-INSURANCE-X IS NUMERIC                  @
158700             MOVE TR-AC5-SPOUSE-INSURANCE-9 TO                    @
158800                 PR-SPOUSE-INSURANCE                              @
158900         ELSE                                                     @
159000             MOVE 'INVALID SPOUSE-INSURANCE' TO                   @
159100                 ER-TRAN-ERROR-MSG                                @
159200             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
159300             GO TO D405-EXIT.                                     @
159400     IF TR-AC5-SUPPLEMENTAL-LIFE-X IS EQUAL TO SPACES             @
159500         NEXT SENTENCE                                            @
159600     ELSE                                                         @
159700         IF TR-AC5-SUPPLEMENTAL-LIFE-X IS NUMERIC                 @
159800             MOVE TR-AC5-SUPPLEMENTAL-LIFE-9 TO                   @
159900                 PR-SUPPLEMENTAL-LIFE                             @
160000         ELSE                                                     @
160100             MOVE 'INVALID SUPPLEMENTAL-LIFE' TO                  @
160200                 ER-TRAN-ERROR-MSG                                @
160300             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
160400             GO TO D405-EXIT.                                     @
160500     IF TR-AC5-LONG-TERM-DISBLTY-X IS EQUAL TO SPACES             @
160600         NEXT SENTENCE                                            @
160700     ELSE                                                         @
160800         IF TR-AC5-LONG-TERM-DISBLTY-X IS NUMERIC                 @
160900             MOVE TR-AC5-LONG-TERM-DISBLTY-9 TO                   @
161000                 PR-LONG-TERM-DISABILITY                          @
161100         ELSE                                                     @
161200             MOVE 'INVALID LONG-TERM-DISABILITY' TO               @
161300                 ER-TRAN-ERROR-MSG                                @
161400             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
161500             GO TO D405-EXIT.                                     @
161600     IF TR-AC5-EMPLOYEE-ASSOC-X IS EQUAL TO SPACES                @
161700         NEXT SENTENCE                                            @
161800     ELSE                                                         @
161900         IF TR-AC5-EMPLOYEE-ASSOC-X IS NUMERIC                    @
162000             MOVE TR-AC5-EMPLOYEE-ASSOC-9 TO                      @
162100                 PR-EMPLOYEE-ASSOCIATION                          @
162200         ELSE                                                     @
162300             MOVE 'INVALID EMPLOYEE-ASSOCIATION' TO               @
162400                 ER-TRAN-ERROR-MSG                                @
162500             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
162600             GO TO D405-EXIT.                                     @
162700     IF TR-AC5-TAX-IMPUTED-INC-X IS EQUAL TO SPACES               @
162800         NEXT SENTENCE                                            @
162900     ELSE                                                         @
163000         IF TR-AC5-TAX-IMPUTED-INC-X IS NUMERIC                   @
163100             MOVE TR-AC5-TAX-IMPUTED-INC-9 TO                     @
163200                 PR-TAXABLE-IMPUTED-INCOME                        @
163300         ELSE                                                     @
163400             MOVE 'INVALID TAXABLE-IMPUT' TO                      @
163500                 ER-TRAN-ERROR-MSG                                @
163600             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
163700             GO TO D405-EXIT.                                     @
163800     IF TR-AC5-NONEL-PTO-ALLOT-X IS EQUAL TO SPACES               @
163900         NEXT SENTENCE                                            @
164000     ELSE                                                         @
164100         IF TR-AC5-NONEL-PTO-ALLOT-X IS NUMERIC                   @
164200             MOVE TR-AC5-NONEL-PTO-ALLOT-9 TO                     @
164300                 PR-NONELECTIVE-PTO-ALLOTTED                      @
164400         ELSE                                                     @
164500             MOVE 'INVALID NONELECTIVE-PTO-ALLOTTED' TO           @
164600                 ER-TRAN-ERROR-MSG                                @
164700             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
164800             GO TO D405-EXIT.                                     @
164900     IF TR-AC5-EL-PTO-ALLOT-X IS EQUAL TO SPACES                  @
165000         NEXT SENTENCE                                            @
165100     ELSE                                                         @
165200         IF TR-AC5-EL-PTO-ALLOT-X IS NUMERIC                      @
165300             MOVE TR-AC5-EL-PTO-ALLOT-9 TO                        @
165400                 PR-ELECTIVE-PTO-ALLOTTED                         @
165500         ELSE                                                     @
165600             MOVE 'INVALID ELECTIVE-PTO-ALLOTTED' TO              @
165700                 ER-TRAN-ERROR-MSG                                @
165800             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
165900             GO TO D405-EXIT.                                     @
166000     MOVE 'N' TO WS-CHANGE-ERROR-INDICATOR.                       @
166100 D405-EXIT. EXIT.                                                 @
166200                                                                  @
166300 D406-PROCESS-C6.                                                 @
166400     IF TR-CHG6-NONEL-PTO-CARRY-X IS EQUAL TO SPACES              @
166500         NEXT SENTENCE                                            @
166600     ELSE                                                         @
166700         IF TR-CHG6-NONEL-PTO-CARRY-X IS NUMERIC                  @
166800             MOVE TR-CHG6-NONEL-PTO-CARRY-9     TO                @
166900                 PR-NONELECTIVE-PTO-CARRYOVER                     @
167000         ELSE                                                     @
167100             MOVE 'INVALID NONELECTIVE PTO CARRYOVER' TO          @
167200                 ER-TRAN-ERROR-MSG                                @
167300             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
167400             GO TO D406-EXIT.                                     @
167500     IF TR-CHG6-NONEL-PTO-TAKEN-X IS EQUAL TO SPACES              @
167600         NEXT SENTENCE                                            @
167700     ELSE                                                         @
167800         IF TR-CHG6-NONEL-PTO-TAKEN-X IS NUMERIC                  @
167900             MOVE TR-CHG6-NONEL-PTO-TAKEN-9     TO                @
168000                 PR-NONELECTIVE-PTO-TAKEN                         @
168100         ELSE                                                     @
168200             MOVE 'INVALID NONELECTIVE PTO TAKEN' TO              @
168300                 ER-TRAN-ERROR-MSG                                @
168400             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
168500             GO TO D406-EXIT.                                     @
168600     IF TR-CHG6-ELECT-PTO-BOUGHT-X IS EQUAL TO SPACES             @
168700         NEXT SENTENCE                                            @
168800     ELSE                                                         @
168900         IF TR-CHG6-ELECT-PTO-BOUGHT-X IS NUMERIC                 @
169000             MOVE TR-CHG6-ELECT-PTO-BOUGHT-9 TO                   @
169100                 PR-ELECTIVE-PTO-BOUGHT                           @
169200         ELSE                                                     @
169300             MOVE 'INVALID ELECTIVE PTO BOUGHT' TO                @
169400                 ER-TRAN-ERROR-MSG                                @
169500             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
169600             GO TO D406-EXIT.                                     @
169700     IF TR-CHG6-ELECT-PTO-SOLD-X IS EQUAL TO SPACES               @
169800         NEXT SENTENCE                                            @
169900     ELSE                                                         @
170000         IF TR-CHG6-ELECT-PTO-SOLD-X IS NUMERIC                   @
170100             MOVE TR-CHG6-ELECT-PTO-SOLD-9 TO                     @
170200                 PR-ELECTIVE-PTO-SOLD                             @
170300         ELSE                                                     @
170400             MOVE 'INVALID ELECTIVE-PTO-SOL' TO                   @
170500                 ER-TRAN-ERROR-MSG                                @
170600             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
170700             GO TO D406-EXIT.                                     @
170800     IF TR-CHG6-ELECT-PTO-TAKEN-X IS EQUAL TO SPACES              @
170900         NEXT SENTENCE                                            @
171000     ELSE                                                         @
171100         IF TR-CHG6-ELECT-PTO-TAKEN-X IS NUMERIC                  @
171200             MOVE TR-CHG6-ELECT-PTO-TAKEN-9 TO                    @
171300                 PR-ELECTIVE-PTO-TAKEN                            @
171400         ELSE                                                     @
171500             MOVE 'INVALID ELECTIVE-PTO-TAKEN' TO                 @
171600                 ER-TRAN-ERROR-MSG                                @
171700             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
171800             GO TO D406-EXIT.                                     @
171900     IF TR-CHG6-CUR-REGULAR-EARN-X IS EQUAL TO SPACES             @
172000         NEXT SENTENCE                                            @
172100     ELSE                                                         @
172200         IF TR-CHG6-CUR-REGULAR-EARN-X IS NUMERIC                 @
172300             MOVE TR-CHG6-CUR-REGULAR-EARN-9 TO                   @
172400                 PR-CUR-REGULAR-EARNINGS                          @
172500         ELSE                                                     @
172600             MOVE 'INVALID CUR-REGULAR-EARNINGS' TO               @
172700                 ER-TRAN-ERROR-MSG                                @
172800             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
172900             GO TO D406-EXIT.                                     @
173000     IF TR-CHG6-CUR-HOLIDAY-EARN-X IS EQUAL TO SPACES             @
173100         NEXT SENTENCE                                            @
173200     ELSE                                                         @
173300         IF TR-CHG6-CUR-HOLIDAY-EARN-X IS NUMERIC                 @
173400             MOVE TR-CHG6-CUR-HOLIDAY-EARN-9 TO                   @
173500                 PR-CUR-HOLIDAY-EARNINGS                          @
173600         ELSE                                                     @
173700             MOVE 'INVALID CUR-HOLIDAY-EARNINGS' TO               @
173800                 ER-TRAN-ERROR-MSG                                @
173900             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
174000             GO TO D406-EXIT.                                     @
174100     IF TR-CHG6-CUR-PTO-EARNINGS-X IS EQUAL TO SPACES             @
174200         NEXT SENTENCE                                            @
174300     ELSE                                                         @
174400         IF TR-CHG6-CUR-PTO-EARNINGS-X IS NUMERIC                 @
174500             MOVE TR-CHG6-CUR-PTO-EARNINGS-9 TO                   @
174600                 PR-CUR-PTO-EARNINGS                              @
174700         ELSE                                                     @
174800             MOVE 'INVALID CUR-PTO-EARNINGS' TO                   @
174900                 ER-TRAN-ERROR-MSG                                @
175000             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
175100             GO TO D406-EXIT.                                     @
175200     IF TR-CHG6-CUR-FLEX-DOLLARS-X IS EQUAL TO SPACES             @
175300         NEXT SENTENCE                                            @
175400     ELSE                                                         @
175500         IF TR-CHG6-CUR-FLEX-DOLLARS-X IS NUMERIC                 @
175600             MOVE TR-CHG6-CUR-FLEX-DOLLARS-9 TO                   @
175700                 PR-CUR-FLEX-DOLLARS                              @
175800         ELSE                                                     @
175900             MOVE 'INVALID CUR-FLEX-DOLLARS' TO                   @
176000                 ER-TRAN-ERROR-MSG                                @
176100             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
176200             GO TO D406-EXIT.                                     @
176300     IF TR-CHG6-CUR-HEALTHY-RTRN-X IS EQUAL TO SPACES             @
176400         NEXT SENTENCE                                            @
176500     ELSE                                                         @
176600         IF TR-CHG6-CUR-HEALTHY-RTRN-X IS NUMERIC                 @
176700             MOVE TR-CHG6-CUR-HEALTHY-RTRN-9 TO                   @
176800                 PR-CUR-HEALTHY-RETURNS                           @
176900         ELSE                                                     @
177000             MOVE 'INVALID CUR-HEALTHY-RETURNS' TO                @
177100                 ER-TRAN-ERROR-MSG                                @
177200             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
177300             GO TO D406-EXIT.                                     @
177400     MOVE 'N' TO WS-CHANGE-ERROR-INDICATOR.                       @
177500 D406-EXIT. EXIT.                                                 @
177600                                                                  @
177700 D407-PROCESS-C7.                                                 @
177800     IF TR-CHG7-CUR-MEDICAL-WAIV-X IS EQUAL TO SPACES             @
177900         NEXT SENTENCE                                            @
178000     ELSE                                                         @
178100         IF TR-CHG7-CUR-MEDICAL-WAIV-X IS NUMERIC                 @
178200             MOVE TR-CHG7-CUR-MEDICAL-WAIV-9 TO                   @
178300                 PR-CUR-MEDICAL-WAIVED                            @
178400         ELSE                                                     @
178500             MOVE 'INVALID CURRENT MEDICAL WAIVED' TO             @
178600                 ER-TRAN-ERROR-MSG                                @
178700             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
178800             GO TO D407-EXIT.                                     @
178900     IF TR-CHG7-CUR-MEDICAL-WAIV-X IS EQUAL TO SPACES             @
179000         NEXT SENTENCE                                            @
179100     ELSE                                                         @
179200         IF TR-CHG7-CUR-MEDICAL-WAIV-X IS NUMERIC                 @
179300             MOVE TR-CHG7-CUR-MEDICAL-WAIV-9 TO                   @
179400                 PR-CUR-MEDICAL-WAIVED                            @
179500         ELSE                                                     @
179600             MOVE 'INVALID CUR-MEDICAL-WAIVED' TO                 @
179700                 ER-TRAN-ERROR-MSG                                @
179800             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
179900             GO TO D407-EXIT.                                     @
180000     IF TR-CHG7-CUR-BONUS-X IS EQUAL TO SPACES                    @
180100         NEXT SENTENCE                                            @
180200     ELSE                                                         @
180300         IF TR-CHG7-CUR-BONUS-X IS NUMERIC                        @
180400             MOVE TR-CHG7-CUR-BONUS-9 TO                          @
180500                 PR-CUR-BONUS                                     @
180600         ELSE                                                     @
180700             MOVE 'INVALID CUR-BONUS' TO                          @
180800                 ER-TRAN-ERROR-MSG                                @
180900             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
181000             GO TO D407-EXIT.                                     @
181100     IF TR-CHG7-CUR-UGF-BONUS-X IS EQUAL TO SPACES                @
181200         NEXT SENTENCE                                            @
181300     ELSE                                                         @
181400         IF TR-CHG7-CUR-UGF-BONUS-X IS NUMERIC                    @
181500             MOVE TR-CHG7-CUR-UGF-BONUS-9 TO                      @
181600                 PR-CUR-UGF-BONUS                                 @
181700         ELSE                                                     @
181800             MOVE 'INVALID CUR-UGF-BONUS' TO                      @
181900                 ER-TRAN-ERROR-MSG                                @
182000             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
182100             GO TO D407-EXIT.                                     @
182200     IF TR-CHG7-CUR-FLOAT-HOL-X IS EQUAL TO SPACES                @
182300         NEXT SENTENCE                                            @
182400     ELSE                                                         @
182500         IF TR-CHG7-CUR-FLOAT-HOL-X IS NUMERIC                    @
182600             MOVE TR-CHG7-CUR-FLOAT-HOL-9 TO                      @
182700                 PR-CUR-FLOATING-HOLIDAY                          @
182800         ELSE                                                     @
182900             MOVE 'INVALID CUR-FLOATING-HOLIDAY' TO               @
183000                 ER-TRAN-ERROR-MSG                                @
183100             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
183200             GO TO D407-EXIT.                                     @
183300     IF TR-CHG7-YTD-REG-EARN-X IS EQUAL TO SPACES                 @
183400         NEXT SENTENCE                                            @
183500     ELSE                                                         @
183600         IF TR-CHG7-YTD-REG-EARN-X IS NUMERIC                     @
183700             MOVE TR-CHG7-YTD-REG-EARN-9 TO                       @
183800                 PR-YTD-REGULAR-EARNINGS                          @
183900         ELSE                                                     @
184000             MOVE 'INVALID YTD-REGULAR-EARNINGS' TO               @
184100                 ER-TRAN-ERROR-MSG                                @
184200             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
184300             GO TO D407-EXIT.                                     @
184400     IF TR-CHG7-YTD-HOL-EARN-X IS EQUAL TO SPACES                 @
184500         NEXT SENTENCE                                            @
184600     ELSE                                                         @
184700         IF TR-CHG7-YTD-HOL-EARN-X IS NUMERIC                     @
184800             MOVE TR-CHG7-YTD-HOL-EARN-9 TO                       @
184900                 PR-YTD-HOLIDAY-EARNINGS                          @
185000         ELSE                                                     @
185100             MOVE 'INVALID YTD-HOLIDAY-EARNINGS' TO               @
185200                 ER-TRAN-ERROR-MSG                                @
185300             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
185400             GO TO D407-EXIT.                                     @
185500     IF TR-CHG7-YTD-PTO-EARNINGS-X IS EQUAL TO SPACES             @
185600         NEXT SENTENCE                                            @
185700     ELSE                                                         @
185800         IF TR-CHG7-YTD-PTO-EARNINGS-X IS NUMERIC                 @
185900             MOVE TR-CHG7-YTD-PTO-EARNINGS-9 TO                   @
186000                 PR-YTD-PTO-EARNINGS                              @
186100         ELSE                                                     @
186200             MOVE 'INVALID YTD-PTO-EARNINGS' TO                   @
186300                 ER-TRAN-ERROR-MSG                                @
186400             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
186500             GO TO D407-EXIT.                                     @
186600     IF TR-CHG7-YTD-FLEX-DOLLARS-X IS EQUAL TO SPACES             @
186700         NEXT SENTENCE                                            @
186800     ELSE                                                         @
186900         IF TR-CHG7-YTD-FLEX-DOLLARS-X IS NUMERIC                 @
187000             MOVE TR-CHG7-YTD-FLEX-DOLLARS-9 TO                   @
187100                 PR-YTD-FLEX-DOLLARS                              @
187200         ELSE                                                     @
187300             MOVE 'INVALID YTD-FLEX-DOLLARS' TO                   @
187400                 ER-TRAN-ERROR-MSG                                @
187500             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
187600             GO TO D407-EXIT.                                     @
187700     MOVE 'N' TO WS-CHANGE-ERROR-INDICATOR.                       @
187800 D407-EXIT. EXIT.                                                 @
187900                                                                  @
188000 D408-PROCESS-C8.                                                 @
188100     IF TR-CHG8-YTD-HEALTHY-RETRN-X IS EQUAL TO SPACES            @
188200         NEXT SENTENCE                                            @
188300     ELSE                                                         @
188400         IF TR-CHG8-YTD-HEALTHY-RETRN-X IS NUMERIC                @
188500             MOVE TR-CHG8-YTD-HEALTHY-RETRN-9 TO                  @
188600                 PR-YTD-HEALTHY-RETURNS                           @
188700         ELSE                                                     @
188800             MOVE 'INVALID YTD-HEALTHY-RETURNS' TO                @
188900                 ER-TRAN-ERROR-MSG                                @
189000             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
189100             GO TO D408-EXIT.                                     @
189200     IF TR-CHG8-YTD-MEDICAL-WAIV-X IS EQUAL TO SPACES             @
189300         NEXT SENTENCE                                            @
189400     ELSE                                                         @
189500         IF TR-CHG8-YTD-MEDICAL-WAIV-X IS NUMERIC                 @
189600             MOVE TR-CHG8-YTD-MEDICAL-WAIV-9 TO                   @
189700                 PR-YTD-MEDICAL-WAIVED                            @
189800         ELSE                                                     @
189900             MOVE 'INVALID YTD-MEDICAL-WAIVED' TO                 @
190000                 ER-TRAN-ERROR-MSG                                @
190100             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
190200             GO TO D408-EXIT.                                     @
190300     IF TR-CHG8-YTD-BONUS-X IS EQUAL TO SPACES                    @
190400         NEXT SENTENCE                                            @
190500     ELSE                                                         @
190600         IF TR-CHG8-YTD-BONUS-X IS NUMERIC                        @
190700             MOVE TR-CHG8-YTD-BONUS-9 TO                          @
190800                 PR-YTD-BONUS                                     @
190900         ELSE                                                     @
191000             MOVE 'INVALID YTD-BONUS' TO                          @
191100                 ER-TRAN-ERROR-MSG                                @
191200             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
191300             GO TO D408-EXIT.                                     @
191400     IF TR-CHG8-YTD-UGF-BONUS-X IS EQUAL TO SPACES                @
191500         NEXT SENTENCE                                            @
191600     ELSE                                                         @
191700         IF TR-CHG8-YTD-UGF-BONUS-X IS NUMERIC                    @
191800             MOVE TR-CHG8-YTD-UGF-BONUS-9 TO                      @
191900                 PR-YTD-UGF-BONUS                                 @
192000         ELSE                                                     @
192100             MOVE 'INVALID YTD-UGF-BONUS' TO                      @
192200                 ER-TRAN-ERROR-MSG                                @
192300             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
192400             GO TO D408-EXIT.                                     @
192500     IF TR-CHG8-YTD-FLOAT-HOL-X IS EQUAL TO SPACES                @
192600         NEXT SENTENCE                                            @
192700     ELSE                                                         @
192800         IF TR-CHG8-YTD-FLOAT-HOL-X IS NUMERIC                    @
192900             MOVE TR-CHG8-YTD-FLOAT-HOL-9 TO                      @
193000                 PR-YTD-FLOATING-HOLIDAY                          @
193100         ELSE                                                     @
193200             MOVE 'INVALID YTD-FLOATING-HOLIDAY' TO               @
193300                 ER-TRAN-ERROR-MSG                                @
193400             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
193500             GO TO D408-EXIT.                                     @
193600     IF TR-CHG8-CUR-FED-TAX-X IS EQUAL TO SPACES                  @
193700         NEXT SENTENCE                                            @
193800     ELSE                                                         @
193900         IF TR-CHG8-CUR-FED-TAX-X IS NUMERIC                      @
194000             MOVE TR-CHG8-CUR-FED-TAX-9 TO                        @
194100                 PR-CUR-FED-TAX                                   @
194200         ELSE                                                     @
194300             MOVE 'INVALID CUR-FED-TAX' TO                        @
194400                 ER-TRAN-ERROR-MSG                                @
194500             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
194600             GO TO D408-EXIT.                                     @
194700     IF TR-CHG8-CUR-FICA-MHI-X IS EQUAL TO SPACES                 @
194800         NEXT SENTENCE                                            @
194900     ELSE                                                         @
195000         IF TR-CHG8-CUR-FICA-MHI-X IS NUMERIC                     @
195100             MOVE TR-CHG8-CUR-FICA-MHI-9 TO                       @
195200                 PR-CUR-FICA-MHI                                  @
195300         ELSE                                                     @
195400             MOVE 'INVALID CUR-FICA-MHI' TO                       @
195500                 ER-TRAN-ERROR-MSG                                @
195600             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
195700             GO TO D408-EXIT.                                     @
195800     IF TR-CHG8-CUR-OASDI-X IS EQUAL TO SPACES                    @
195900         NEXT SENTENCE                                            @
196000     ELSE                                                         @
196100         IF TR-CHG8-CUR-OASDI-X IS NUMERIC                        @
196200             MOVE TR-CHG8-CUR-OASDI-9 TO                          @
196300                 PR-CUR-OASDI                                     @
196400         ELSE                                                     @
196500             MOVE 'INVALID CUR-OASDI' TO                          @
196600                 ER-TRAN-ERROR-MSG                                @
196700             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
196800             GO TO D408-EXIT.                                     @
196900     MOVE 'N' TO WS-CHANGE-ERROR-INDICATOR.                       @
197000 D408-EXIT. EXIT.                                                 @
197100                                                                  @
197200 D409-PROCESS-C9.                                                 @
197300     IF TR-CHG9-CUR-STATE-TAX-X IS EQUAL TO SPACES                @
197400         NEXT SENTENCE                                            @
197500     ELSE                                                         @
197600         IF TR-CHG9-CUR-STATE-TAX-X IS NUMERIC                    @
197700             MOVE TR-CHG9-CUR-STATE-TAX-9 TO                      @
197800                 PR-CUR-STATE-TAX                                 @
197900         ELSE                                                     @
198000             MOVE 'INVALID CUR-STATE-TAX' TO                      @
198100                 ER-TRAN-ERROR-MSG                                @
198200             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
198300             GO TO D409-EXIT.                                     @
198400     IF TR-CHG9-YTD-FED-TAX-X IS EQUAL TO SPACES                  @
198500         NEXT SENTENCE                                            @
198600     ELSE                                                         @
198700         IF TR-CHG9-YTD-FED-TAX-X IS NUMERIC                      @
198800             MOVE TR-CHG9-YTD-FED-TAX-9 TO                        @
198900                 PR-YTD-FED-TAX                                   @
199000         ELSE                                                     @
199100             MOVE 'INVALID YTD-FED-TAX' TO                        @
199200                 ER-TRAN-ERROR-MSG                                @
199300             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
199400             GO TO D409-EXIT.                                     @
199500     IF TR-CHG9-YTD-FICA-MHI-X IS EQUAL TO SPACES                 @
199600         NEXT SENTENCE                                            @
199700     ELSE                                                         @
199800         IF TR-CHG9-YTD-FICA-MHI-X IS NUMERIC                     @
199900             MOVE TR-CHG9-YTD-FICA-MHI-9 TO                       @
200000                 PR-YTD-FICA-MHI                                  @
200100         ELSE                                                     @
200200             MOVE 'INVALID YTD-FICA-MHI' TO                       @
200300                 ER-TRAN-ERROR-MSG                                @
200400             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
200500             GO TO D409-EXIT.                                     @
200600     IF TR-CHG9-YTD-OASDI-X IS EQUAL TO SPACES                    @
200700         NEXT SENTENCE                                            @
200800     ELSE                                                         @
200900         IF TR-CHG9-YTD-OASDI-X IS NUMERIC                        @
201000             MOVE TR-CHG9-YTD-OASDI-9 TO                          @
201100                 PR-YTD-OASDI                                     @
201200         ELSE                                                     @
201300             MOVE 'INVALID YTD-OASDI' TO                          @
201400                 ER-TRAN-ERROR-MSG                                @
201500             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
201600             GO TO D409-EXIT.                                     @
201700     IF TR-CHG9-YTD-STATE-TAX-X IS EQUAL TO SPACES                @
201800         NEXT SENTENCE                                            @
201900     ELSE                                                         @
202000         IF TR-CHG9-YTD-STATE-TAX-X IS NUMERIC                    @
202100             MOVE TR-CHG9-YTD-STATE-TAX-9 TO                      @
202200                 PR-YTD-STATE-TAX                                 @
202300         ELSE                                                     @
202400             MOVE 'INVALID YTD-STATE-TAX' TO                      @
202500                 ER-TRAN-ERROR-MSG                                @
202600             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
202700             GO TO D409-EXIT.                                     @
202800     IF TR-CHG9-CUR-THRIFT-PLAN-X IS EQUAL TO SPACES              @
202900         NEXT SENTENCE                                            @
203000     ELSE                                                         @
203100         IF TR-CHG9-CUR-THRIFT-PLAN-X IS NUMERIC                  @
203200             MOVE TR-CHG9-CUR-THRIFT-PLAN-9 TO                    @
203300                 PR-CUR-THRIFT-PLAN                               @
203400         ELSE                                                     @
203500             MOVE 'INVALID CUR-THRIFT-PLAN' TO                    @
203600                 ER-TRAN-ERROR-MSG                                @
203700             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
203800             GO TO D409-EXIT.                                     @
203900     IF TR-CHG9-CUR-MED-INS-X IS EQUAL TO SPACES                  @
204000         NEXT SENTENCE                                            @
204100     ELSE                                                         @
204200         IF TR-CHG9-CUR-MED-INS-X IS NUMERIC                      @
204300             MOVE TR-CHG9-CUR-MED-INS-9 TO                        @
204400                 PR-CUR-MEDICAL-INSURANCE                         @
204500         ELSE                                                     @
204600             MOVE 'INVALID CUR-MEDICAL-INSURANCE' TO              @
204700                 ER-TRAN-ERROR-MSG                                @
204800             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
204900             GO TO D409-EXIT.                                     @
205000     IF TR-CHG9-CUR-DENTAL-INS-X IS EQUAL TO SPACES               @
205100         NEXT SENTENCE                                            @
205200     ELSE                                                         @
205300         IF TR-CHG9-CUR-DENTAL-INS-X IS NUMERIC                   @
205400             MOVE TR-CHG9-CUR-DENTAL-INS-9 TO                     @
205500                 PR-CUR-DENTAL-INSURANCE                          @
205600         ELSE                                                     @
205700             MOVE 'INVALID CUR-DENTAL-INSURANCE' TO               @
205800                 ER-TRAN-ERROR-MSG                                @
205900             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
206000             GO TO D409-EXIT.                                     @
206100     MOVE 'N' TO WS-CHANGE-ERROR-INDICATOR.                       @
206200 D409-EXIT. EXIT.                                                 @
206300                                                                  @
206400 D40A-PROCESS-CA.                                                 @
206500     IF TR-CHGA-CUR-HLTHCARE-FLX-X IS EQUAL TO SPACES             @
206600         NEXT SENTENCE                                            @
206700     ELSE                                                         @
206800         IF TR-CHGA-CUR-HLTHCARE-FLX-X IS NUMERIC                 @
206900             MOVE TR-CHGA-CUR-HLTHCARE-FLX-9 TO                   @
207000                 PR-CUR-HEALTH-CARE-FLEX                          @
207100         ELSE                                                     @
207200             MOVE 'INVALID CUR-HEALTH-CARE-FLEX' TO               @
207300                 ER-TRAN-ERROR-MSG                                @
207400             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
207500             GO TO D40A-EXIT.                                     @
207600     IF TR-CHGA-CUR-CHILCARE-FLX-X IS EQUAL TO SPACES             @
207610         NEXT SENTENCE                                            @
207620     ELSE                                                         @
207630         IF TR-CHGA-CUR-CHILCARE-FLX-X IS NUMERIC                 @
207640             MOVE TR-CHGA-CUR-CHILCARE-FLX-9 TO                   @
207650                 PR-CUR-CHILD-CARE-FLEX                           @
207660         ELSE                                                     @
207670             MOVE 'INVALID CUR-CHILD-CARE-FLEX' TO                @
207680                 ER-TRAN-ERROR-MSG                                @
207690             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
207691             GO TO D40A-EXIT.                                     @
207693     IF TR-CHGA-YTD-THRIFT-PLAN-X IS EQUAL TO SPACES              @
207694         NEXT SENTENCE                                            @
207695     ELSE                                                         @
207696         IF TR-CHGA-YTD-THRIFT-PLAN-X IS NUMERIC                  @
207697             MOVE TR-CHGA-YTD-THRIFT-PLAN-9 TO                    @
207698                 PR-YTD-THRIFT-PLAN                               @
207699         ELSE                                                     @
207700             MOVE 'INVALID YTD-THRIFT-PLAN' TO                    @
207701                 ER-TRAN-ERROR-MSG                                @
207710             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
207720             GO TO D40A-EXIT.                                     @
207730     IF TR-CHGA-YTD-MEDICAL-INS-X IS EQUAL TO SPACES              @
207740         NEXT SENTENCE                                            @
207750     ELSE                                                         @
207760         IF TR-CHGA-YTD-MEDICAL-INS-X IS NUMERIC                  @
207770             MOVE TR-CHGA-YTD-MEDICAL-INS-9 TO                    @
207780                 PR-YTD-MEDICAL-INSURANCE                         @
207790         ELSE                                                     @
207800             MOVE 'INVALID YTD-MEDICAL-INSURANCE' TO              @
207810                 ER-TRAN-ERROR-MSG                                @
207820             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
207830             GO TO D40A-EXIT.                                     @
207840     IF TR-CHGA-YTD-DENTAL-INS-X IS EQUAL TO SPACES               @
207850         NEXT SENTENCE                                            @
207860     ELSE                                                         @
207870         IF TR-CHGA-YTD-DENTAL-INS-X IS NUMERIC                   @
207880             MOVE TR-CHGA-YTD-DENTAL-INS-9 TO                     @
207890                 PR-YTD-DENTAL-INSURANCE                          @
207900         ELSE                                                     @
207910             MOVE 'INVALID YTD-DENTAL-INSURANCE' TO               @
207920                 ER-TRAN-ERROR-MSG                                @
207930             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
207940             GO TO D40A-EXIT.                                     @
207950     IF TR-CHGA-YTD-HLTHCARE-FLX-X IS EQUAL TO SPACES             @
207960         NEXT SENTENCE                                            @
207970     ELSE                                                         @
207980         IF TR-CHGA-YTD-HLTHCARE-FLX-X IS NUMERIC                 @
207990             MOVE TR-CHGA-YTD-HLTHCARE-FLX-9 TO                   @
208000                 PR-YTD-HEALTH-CARE-FLEX                          @
208010         ELSE                                                     @
208020             MOVE 'INVALID YTD-HEALTH-CARE-FLEX' TO               @
208030                 ER-TRAN-ERROR-MSG                                @
208040             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
208050             GO TO D40A-EXIT.                                     @
208060     IF TR-CHGA-YTD-CHILCARE-FLX-X IS EQUAL TO SPACES             @
208070         NEXT SENTENCE                                            @
208080     ELSE                                                         @
208090         IF TR-CHGA-YTD-CHILCARE-FLX-X IS NUMERIC                 @
208100             MOVE TR-CHGA-YTD-CHILCARE-FLX-9 TO                   @
208110                 PR-YTD-CHILD-CARE-FLEX                           @
208120         ELSE                                                     @
208130             MOVE 'INVALID YTD-CHILD-CARE-FLEX' TO                @
208140                 ER-TRAN-ERROR-MSG                                @
208150             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
208160             GO TO D40A-EXIT.                                     @
208170     IF TR-CHGA-CUR-CREDIT-UNION-X IS EQUAL TO SPACES             @
208180         NEXT SENTENCE                                            @
208190     ELSE                                                         @
208200         IF TR-CHGA-CUR-CREDIT-UNION-X IS NUMERIC                 @
208210             MOVE TR-CHGA-CUR-CREDIT-UNION-9 TO                   @
208220                 PR-CUR-CREDIT-UNION                              @
208230         ELSE                                                     @
208240             MOVE 'INVALID CUR-CREDIT-UNION' TO                   @
208250                 ER-TRAN-ERROR-MSG                                @
208260             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
208270             GO TO D40A-EXIT.                                     @
208400     MOVE 'N' TO WS-CHANGE-ERROR-INDICATOR.                       @
208500 D40A-EXIT. EXIT.                                                 @
208600                                                                  @
208700 D40B-PROCESS-CB.                                                 @
208800     IF TR-CHGB-CUR-UGF-X IS EQUAL TO SPACES                      @
208900         NEXT SENTENCE                                            @
209000     ELSE                                                         @
209100         IF TR-CHGB-CUR-UGF-X IS NUMERIC                          @
209200             MOVE TR-CHGB-CUR-UGF-9 TO                            @
209300                 PR-CUR-UGF                                       @
209400         ELSE                                                     @
209500             MOVE 'INVALID CUR-UGF' TO                            @
209600                 ER-TRAN-ERROR-MSG                                @
209700             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
209800             GO TO D40B-EXIT.                                     @
209900     IF TR-CHGB-CUR-CHILDREN-INS-X IS EQUAL TO SPACES             @
209910         NEXT SENTENCE                                            @
209920     ELSE                                                         @
209930         IF TR-CHGB-CUR-CHILDREN-INS-X IS NUMERIC                 @
209940             MOVE TR-CHGB-CUR-CHILDREN-INS-9 TO                   @
209950                 PR-CUR-CHILDREN-INSURANCE                        @
209960         ELSE                                                     @
209970             MOVE 'INVALID CUR-CHILDREN-INSURANCE' TO             @
209980                 ER-TRAN-ERROR-MSG                                @
209990             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
209991             GO TO D40B-EXIT.                                     @
209993     IF TR-CHGB-CUR-SPOUSE-INS-X IS EQUAL TO SPACES               @
209994         NEXT SENTENCE                                            @
209995     ELSE                                                         @
209996         IF TR-CHGB-CUR-SPOUSE-INS-X IS NUMERIC                   @
209997             MOVE TR-CHGB-CUR-SPOUSE-INS-9 TO                     @
209998                 PR-CUR-SPOUSE-INSURANCE                          @
209999         ELSE                                                     @
210000             MOVE 'INVALID CUR-SPOUSE-INSURANCE' TO               @
210001                 ER-TRAN-ERROR-MSG                                @
210010             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
210020             GO TO D40B-EXIT.                                     @
210030     IF TR-CHGB-CUR-LTD-INS-X IS EQUAL TO SPACES                  @
210040         NEXT SENTENCE                                            @
210050     ELSE                                                         @
210060         IF TR-CHGB-CUR-LTD-INS-X IS NUMERIC                      @
210070             MOVE TR-CHGB-CUR-LTD-INS-9 TO                        @
210080                 PR-CUR-LTD-INSURANCE                             @
210090         ELSE                                                     @
210100             MOVE 'INVALID CUR-LTD-INSURANCE' TO                  @
210110                 ER-TRAN-ERROR-MSG                                @
210120             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
210130             GO TO D40B-EXIT.                                     @
210140     IF TR-CHGB-CUR-EMPL-ASSOC-X IS EQUAL TO SPACES               @
210150         NEXT SENTENCE                                            @
210160     ELSE                                                         @
210170         IF TR-CHGB-CUR-EMPL-ASSOC-X IS NUMERIC                   @
210180             MOVE TR-CHGB-CUR-EMPL-ASSOC-9 TO                     @
210190                 PR-CUR-EMPLOYEE-ASSOC                            @
210200         ELSE                                                     @
210210             MOVE 'INVALID CUR-EMPLOYEE-ASSOC' TO                 @
210220                 ER-TRAN-ERROR-MSG                                @
210230             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
210240             GO TO D40B-EXIT.                                     @
210250     IF TR-CHGB-YTD-CREDIT-UNION-X IS EQUAL TO SPACES             @
210260         NEXT SENTENCE                                            @
210270     ELSE                                                         @
210280         IF TR-CHGB-YTD-CREDIT-UNION-X IS NUMERIC                 @
210290             MOVE TR-CHGB-YTD-CREDIT-UNION-9 TO                   @
210300                 PR-YTD-CREDIT-UNION                              @
210310         ELSE                                                     @
210320             MOVE 'INVALID YTD-CREDIT-UNION' TO                   @
210330                 ER-TRAN-ERROR-MSG                                @
210340             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
210350             GO TO D40B-EXIT.                                     @
210360     IF TR-CHGB-YTD-UGF-X IS EQUAL TO SPACES                      @
210370         NEXT SENTENCE                                            @
210380     ELSE                                                         @
210390         IF TR-CHGB-YTD-UGF-X IS NUMERIC                          @
210400             MOVE TR-CHGB-YTD-UGF-9 TO                            @
210410                 PR-YTD-UGF                                       @
210420         ELSE                                                     @
210430             MOVE 'INVALID YTD-UGF' TO                            @
210440                 ER-TRAN-ERROR-MSG                                @
210450             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
210460             GO TO D40B-EXIT.                                     @
210470     IF TR-CHGB-YTD-CHILDREN-INS-X IS EQUAL TO SPACES             @
210480         NEXT SENTENCE                                            @
210490     ELSE                                                         @
210500         IF TR-CHGB-YTD-CHILDREN-INS-X IS NUMERIC                 @
210510             MOVE TR-CHGB-YTD-CHILDREN-INS-9 TO                   @
210520                 PR-YTD-CHILDREN-INSURANCE                        @
210530         ELSE                                                     @
210540             MOVE 'INVALID YTD-CHILDREN-INSURANCE' TO             @
210550                 ER-TRAN-ERROR-MSG                                @
210560             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
210570             GO TO D40B-EXIT.                                     @
210700     MOVE 'N' TO WS-CHANGE-ERROR-INDICATOR.                       @
210800 D40B-EXIT. EXIT.                                                 @
210900                                                                  @
211000 D40C-PROCESS-CC.                                                 @
211100     IF TR-CHGC-YTD-SPOUSE-INS-X IS EQUAL TO SPACES               @
211200         NEXT SENTENCE                                            @
211300     ELSE                                                         @
211400         IF TR-CHGC-YTD-SPOUSE-INS-X IS NUMERIC                   @
211500             MOVE TR-CHGC-YTD-SPOUSE-INS-9 TO                     @
211600                 PR-YTD-SPOUSE-INSURANCE                          @
211700         ELSE                                                     @
211800             MOVE 'INVALID YTD-SPOUSE-INSURANCE' TO               @
211900                 ER-TRAN-ERROR-MSG                                @
212000             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
212100             GO TO D40C-EXIT.                                     @
212200     IF TR-CHGC-YTD-LTD-INSUR-X IS EQUAL TO SPACES                @
212210         NEXT SENTENCE                                            @
212220     ELSE                                                         @
212230         IF TR-CHGC-YTD-LTD-INSUR-X IS NUMERIC                    @
212240             MOVE TR-CHGC-YTD-LTD-INSUR-9 TO                      @
212250                 PR-YTD-LTD-INSURANCE                             @
212260         ELSE                                                     @
212270             MOVE 'INVALID YTD-LTD-INSURANCE' TO                  @
212280                 ER-TRAN-ERROR-MSG                                @
212290             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
212291             GO TO D40C-EXIT.                                     @
212293     IF TR-CHGC-YTD-EMPLOYEE-ASS-X IS EQUAL TO SPACES             @
212294         NEXT SENTENCE                                            @
212295     ELSE                                                         @
212296         IF TR-CHGC-YTD-EMPLOYEE-ASS-X IS NUMERIC                 @
212297             MOVE TR-CHGC-YTD-EMPLOYEE-ASS-9 TO                   @
212298                 PR-YTD-EMPLOYEE-ASSOC                            @
212299         ELSE                                                     @
212300             MOVE 'INVALID YTD-EMPLOYEE-ASSOC' TO                 @
212301                 ER-TRAN-ERROR-MSG                                @
212310             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
212320             GO TO D40C-EXIT.                                     @
212330     IF TR-CHGC-CUR-NONEL-PTO-TKN-X IS EQUAL TO SPACES            @
212340         NEXT SENTENCE                                            @
212350     ELSE                                                         @
212360         IF TR-CHGC-CUR-NONEL-PTO-TKN-X IS NUMERIC                @
212370             MOVE TR-CHGC-CUR-NONEL-PTO-TKN-9 TO                  @
212380                 PR-CUR-NONELECTIVE-PTO-TAKEN                     @
212390         ELSE                                                     @
212400             MOVE 'INVALID CUR-NONELECTIVE-PTO-TKN' TO            @
212410                 ER-TRAN-ERROR-MSG                                @
212420             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
212430             GO TO D40C-EXIT.                                     @
212440     IF TR-CHGC-CUR-NONEL-PTO-BAL-X IS EQUAL TO SPACES            @
212450         NEXT SENTENCE                                            @
212460     ELSE                                                         @
212470         IF TR-CHGC-CUR-NONEL-PTO-BAL-X IS NUMERIC                @
212480             MOVE TR-CHGC-CUR-NONEL-PTO-BAL-9 TO                  @
212490                 PR-CUR-NONELECTIVE-PTO-BALANCE                   @
212500         ELSE                                                     @
212510             MOVE 'INVALID CUR-NONELECTIVE-PTO-BALANCE' TO        @
212520                 ER-TRAN-ERROR-MSG                                @
212530             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
212540             GO TO D40C-EXIT.                                     @
212550     IF TR-CHGC-CUR-EL-PTO-TKN-X IS EQUAL TO SPACES               @
212560         NEXT SENTENCE                                            @
212570     ELSE                                                         @
212580         IF TR-CHGC-CUR-EL-PTO-TKN-X IS NUMERIC                   @
212590             MOVE TR-CHGC-CUR-EL-PTO-TKN-9 TO                     @
212600                 PR-CUR-ELECTIVE-PTO-TAKEN                        @
212610         ELSE                                                     @
212620             MOVE 'INVALID CUR-EECTIVEL-PTO-TAKEN' TO             @
212630                 ER-TRAN-ERROR-MSG                                @
212640             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
212650             GO TO D40C-EXIT.                                     @
212660     IF TR-CHGC-CUR-EL-PTO-BOT-X IS EQUAL TO SPACES               @
212670         NEXT SENTENCE                                            @
212680     ELSE                                                         @
212690         IF TR-CHGC-CUR-EL-PTO-BOT-X IS NUMERIC                   @
212700             MOVE TR-CHGC-CUR-EL-PTO-BOT-9 TO                     @
212710                 PR-CUR-ELECTIVE-PTO-BOUGHT                       @
212720         ELSE                                                     @
212730             MOVE 'INVALID CUR-ELECTIVE-PTO-BOUGH' TO             @
212740                 ER-TRAN-ERROR-MSG                                @
212750             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
212760             GO TO D40C-EXIT.                                     @
212770     IF TR-CHGC-CUR-EL-PTO-SOLD-X IS EQUAL TO SPACES              @
212780         NEXT SENTENCE                                            @
212790     ELSE                                                         @
212800         IF TR-CHGC-CUR-EL-PTO-SOLD-X IS NUMERIC                  @
212810             MOVE TR-CHGC-CUR-EL-PTO-SOLD-9 TO                    @
212820                 PR-CUR-ELECTIVE-PTO-SOLD                         @
212830         ELSE                                                     @
212840             MOVE 'INVALID CUR-ELECTIVE-PTO-SOLD' TO              @
212850                 ER-TRAN-ERROR-MSG                                @
212860             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
212870             GO TO D40C-EXIT.                                     @
212880     IF TR-CHGC-CUR-EL-PTO-TAKEN-X IS EQUAL TO SPACES             @
212890         NEXT SENTENCE                                            @
212900     ELSE                                                         @
212910         IF TR-CHGC-CUR-EL-PTO-TAKEN-X IS NUMERIC                 @
212920             MOVE TR-CHGC-CUR-EL-PTO-TAKEN-9 TO                   @
212930                 PR-CUR-ELECTIVE-PTO-TAKEN                        @
212940         ELSE                                                     @
212950             MOVE 'INVALID CUR-ELLECTIVE-PTO-TAKEN' TO            @
212960                 ER-TRAN-ERROR-MSG                                @
212970             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
212980             GO TO D40C-EXIT.                                     @
212993     IF TR-CHGC-CUR-EL-PTO-BAL-X IS EQUAL TO SPACES               @
213000         NEXT SENTENCE                                            @
213010     ELSE                                                         @
213020         IF TR-CHGC-CUR-EL-PTO-BAL-X IS NUMERIC                   @
213030             MOVE TR-CHGC-CUR-EL-PTO-BAL-9 TO                     @
213040                 PR-CUR-ELECTIVE-PTO-BALANCE                      @
213050         ELSE                                                     @
213060             MOVE 'INVALID CUR-ELECTIVE-PTO-BALAN' TO             @
213070                 ER-TRAN-ERROR-MSG                                @
213080             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
213090             GO TO D40C-EXIT.                                     @
213200     MOVE 'N' TO WS-CHANGE-ERROR-INDICATOR.                       @
213300 D40C-EXIT. EXIT.                                                 @
213400                                                                  @
213500 D40D-PROCESS-CD.                                                 @
213600     IF TR-CHGD-YTD-NONEL-PTO-TKN-X IS EQUAL TO SPACES            @
213700         NEXT SENTENCE                                            @
213800     ELSE                                                         @
213900         IF TR-CHGD-YTD-NONEL-PTO-TKN-X IS NUMERIC                @
214000             MOVE TR-CHGD-YTD-NONEL-PTO-TKN-9 TO                  @
214100                 PR-YTD-NONELECTIVE-PTO-TAKEN                     @
214200         ELSE                                                     @
214300             MOVE 'INVALID YTD-NONELECTIVE-PTO-TAKEN' TO          @
214400                 ER-TRAN-ERROR-MSG                                @
214500             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
214600             GO TO D40D-EXIT.                                     @
214700     IF TR-CHGD-YTD-NONEL-PTO-BAL-X IS EQUAL TO SPACES            @
214710         NEXT SENTENCE                                            @
214720     ELSE                                                         @
214730         IF TR-CHGD-YTD-NONEL-PTO-BAL-X IS NUMERIC                @
214740             MOVE TR-CHGD-YTD-NONEL-PTO-BAL-9 TO                  @
214750                 PR-YTD-NONELECTIVE-PTO-BALANCE                   @
214760         ELSE                                                     @
214770             MOVE 'INVALID YTD-NONEECTIVEL-PTO-BALANCE' TO        @
214780                 ER-TRAN-ERROR-MSG                                @
214790             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
214791             GO TO D40D-EXIT.                                     @
214793     IF TR-CHGD-YTD-EL-PTO-TKN-X IS EQUAL TO SPACES               @
214794         NEXT SENTENCE                                            @
214795     ELSE                                                         @
214796         IF TR-CHGD-YTD-EL-PTO-TKN-X IS NUMERIC                   @
214797             MOVE TR-CHGD-YTD-EL-PTO-TKN-9 TO                     @
214798                 PR-YTD-ELECTIVE-PTO-TAKEN                        @
214799         ELSE                                                     @
214800             MOVE 'INVALID YTD-ELECTIVE-PTO-TAKEN' TO             @
214801                 ER-TRAN-ERROR-MSG                                @
214810             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
214820             GO TO D40D-EXIT.                                     @
214830     IF TR-CHGD-YTD-EL-PTO-BOT-X IS EQUAL TO SPACES               @
214840         NEXT SENTENCE                                            @
214850     ELSE                                                         @
214860         IF TR-CHGD-YTD-EL-PTO-BOT-X IS NUMERIC                   @
214870             MOVE TR-CHGD-YTD-EL-PTO-BOT-9 TO                     @
214880                 PR-YTD-ELECTIVE-PTO-BOUGHT                       @
214890         ELSE                                                     @
214900             MOVE 'INVALID YTD-ELECTIVE-PTO-BOUGHT' TO            @
214910                 ER-TRAN-ERROR-MSG                                @
214920             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
214930             GO TO D40D-EXIT.                                     @
214940     IF TR-CHGD-YTD-EL-PTO-SOLD-X IS EQUAL TO SPACES              @
214950         NEXT SENTENCE                                            @
214960     ELSE                                                         @
214970         IF TR-CHGD-YTD-EL-PTO-SOLD-X IS NUMERIC                  @
214980             MOVE TR-CHGD-YTD-EL-PTO-SOLD-9 TO                    @
214990                 PR-YTD-ELECTIVE-PTO-SOLD                         @
215000         ELSE                                                     @
215010             MOVE 'INVALID YTD-ELECTIVE-PTO-SOLD' TO              @
215020                 ER-TRAN-ERROR-MSG                                @
215030             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
215040             GO TO D40D-EXIT.                                     @
215050     IF TR-CHGD-YTD-EL-PTO-TKN-X IS EQUAL TO SPACES               @
215060         NEXT SENTENCE                                            @
215070     ELSE                                                         @
215080         IF TR-CHGD-YTD-EL-PTO-TKN-X IS NUMERIC                   @
215090             MOVE TR-CHGD-YTD-EL-PTO-TKN-9 TO                     @
215100                 PR-YTD-ELECTIVE-PTO-TAKEN                        @
215110         ELSE                                                     @
215120             MOVE 'INVALID YTD-ELECTIVE-PTO-TAKEN' TO             @
215130                 ER-TRAN-ERROR-MSG                                @
215140             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
215150             GO TO D40D-EXIT.                                     @
215160     IF TR-CHGD-YTD-EL-PTO-BAL-X IS EQUAL TO SPACES               @
215170         NEXT SENTENCE                                            @
215180     ELSE                                                         @
215190         IF TR-CHGD-YTD-EL-PTO-BAL-X IS NUMERIC                   @
215200             MOVE TR-CHGD-YTD-EL-PTO-BAL-9 TO                     @
215210                 PR-YTD-ELECTIVE-PTO-BALANCE                      @
215220         ELSE                                                     @
215230             MOVE 'INVALID YTD-ELECTIVE-PTO-BALANCE' TO           @
215240                 ER-TRAN-ERROR-MSG                                @
215250             PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT       @
215260             GO TO D40D-EXIT.                                     @
215400     MOVE 'N' TO WS-CHANGE-ERROR-INDICATOR.                       @
215500 D40D-EXIT. EXIT.                                                 @
215600                                                                  @
215700 E100-WRITE-ERROR-REPORT.                                         @
215800     WRITE ERROR-LINE AFTER ADVANCING 1 LINE.                     @
215900     ADD +1 TO WS-ERROR-RECORDS-WRITTEN.                          @
216000 E100-EXIT. EXIT.                                                 @
216100                                                                  @
216200 T100-READ-TRANSACTION-FILE.                                      @
216300     IF WS-TRAN-RECORD-ALREADY-READ                               @
216400         MOVE 'N' TO WS-TRAN-RECORD-READ-SWITCH                   @
216500         GO TO T100-EXIT.                                         @
216600     READ TRANSACTION-FILE                                        @
216700         AT END                                                   @
216800             MOVE 'Y' TO WS-END-OF-TRANFILE-SWITCH                @
216900             GO TO T100-EXIT.                                     @     30
217000     ADD +1 TO WS-TRANSACTIONS-READ.                              @     30
217100 T100-EXIT. EXIT.                                                 @
217200                                                                  @
217300 T200-READ-PAYROLL-MASTER.                                        @
217400     MOVE 'S' TO WS-ERROR-INDICATOR                               @
217500     READ PAYROLL-MASTER-FILE.                                    @
217600     IF WS-VSAM-SUCCESSFUL OR                                     @
217700         WS-DUPLICATE-KEY-OK OR                                   @
217800         WS-LENGTH-DIFF-OK OR                                     @
217900         WS-RECD-NOT-FOUND                                        @
218000         ADD +1 TO WS-PAYROLL-RECORDS-READ                        @
218100     ELSE                                                         @
218200         MOVE 'PAYROLL FILE READ FAILED:' TO                      @
218300             ER-TRAN-ERROR-MSG                                    @
218400         PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT           @
218500         PERFORM X100-VSAM-ERRORS THRU X100-EXIT                  @
218600         MOVE 'F' TO WS-ERROR-INDICATOR.                          @
218700 T200-EXIT. EXIT.                                                 @
218800                                                                  @
218900 T300-WRITE-PAYROLL-MASTER.                                       @
219000     MOVE 'S' TO WS-ERROR-INDICATOR.                              @
219100     IF WS-VERIFY-RUN GO TO T300-EXIT.                            @
219200     WRITE PAYROLL-RECORD.                                        @
219300     IF WS-VSAM-SUCCESSFUL OR WS-DUPLICATE-KEY-OK                 @
219400         ADD +1 TO WS-PAYROLL-RECORDS-WRITTEN                     @
219500     ELSE                                                         @
219600         MOVE 'PAYROLL FILE WRITE FAILED:' TO                     @
219700             ER-TRAN-ERROR-MSG                                    @
219800         PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT           @
219900         PERFORM X100-VSAM-ERRORS THRU X100-EXIT                  @
220000         MOVE 'F' TO WS-ERROR-INDICATOR.                          @
220100 T300-EXIT. EXIT.                                                 @
220200                                                                  @
220300 T400-UPDATE-PAYROLL-MASTER.                                      @
220400     MOVE 'S' TO WS-ERROR-INDICATOR                               @
220500     IF WS-VERIFY-RUN GO TO T400-EXIT.                            @
220600     REWRITE PAYROLL-RECORD.                                      @
220700     IF WS-VSAM-SUCCESSFUL                                        @
220800         ADD +1 TO WS-PAYROLL-RECORDS-UPDATED                     @
220900     ELSE                                                         @
221000         MOVE 'PAYROLL FILE REWRITE FAILED:' TO                   @
221100             ER-TRAN-ERROR-MSG                                    @
221200         PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT           @
221300         PERFORM X100-VSAM-ERRORS THRU X100-EXIT                  @
221400         MOVE 'F' TO WS-ERROR-INDICATOR.                          @
221500 T400-EXIT. EXIT.                                                 @
221600                                                                  @
221700 T500-DELETE-PAYROLL-MASTER.                                      @
221800     MOVE 'S' TO WS-ERROR-INDICATOR                               @
221900     IF WS-VERIFY-RUN GO TO T500-EXIT.                            @
222000     IF PR-ACTIVE-RECORD                                          @
222100         MOVE 'D' TO PR-STATUS-INDICATOR                          @
222200         REWRITE PAYROLL-RECORD                                   @
222300         IF WS-VSAM-SUCCESSFUL                                    @
222400             ADD +1 TO WS-PAYROLL-RECORDS-MARKED                  @
222500         ELSE                                                     @
222600             NEXT SENTENCE                                        @
222700     ELSE                                                         @
222800         DELETE PAYROLL-MASTER-FILE RECORD                        @
222900         IF WS-VSAM-SUCCESSFUL                                    @
223000             ADD +1 TO WS-PAYROLL-RECORDS-DELETED.                @
223100     IF WS-VSAM-SUCCESSFUL                                        @
223200         NEXT SENTENCE                                            @
223300     ELSE                                                         @
223400         MOVE 'PAYROLL FILE DELETE FAILED:' TO                    @
223500             ER-TRAN-ERROR-MSG                                    @
223600         PERFORM X500-TRANSACTION-ERRORS THRU X500-EXIT           @
223700         PERFORM X100-VSAM-ERRORS THRU X100-EXIT                  @
223800         MOVE 'F' TO WS-ERROR-INDICATOR.                          @
223900 T500-EXIT. EXIT.                                                 @
224000                                                                  @
224100 X100-VSAM-ERRORS.                                                @
224200     MOVE 'N' TO WS-ERROR-INDICATOR.                              @
224300     PERFORM X200-SEARCH-VSAM-ERROR-TABLE                         @
224400         VARYING IX FROM 1 BY 1 UNTIL                             @
224500         WS-OPERATION-FAILED.                                     @
224600     MOVE WS-VSAM-FILE-STATUS TO ER-VSAM-STATUS-CODE.             @
224700     MOVE WS-VSAM-ERROR-MESSAGE(IX) TO ER-VSAM-MSG.               @
224800     MOVE  'VSAM FILE STATUS=' TO ER-VSAM-LIT1.                   @
224900     MOVE ': ' TO ER-VSAM-LIT2.                                   @
225000     MOVE '1' TO ER-CC.                                           @
225100     PERFORM E100-WRITE-ERROR-REPORT THRU E100-EXIT.              @
225200 X100-EXIT. EXIT.                                                 @
225300                                                                  @
225400 X200-SEARCH-VSAM-ERROR-TABLE.                                    @
225500     IF WS-VSAM-ERROR-CODE(IX) = WS-VSAM-FILE-STATUS OR ' '       @
225600     MOVE 'Y' TO WS-ERROR-INDICATOR.                              @
225700 X200-EXIT. EXIT.                                                 @
225800                                                                  @
225900 X500-TRANSACTION-ERRORS.                                         @
226000     WRITE ERROR-TRANSACTION-LINE AFTER ADVANCING 2 LINES.        @
226100     MOVE TRANSACTION-RECORD TO ER-TRAN-RECORD.                   @
226200     WRITE ERROR-TRANSACTION-LINE AFTER ADVANCING 1 LINE.         @
226300     MOVE SPACES TO ERROR-LINE.                                   @
226400 X500-EXIT. EXIT.                                                 @
226500                                                                  @
226600 X510-TRANSACTION-SEQUENCE-ERR.                                   @
226700     WRITE ERROR-TRANSACTION-LINE AFTER ADVANCING 2 LINES.        @
226800     MOVE 'FOLLOWING TRANSACTIONS WERE DROPPED:' TO               @
226900         ER-TRAN-ERROR-MSG.                                       @
227000     WRITE ERROR-TRANSACTION-LINE AFTER ADVANCING 1 LINE.         @
227100     MOVE WS-HOLD-ADD1 TO ER-TRAN-RECORD.                         @
227200     WRITE ERROR-TRANSACTION-LINE AFTER ADVANCING 1 LINE.         @
227300     IF WS-HELD-ADDS = 1                                          @
227400         GO TO X510-EXIT.                                         @
227500     MOVE WS-HOLD-ADD2 TO ER-TRAN-RECORD.                         @
227600     WRITE ERROR-TRANSACTION-LINE AFTER ADVANCING 1 LINE.         @
227700     IF WS-HELD-ADDS = 2                                          @
227800         GO TO X510-EXIT.                                         @
227900     MOVE WS-HOLD-ADD3 TO ER-TRAN-RECORD.                         @
228000     WRITE ERROR-TRANSACTION-LINE AFTER ADVANCING 1 LINE.         @
228100     IF WS-HELD-ADDS = 3                                          @
228200         GO TO X510-EXIT.                                         @
228300     MOVE WS-HOLD-ADD4 TO ER-TRAN-RECORD.                         @
228400     WRITE ERROR-TRANSACTION-LINE AFTER ADVANCING 1 LINE.         @
228500     IF WS-HELD-ADDS = 1                                          @
228600         GO TO X510-EXIT.                                         @
228700 X510-EXIT.                                                       @
228800     MOVE SPACES TO ERROR-LINE.                                   @
228900     EXIT.                                                        @
229000                                                                  @
229100 Y100-PRINT-A-LINE.                                               @
229200     WRITE TRANSACTION-LINE AFTER ADVANCING WS-LINE-SPACING.      @
229300     ADD WS-LINE-SPACING TO WS-LINE-COUNT.                        @
229400     IF WS-LINE-COUNT IS GREATER THAN 60                          @
229500         PERFORM Y200-PRINT-HEADING THRU Y200-EXIT.               @
229600 Y100-EXIT. EXIT.                                                 @
229700                                                                  @
229800 Y200-PRINT-HEADING.                                              @
229900     ADD +1 TO WS-PAGE-NUMBER.                                    @
230000     MOVE WS-PAGE-NUMBER TO WS-HEADING-PAGE-NUMBER.               @
230100     MOVE WS-HEADING-LINE-1 TO TRANSACTION-LINE.                  @
230200     WRITE TRANSACTION-LINE AFTER ADVANCING PAGE.                 @
230300     MOVE 2 TO WS-LINE-COUNT.                                     @
230400     MOVE SPACES TO TRANSACTION-LINE.                             @
230500 Y200-EXIT. EXIT.                                                 @
230600                                                                  @
230700 Z100-END-OF-PROCESSING.                                          @
230800     MOVE 'INPUT RECORDS READ' TO TL-EOJ-COUNT-NAME.              @     20
230900     MOVE WS-TRANSACTIONS-READ TO TL-EOJ-COUNTER.                 @     30
231000     PERFORM Y100-PRINT-A-LINE THRU Y100-EXIT.                    @
231100     MOVE 'OUTPUT RECORDS WRITTEN' TO TL-EOJ-COUNT-NAME.          @     20
231200     MOVE WS-ERROR-RECORDS-WRITTEN TO TL-EOJ-COUNTER.             @
231300     PERFORM Y100-PRINT-A-LINE THRU Y100-EXIT.                    @
231400     CLOSE TRANSACTION-FILE,                                      @
231500           ERROR-REPORT,                                          @
231600           TRANSACTION-REPORT,                                    @
231700           PAYROLL-MASTER-FILE.                                   @
231800 Z100-EXIT. EXIT.                                                 @
./ ADD NAME=PAYRECF  0106-01289-01296-1310-00142-00144-00000-BC0THOR
000100*****************************************************************
000200* VSAM PAYROLL FILE RECORD DESCRIPTOR FOR COBOL CLASS PROGRAMS. *
000300* KEY IS SOCIAL SECURITY NUMBER IN POSITIONS 2-10               *
000400* FIRST BYTE OF RECORD IS USED AS A DELETED RECORD INDICATOR.   *
000500* THIS DATA RECORD IS 564 BYTES LONG.                           *
000600*****************************************************************
000700 01  PAYROLL-RECORD.
000800     05  PR-STATUS-INDICATOR                PIC X.
000900         88  PR-ACTIVE-RECORD                 VALUE 'A'.
001000         88  PR-DELETED-RECORD                VALUE 'D'.
001100     05  PR-SOCIAL-SECURITY-NBR             PIC X(9).
001200     05  PR-EMPLOYEE-NAME.
001300         10  PR-LAST-NAME                   PIC X(12).
001400         10  PR-FIRST-NAME                  PIC X(12).
001500         10  PR-INITIAL                     PIC X.
001600         10  PR-NAME-SUFFIX                 PIC XXX.
001700     05  PR-ADDRESS-LINE-1                  PIC X(25).
001800     05  PR-ADDRESS-LINE-2                  PIC X(25).
001900     05  PR-CITY                            PIC X(24).
002000     05  PR-STATE                           PIC XX.
002100     05  PR-ZIP-5                           PIC X(5).
002200     05  PR-ZIP-LAST4                       PIC X(4).
002300     05  PR-EMPLOYEE-TYPE                   PIC X.
002400         88  PR-SALARIED                      VALUE 'S'.
002500         88  PR-HOURLY                        VALUE 'H'.
002600         88  PR-PART-TIME                     VALUE 'P'.
002610         88  PR-CONTRACTOR                    VALUE 'C'.
002700     05  PR-JOB-TITLE                       PIC X(35).
002800     05  PR-DEPARTMENT                      PIC X(20).
002801     05  PR-LOCATION                        PIC X(20).
002802     05  PR-COST-CENTER                     PIC XX.
002803     05  PR-EARNINGS.
002810         10  PR-SEMI-MONTHLY-SALARY         PIC S9(7)V99
002820                                              COMP-3.
002900         10  FILLER REDEFINES PR-SEMI-MONTHLY-SALARY.
003000             15  FILLER                     PIC XX.
003100             15  PR-HOURLY-RATE             PIC S9(3)V99
003200                                              COMP-3.
003300     05  PR-TAX-DATA.
003310         10  PR-EXEMPTIONS.
003400             15  PR-STATE-EXEMPTION         PIC S99 COMP-3.
003500             15  PR-FED-EXEMPTION           PIC S99 COMP-3.
003600         10  PR-FILING-STATUS               PIC X.
003700             88  PR-SINGLE                    VALUE 'U'.
003800             88  PR-HEAD-OF-HOUSEHOLD         VALUE 'H'.
003900             88  PR-MARRIED-JOINT             VALUE 'J'.
004000             88  PR-MARRIED-SEPARATE          VALUE 'S'.
004010     05  PR-BEFORE-TAX-DEDUCTIONS           COMP-3.
004011         10  PR-HEALTH-INSURANCE            PIC S9(3)V99.
004012         10  PR-DENTAL-INSURANCE            PIC S9(3)V99.
004020         10  PR-THRIFT-PLAN-PERCENT         PIC S99V9.
004030         10  PR-HEALTH-CARE-FLEX            PIC S9(5)V99.
004040         10  PR-CHILD-CARE-FLEX             PIC S9(5)V99.
004100     05  PR-AFTER-TAX-DEDUCTIONS            COMP-3.
004400         10  PR-CREDIT-UNION                PIC S9(7)V99.
004500         10  PR-UGF                         PIC S9(5)V99.
004600         10  PR-CHILDREN-INSURANCE          PIC S9(3)V99.
004700         10  PR-SPOUSE-INSURANCE            PIC S9(3)V99.
004800         10  PR-SUPPLEMENTAL-LIFE           PIC S9(3)V99.
004900         10  PR-LONG-TERM-DISABILITY        PIC S9(3)V99.
005000         10  PR-EMPLOYEE-ASSOCIATION        PIC S9V99.
005300     05  PR-TAXABLE-IMPUTED-INCOME          PIC S9(5)V99 COMP-3.
005400     05  PR-NONELECTIVE-PTO                 COMP-3.
005500         10  PR-NONELECTIVE-PTO-CARRYOVER   PIC S99V99.
005600         10  PR-NONELECTIVE-PTO-ALLOTTED    PIC S99V99.
005700         10  PR-NONELECTIVE-PTO-TAKEN       PIC S99V99.
005710     05  PR-ELECTIVE-PTO                    COMP-3.
005720         10  PR-ELECTIVE-PTO-ALLOTTED       PIC S99V99.
005730         10  PR-ELECTIVE-PTO-BOUGHT         PIC S99V99.
005740         10  PR-ELECTIVE-PTO-SOLD           PIC S99V99.
005750         10  PR-ELECTIVE-PTO-TAKEN          PIC S99V99.
005800     05  PR-CURRENT-EARNINGS                COMP-3.
005900         10  PR-CUR-REGULAR-EARNINGS        PIC S9(7)V99.
006000         10  PR-CUR-HOLIDAY-EARNINGS        PIC S9(5)V99.
006100         10  PR-CUR-PTO-EARNINGS            PIC S9(5)V99.
006200         10  PR-CUR-FLEX-DOLLARS            PIC S9(5)V99.
006300         10  PR-CUR-HEALTHY-RETURNS         PIC S9(5)V99.
006400         10  PR-CUR-MEDICAL-WAIVED          PIC S9(5)V99.
006500         10  PR-CUR-BONUS                   PIC S9(5)V99.
006600         10  PR-CUR-UGF-BONUS               PIC S9(5)V99.
006700         10  PR-CUR-FLOATING-HOLIDAY        PIC S9(5)V99.
006710     05  PR-YTD-EARNINGS                    COMP-3.
006720         10  PR-YTD-REGULAR-EARNINGS        PIC S9(7)V99.
006730         10  PR-YTD-HOLIDAY-EARNINGS        PIC S9(5)V99.
006740         10  PR-YTD-PTO-EARNINGS            PIC S9(5)V99.
006750         10  PR-YTD-FLEX-DOLLARS            PIC S9(5)V99.
006760         10  PR-YTD-HEALTHY-RETURNS         PIC S9(5)V99.
006770         10  PR-YTD-MEDICAL-WAIVED          PIC S9(5)V99.
006780         10  PR-YTD-BONUS                   PIC S9(5)V99.
006790         10  PR-YTD-UGF-BONUS               PIC S9(5)V99.
006791         10  PR-YTD-FLOATING-HOLIDAY        PIC S9(5)V99.
006800     05  PR-CURRENT-TAXES                   COMP-3.
006900         10  PR-CUR-FED-TAX                 PIC S9(7)V99.
007000         10  PR-CUR-FICA-MHI                PIC S9(5)V99.
007100         10  PR-CUR-OASDI                   PIC S9(5)V99.
007200         10  PR-CUR-STATE-TAX               PIC S9(5)V99.
007210     05  PR-YTD-TAXES                       COMP-3.
007220         10  PR-YTD-FED-TAX                 PIC S9(7)V99.
007230         10  PR-YTD-FICA-MHI                PIC S9(5)V99.
007240         10  PR-YTD-OASDI                   PIC S9(5)V99.
007250         10  PR-YTD-STATE-TAX               PIC S9(5)V99.
007300     05  PR-CURRENT-B4-TAX-DEDUCTIONS   COMP-3.
007400         10  PR-CUR-THRIFT-PLAN             PIC S9(5)V99.
007500         10  PR-CUR-MEDICAL-INSURANCE       PIC S9(5)V99.
007600         10  PR-CUR-DENTAL-INSURANCE        PIC S9(5)V99.
007700         10  PR-CUR-HEALTH-CARE-FLEX        PIC S9(5)V99.
007800         10  PR-CUR-CHILD-CARE-FLEX         PIC S9(5)V99.
007810     05  PR-YTD-BEFORE-TAX-DEDUCTIONS COMP-3.
007820         10  PR-YTD-THRIFT-PLAN             PIC S9(5)V99.
007830         10  PR-YTD-MEDICAL-INSURANCE       PIC S9(5)V99.
007840         10  PR-YTD-DENTAL-INSURANCE        PIC S9(5)V99.
007850         10  PR-YTD-HEALTH-CARE-FLEX        PIC S9(5)V99.
007860         10  PR-YTD-CHILD-CARE-FLEX         PIC S9(5)V99.
007870     05  PR-CURRENT-AFTR-TAX-DEDUCTIONS    COMP-3.
007900         10  PR-CUR-CREDIT-UNION            PIC S9(5)V99.
008000         10  PR-CUR-UGF                     PIC S9(5)V99.
008100         10  PR-CUR-CHILDREN-INSURANCE      PIC S9(5)V99.
008200         10  PR-CUR-SPOUSE-INSURANCE        PIC S9(5)V99.
008300         10  PR-CUR-LTD-INSURANCE           PIC S9(5)V99.
008400         10  PR-CUR-EMPLOYEE-ASSOC          PIC S9(5)V99.
008410     05  PR-YTD-AFTER-TAX-DEDUCTIONS COMP-3.
008420         10  PR-YTD-CREDIT-UNION            PIC S9(5)V99.
008430         10  PR-YTD-UGF                     PIC S9(5)V99.
008440         10  PR-YTD-CHILDREN-INSURANCE      PIC S9(5)V99.
008450         10  PR-YTD-SPOUSE-INSURANCE        PIC S9(5)V99.
008460         10  PR-YTD-LTD-INSURANCE           PIC S9(5)V99.
008470         10  PR-YTD-EMPLOYEE-ASSOC          PIC S9(5)V99.
008500     05  PR-CURRENT-PTO                     COMP-3.
008600         10  PR-CUR-NONELECTIVE-PTO-TAKEN   PIC S999V99.
008700         10  PR-CUR-NONELECTIVE-PTO-BALANCE PIC S999V99.
008800         10  PR-CUR-ELECTIVE-PTO-TAKEN      PIC S999V99.
008900         10  PR-CUR-ELECTIVE-PTO-BOUGHT     PIC S999V99.
008910         10  PR-CUR-ELECTIVE-PTO-SOLD       PIC S999V99.
008930         10  PR-CUR-ELECTIVE-PTO-BALANCE    PIC S999V99.
008940     05  PR-YTD-PTO                         COMP-3.
008950         10  PR-YTD-NONELECTIVE-PTO-TAKEN   PIC S999V99.
008960         10  PR-YTD-NONELECTIVE-PTO-BALANCE PIC S999V99.
008970         10  PR-YTD-ELECTIVE-PTO-TAKEN      PIC S999V99.
008980         10  PR-YTD-ELECTIVE-PTO-BOUGHT     PIC S999V99.
008990         10  PR-YTD-ELECTIVE-PTO-SOLD       PIC S999V99.
008992         10  PR-YTD-ELECTIVE-PTO-BALANCE    PIC S999V99.
009000     05  PR-FILLER                          PIC X(57).
./ ADD NAME=REL4000C 0101-01302-01302-1141-00080-00080-00000-BC0THOR
000100 IDENTIFICATION DIVISION.
000200*
000300 PROGRAM-ID. REL4000C.
000400*
000500 ENVIRONMENT DIVISION.
000600*
000700 INPUT-OUTPUT SECTION.
000800*
000900 FILE-CONTROL.
001000     SELECT INVMASTS ASSIGN TO INVMASTS.
001100     SELECT INVMASTR ASSIGN TO INVMASTR
001200                     ORGANIZATION IS RELATIVE
001300                     ACCESS IS RANDOM
001400                     RELATIVE KEY IS INVMASTR-RR-NUMBER.
001500*
001600 DATA DIVISION.
001700*
001800 FILE SECTION.
001900*
002000 FD  INVMASTS.
002100*
002200 01  SEQUENTIAL-RECORD-AREA  PIC X(70).
002300*
002400 FD  INVMASTR.
002500*
002600 01  RELATIVE-RECORD-AREA    PIC X(70).
002700*
002800 WORKING-STORAGE SECTION.
002900*
003000 01  SWITCHES.
003100     05  INVMAST-EOF-SWITCH      PIC X    VALUE "N".
003200         88  INVMAST-EOF                  VALUE "Y".
003300*
003400 01  KEY-FIELDS.
003500     05  INVMASTR-RR-NUMBER      PIC 9(5).
003600*
003700 01  INVENTORY-MASTER-RECORD.
003800     05  IM-ITEM-NO              PIC X(5).
003900     05  IM-DESCRIPTIVE-DATA.
004000         10  IM-ITEM-DESC        PIC X(40).
004100         10  IM-UNIT-COST        PIC S9(3)V99.
004200         10  IM-UNIT-PRICE       PIC S9(3)V99.
004300     05  IM-INVENTORY-DATA.
004400         10  IM-REORDER-POINT    PIC S9(5).
004500         10  IM-ON-HAND          PIC S9(5).
004600         10  IM-ON-ORDER         PIC S9(5).
004700*
004800 PROCEDURE DIVISION.
004900*
005000 000-CREATE-INVENTORY-FILE.
005100*
005200     OPEN INPUT  INVMASTS
005300          OUTPUT INVMASTR.
005400     PERFORM 100-CREATE-INVENTORY-RECORD
005500         UNTIL INVMAST-EOF.
005600     CLOSE INVMASTS
005700           INVMASTR.
005800     STOP RUN.
005900*
006000 100-CREATE-INVENTORY-RECORD.
006100*
006200     PERFORM 110-READ-SEQUENTIAL-RECORD.
006300     IF NOT INVMAST-EOF
006400         PERFORM 120-WRITE-RELATIVE-RECORD.
006500*
006600 110-READ-SEQUENTIAL-RECORD.
006700*
006800     READ INVMASTS INTO INVENTORY-MASTER-RECORD
006900         AT END
007000             MOVE "Y" TO INVMAST-EOF-SWITCH.
007100*
007200 120-WRITE-RELATIVE-RECORD.
007300*
007400     COMPUTE INVMASTR-RR-NUMBER =
007500         FUNCTION NUMVAL (IM-ITEM-NO) - 10000.
007600     WRITE RELATIVE-RECORD-AREA FROM INVENTORY-MASTER-RECORD
007700         INVALID KEY
007800             DISPLAY "WRITE ERROR ON INVMASTR FOR ITEM NUMBER "
007900                 IM-ITEM-NO
008000             MOVE "Y" TO INVMAST-EOF-SWITCH.
./ ADD NAME=RPT1000C 0101-01302-01302-1142-00177-00177-00000-BC0THOR
000100 IDENTIFICATION DIVISION.
000200*
000300 PROGRAM-ID. RPT1000C.
000400*
000500 ENVIRONMENT DIVISION.
000600*
000700 INPUT-OUTPUT SECTION.
000800*
000900 FILE-CONTROL.
001000*
001100     SELECT CUSTMAST ASSIGN TO CUSTMAST.
001200     SELECT SALESRPT ASSIGN TO SALESRPT.
001300*
001400 DATA DIVISION.
001500*
001600 FILE SECTION.
001700*
001800 FD  CUSTMAST.
001900*
002000 01  CUSTOMER-MASTER-RECORD.
002100     05  CM-BRANCH-NUMBER        PIC 9(2).
002200     05  CM-SALESREP-NUMBER      PIC 9(2).
002300     05  CM-CUSTOMER-NUMBER      PIC 9(5).
002400     05  CM-CUSTOMER-NAME        PIC X(20).
002500     05  CM-SALES-THIS-YTD       PIC S9(5)V9(2).
002600     05  CM-SALES-LAST-YTD       PIC S9(5)V9(2).
002700*
002800 FD  SALESRPT.
002900*
003000 01  PRINT-AREA      PIC X(132).
003100*
003200 WORKING-STORAGE SECTION.
003300*
003400 01  SWITCHES.
003500     05  CUSTMAST-EOF-SWITCH     PIC X    VALUE "N".
003600*
003700 01  PRINT-FIELDS.
003800     05  PAGE-COUNT      PIC S9(3)   VALUE ZERO.
003900     05  LINES-ON-PAGE   PIC S9(3)   VALUE +55.
004000     05  LINE-COUNT      PIC S9(3)   VALUE +99.
004100     05  SPACE-CONTROL   PIC S9.
004200*
004300 01  TOTAL-FIELDS.
004400     05  GRAND-TOTAL-THIS-YTD   PIC S9(7)V99   VALUE ZERO.
004500     05  GRAND-TOTAL-LAST-YTD   PIC S9(7)V99   VALUE ZERO.
004600*
004700 01  CURRENT-DATE-AND-TIME.
004800     05  CD-YEAR         PIC 9999.
004900     05  CD-MONTH        PIC 99.
005000     05  CD-DAY          PIC 99.
005100     05  CD-HOURS        PIC 99.
005200     05  CD-MINUTES      PIC 99.
005300     05  FILLER          PIC X(9).
005400*
005500 01  HEADING-LINE-1.
005600     05  FILLER          PIC X(7)    VALUE "DATE:  ".
005700     05  HL1-MONTH       PIC 9(2).
005800     05  FILLER          PIC X(1)    VALUE "/".
005900     05  HL1-DAY         PIC 9(2).
006000     05  FILLER          PIC X(1)    VALUE "/".
006100     05  HL1-YEAR        PIC 9(4).
006200     05  FILLER          PIC X(11)   VALUE SPACE.
006300     05  FILLER          PIC X(20)   VALUE "YEAR-TO-DATE SALES R".
006400     05  FILLER          PIC X(20)   VALUE "EPORT               ".
006500     05  FILLER          PIC X(8)    VALUE "  PAGE: ".
006600     05  HL1-PAGE-NUMBER PIC ZZZ9.
006700     05  FILLER          PIC X(52)   VALUE SPACE.
006800*
006900 01  HEADING-LINE-2.
007000     05  FILLER          PIC X(7)    VALUE "TIME:  ".
007100     05  HL2-HOURS       PIC 9(2).
007200     05  FILLER          PIC X(1)    VALUE ":".
007300     05  HL2-MINUTES     PIC 9(2).
007400     05  FILLER          PIC X(58)   VALUE SPACE.
007500     05  FILLER          PIC X(10)   VALUE "RPT1000".
007600     05  FILLER          PIC X(52)   VALUE SPACE.
007700*
007800 01  HEADING-LINE-3.
007900     05  FILLER      PIC X(20)   VALUE "CUST                ".
008000     05  FILLER      PIC X(20)   VALUE "            SALES   ".
008100     05  FILLER      PIC X(20)   VALUE "      SALES         ".
008200     05  FILLER      PIC X(72)   VALUE SPACE.
008300*
008400 01  HEADING-LINE-4.
008500     05  FILLER      PIC X(20)   VALUE "NUM    CUSTOMER NAME".
008600     05  FILLER      PIC X(20)   VALUE "           THIS YTD ".
008700     05  FILLER      PIC X(20)   VALUE "     LAST YTD       ".
008800     05  FILLER      PIC X(72)   VALUE SPACE.
008900*
009000 01  CUSTOMER-LINE.
009100     05  CL-CUSTOMER-NUMBER  PIC 9(5).
009200     05  FILLER              PIC X(2)     VALUE SPACE.
009300     05  CL-CUSTOMER-NAME    PIC X(20).
009400     05  FILLER              PIC X(3)     VALUE SPACE.
009500     05  CL-SALES-THIS-YTD   PIC ZZ,ZZ9.99-.
009600     05  FILLER              PIC X(4)     VALUE SPACE.
009700     05  CL-SALES-LAST-YTD   PIC ZZ,ZZ9.99-.
009800     05  FILLER              PIC X(78)    VALUE SPACE.
009900*
010000 01  GRAND-TOTAL-LINE.
010100     05  FILLER              PIC X(27)    VALUE SPACE.
010200     05  GTL-SALES-THIS-YTD  PIC Z,ZZZ,ZZ9.99-.
010300     05  FILLER              PIC X(1)     VALUE SPACE.
010400     05  GTL-SALES-LAST-YTD  PIC Z,ZZZ,ZZ9.99-.
010500     05  FILLER              PIC X(78)    VALUE SPACE.
010600*
010700 PROCEDURE DIVISION.
010800*
010900 000-PREPARE-SALES-REPORT.
011000*
011100     OPEN INPUT  CUSTMAST
011200          OUTPUT SALESRPT.
011300     PERFORM 100-FORMAT-REPORT-HEADING.
011400     PERFORM 200-PREPARE-SALES-LINES
011500         UNTIL CUSTMAST-EOF-SWITCH = "Y".
011600     PERFORM 300-PRINT-GRAND-TOTALS.
011700     CLOSE CUSTMAST
011800           SALESRPT.
011900     STOP RUN.
012000*
012100 100-FORMAT-REPORT-HEADING.
012200*
012300     MOVE FUNCTION CURRENT-DATE TO CURRENT-DATE-AND-TIME.
012400     MOVE CD-MONTH   TO HL1-MONTH.
012500     MOVE CD-DAY     TO HL1-DAY.
012600     MOVE CD-YEAR    TO HL1-YEAR.
012700     MOVE CD-HOURS   TO HL2-HOURS.
012800     MOVE CD-MINUTES TO HL2-MINUTES.
012900*
013000 200-PREPARE-SALES-LINES.
013100*
013200     PERFORM 210-READ-CUSTOMER-RECORD.
013300     IF CUSTMAST-EOF-SWITCH = "N"
013400         PERFORM 220-PRINT-CUSTOMER-LINE.
013500*
013600 210-READ-CUSTOMER-RECORD.
013700*
013800     READ CUSTMAST
013900         AT END
014000             MOVE "Y" TO CUSTMAST-EOF-SWITCH.
014100*
014200 220-PRINT-CUSTOMER-LINE.
014300*
014400     IF LINE-COUNT >= LINES-ON-PAGE
014500         PERFORM 230-PRINT-HEADING-LINES.
014600     MOVE CM-CUSTOMER-NUMBER  TO CL-CUSTOMER-NUMBER.
014700     MOVE CM-CUSTOMER-NAME    TO CL-CUSTOMER-NAME.
014800     MOVE CM-SALES-THIS-YTD   TO CL-SALES-THIS-YTD.
014900     MOVE CM-SALES-LAST-YTD   TO CL-SALES-LAST-YTD.
015000     MOVE CUSTOMER-LINE TO PRINT-AREA.
015100     WRITE PRINT-AREA AFTER ADVANCING SPACE-CONTROL LINES.
015200     ADD 1 TO LINE-COUNT.
015300     ADD CM-SALES-THIS-YTD TO GRAND-TOTAL-THIS-YTD.
015400     ADD CM-SALES-LAST-YTD TO GRAND-TOTAL-LAST-YTD.
015500     MOVE 1 TO SPACE-CONTROL.
015600*
015700 230-PRINT-HEADING-LINES.
015800*
015900     ADD 1 TO PAGE-COUNT.
016000     MOVE PAGE-COUNT     TO HL1-PAGE-NUMBER.
016100     MOVE HEADING-LINE-1 TO PRINT-AREA.
016200     WRITE PRINT-AREA AFTER ADVANCING PAGE.
016300     MOVE HEADING-LINE-2 TO PRINT-AREA.
016400     WRITE PRINT-AREA AFTER ADVANCING 1 LINES.
016500     MOVE HEADING-LINE-3 TO PRINT-AREA.
016600     WRITE PRINT-AREA AFTER ADVANCING 2 LINES.
016700     MOVE HEADING-LINE-4 TO PRINT-AREA.
016800     WRITE PRINT-AREA AFTER ADVANCING 1 LINES.
016900     MOVE ZERO TO LINE-COUNT.
017000     MOVE 2 TO SPACE-CONTROL.
017100*
017200 300-PRINT-GRAND-TOTALS.
017300*
017400     MOVE GRAND-TOTAL-THIS-YTD TO GTL-SALES-THIS-YTD.
017500     MOVE GRAND-TOTAL-LAST-YTD TO GTL-SALES-LAST-YTD.
017600     MOVE GRAND-TOTAL-LINE     TO PRINT-AREA.
017700     WRITE PRINT-AREA AFTER ADVANCING 2 LINES.
./ ADD NAME=RPT2000C 0101-01302-01302-1143-00211-00211-00000-BC0THOR
000100 IDENTIFICATION DIVISION.
000200*
000300 PROGRAM-ID. RPT2000C.
000400*
000500 ENVIRONMENT DIVISION.
000600*
000700 INPUT-OUTPUT SECTION.
000800*
000900 FILE-CONTROL.
001000*
001100     SELECT CUSTMAST ASSIGN TO CUSTMAST.
001200     SELECT SALESRPT ASSIGN TO SALESRPT.
001300*
001400 DATA DIVISION.
001500*
001600 FILE SECTION.
001700*
001800 FD  CUSTMAST.
001900*
002000 01  CUSTOMER-MASTER-RECORD.
002100     05  CM-BRANCH-NUMBER        PIC 9(2).
002200     05  CM-SALESREP-NUMBER      PIC 9(2).
002300     05  CM-CUSTOMER-NUMBER      PIC 9(5).
002400     05  CM-CUSTOMER-NAME        PIC X(20).
002500     05  CM-SALES-THIS-YTD       PIC S9(5)V9(2).
002600     05  CM-SALES-LAST-YTD       PIC S9(5)V9(2).
002700*
002800 FD  SALESRPT.
002900*
003000 01  PRINT-AREA      PIC X(132).
003100*
003200 WORKING-STORAGE SECTION.
003300*
003400 01  SWITCHES.
003500     05  CUSTMAST-EOF-SWITCH     PIC X   VALUE "N".
003600*
003700 01  CALCULATED-FIELDS.
003800     05  CHANGE-AMOUNT           PIC S9(7)V99.
003900*
004000 01  PRINT-FIELDS.
004100     05  PAGE-COUNT      PIC S9(3)   VALUE ZERO.
004200     05  LINES-ON-PAGE   PIC S9(3)   VALUE +55.
004300     05  LINE-COUNT      PIC S9(3)   VALUE +99.
004400     05  SPACE-CONTROL   PIC S9.
004500*
004600 01  TOTAL-FIELDS.
004700     05  GRAND-TOTAL-THIS-YTD    PIC S9(7)V99    VALUE ZERO.
004800     05  GRAND-TOTAL-LAST-YTD    PIC S9(7)V99    VALUE ZERO.
004900*
005000 01  CURRENT-DATE-AND-TIME.
005100     05  CD-YEAR         PIC 9999.
005200     05  CD-MONTH        PIC 99.
005300     05  CD-DAY          PIC 99.
005400     05  CD-HOURS        PIC 99.
005500     05  CD-MINUTES      PIC 99.
005600     05  FILLER          PIC X(9).
005700*
005800 01  HEADING-LINE-1.
005900     05  FILLER          PIC X(7)    VALUE "DATE:  ".
006000     05  HL1-MONTH       PIC 9(2).
006100     05  FILLER          PIC X(1)    VALUE "/".
006200     05  HL1-DAY         PIC 9(2).
006300     05  FILLER          PIC X(1)    VALUE "/".
006400     05  HL1-YEAR        PIC 9(4).
006500     05  FILLER          PIC X(11)   VALUE SPACE.
006600     05  FILLER          PIC X(20)   VALUE "YEAR-TO-DATE SALES R".
006700     05  FILLER          PIC X(20)   VALUE "EPORT               ".
006800     05  FILLER          PIC X(8)    VALUE "  PAGE: ".
006900     05  HL1-PAGE-NUMBER PIC ZZZ9.
007000     05  FILLER          PIC X(52)   VALUE SPACE.
007100*
007200 01  HEADING-LINE-2.
007300     05  FILLER          PIC X(7)    VALUE "TIME:  ".
007400     05  HL2-HOURS       PIC 9(2).
007500     05  FILLER          PIC X(1)    VALUE ":".
007600     05  HL2-MINUTES     PIC 9(2).
007700     05  FILLER          PIC X(58)   VALUE SPACE.
007800     05  FILLER          PIC X(10)   VALUE "RPT2000".
007900     05  FILLER          PIC X(52)   VALUE SPACE.
008000*
008100 01  HEADING-LINE-3.
008200     05  FILLER      PIC X(20)   VALUE "CUST                ".
008300     05  FILLER      PIC X(20)   VALUE "            SALES   ".
008400     05  FILLER      PIC X(20)   VALUE "      SALES         ".
008500     05  FILLER      PIC X(20)   VALUE "CHANGE     CHANGE   ".
008600     05  FILLER      PIC X(52)   VALUE SPACE.
008700*
008800 01  HEADING-LINE-4.
008900     05  FILLER      PIC X(20)   VALUE "NUM    CUSTOMER NAME".
009000     05  FILLER      PIC X(20)   VALUE "           THIS YTD ".
009100     05  FILLER      PIC X(20)   VALUE "     LAST YTD       ".
009200     05  FILLER      PIC X(20)   VALUE "AMOUNT    PERCENT   ".
009300     05  FILLER      PIC X(52)   VALUE SPACE.
009400*
009500 01  CUSTOMER-LINE.
009600     05  CL-CUSTOMER-NUMBER   PIC 9(5).
009700     05  FILLER               PIC X(2)       VALUE SPACE.
009800     05  CL-CUSTOMER-NAME     PIC X(20).
009900     05  FILLER               PIC X(3)       VALUE SPACE.
010000     05  CL-SALES-THIS-YTD    PIC ZZ,ZZ9.99-.
010100     05  FILLER               PIC X(4)       VALUE SPACE.
010200     05  CL-SALES-LAST-YTD    PIC ZZ,ZZ9.99-.
010300     05  FILLER               PIC X(4)       VALUE SPACE.
010400     05  CL-CHANGE-AMOUNT     PIC ZZ,ZZ9.99-.
010500     05  FILLER               PIC X(3)       VALUE SPACE.
010600     05  CL-CHANGE-PERCENT    PIC ZZ9.9-.
010700     05  FILLER               PIC X(55)      VALUE SPACE.
010800*
010900 01  GRAND-TOTAL-LINE.
011000     05  FILLER               PIC X(27)      VALUE SPACE.
011100     05  GTL-SALES-THIS-YTD   PIC Z,ZZZ,ZZ9.99-.
011200     05  FILLER               PIC X(1)       VALUE SPACE.
011300     05  GTL-SALES-LAST-YTD   PIC Z,ZZZ,ZZ9.99-.
011400     05  FILLER               PIC X(1)       VALUE SPACE.
011500     05  GTL-CHANGE-AMOUNT    PIC Z,ZZZ,ZZ9.99-.
011600     05  FILLER               PIC X(3)       VALUE SPACE.
011700     05  GTL-CHANGE-PERCENT   PIC ZZ9.9-.
011800     05  FILLER               PIC X(55)      VALUE SPACE.
011900*
012000 PROCEDURE DIVISION.
012100*
012200 000-PREPARE-SALES-REPORT.
012300*
012400     OPEN INPUT  CUSTMAST
012500          OUTPUT SALESRPT.
012600     PERFORM 100-FORMAT-REPORT-HEADING.
012700     PERFORM 200-PREPARE-SALES-LINES
012800         UNTIL CUSTMAST-EOF-SWITCH = "Y".
012900     PERFORM 300-PRINT-GRAND-TOTALS.
013000     CLOSE CUSTMAST
013100           SALESRPT.
013200     STOP RUN.
013300*
013400 100-FORMAT-REPORT-HEADING.
013500*
013600     MOVE FUNCTION CURRENT-DATE TO CURRENT-DATE-AND-TIME.
013700     MOVE CD-MONTH   TO HL1-MONTH.
013800     MOVE CD-DAY     TO HL1-DAY.
013900     MOVE CD-YEAR    TO HL1-YEAR.
014000     MOVE CD-HOURS   TO HL2-HOURS.
014100     MOVE CD-MINUTES TO HL2-MINUTES.
014200*
014300 200-PREPARE-SALES-LINES.
014400*
014500     PERFORM 210-READ-CUSTOMER-RECORD.
014600     IF CUSTMAST-EOF-SWITCH = "N"
014700         IF CM-SALES-THIS-YTD >= 10000
014800             PERFORM 220-PRINT-CUSTOMER-LINE.
014900*
015000 210-READ-CUSTOMER-RECORD.
015100*
015200     READ CUSTMAST
015300         AT END
015400             MOVE "Y" TO CUSTMAST-EOF-SWITCH.
015500*
015600 220-PRINT-CUSTOMER-LINE.
015700*
015800     IF LINE-COUNT > LINES-ON-PAGE
015900         PERFORM 230-PRINT-HEADING-LINES.
016000     MOVE CM-CUSTOMER-NUMBER   TO CL-CUSTOMER-NUMBER.
016100     MOVE CM-CUSTOMER-NAME     TO CL-CUSTOMER-NAME.
016200     MOVE CM-SALES-THIS-YTD    TO CL-SALES-THIS-YTD.
016300     MOVE CM-SALES-LAST-YTD    TO CL-SALES-LAST-YTD.
016400     COMPUTE CHANGE-AMOUNT =
016500         CM-SALES-THIS-YTD - CM-SALES-LAST-YTD.
016600     MOVE CHANGE-AMOUNT TO CL-CHANGE-AMOUNT.
016700     IF CM-SALES-LAST-YTD = ZERO
016800         MOVE 999.9 TO CL-CHANGE-PERCENT
016900     ELSE
017000         COMPUTE CL-CHANGE-PERCENT ROUNDED =
017100             CHANGE-AMOUNT * 100 / CM-SALES-LAST-YTD
017200             ON SIZE ERROR
017300                 MOVE 999.9 TO CL-CHANGE-PERCENT.
017400     MOVE CUSTOMER-LINE TO PRINT-AREA.
017500     WRITE PRINT-AREA AFTER ADVANCING SPACE-CONTROL LINES.
017600     ADD 1 TO LINE-COUNT.
017700     ADD CM-SALES-THIS-YTD TO GRAND-TOTAL-THIS-YTD.
017800     ADD CM-SALES-LAST-YTD TO GRAND-TOTAL-LAST-YTD.
017900     MOVE 1 TO SPACE-CONTROL.
018000*
018100 230-PRINT-HEADING-LINES.
018200*
018300     ADD 1 TO PAGE-COUNT.
018400     MOVE PAGE-COUNT     TO HL1-PAGE-NUMBER.
018500     MOVE HEADING-LINE-1 TO PRINT-AREA.
018600     WRITE PRINT-AREA AFTER ADVANCING PAGE.
018700     MOVE HEADING-LINE-2 TO PRINT-AREA.
018800     WRITE PRINT-AREA AFTER ADVANCING 1 LINES.
018900     MOVE HEADING-LINE-3 TO PRINT-AREA.
019000     WRITE PRINT-AREA AFTER ADVANCING 2 LINES.
019100     MOVE HEADING-LINE-4 TO PRINT-AREA.
019200     WRITE PRINT-AREA AFTER ADVANCING 1 LINES.
019300     MOVE ZERO TO LINE-COUNT.
019400     MOVE 2 TO SPACE-CONTROL.
019500*
019600 300-PRINT-GRAND-TOTALS.
019700*
019800     MOVE GRAND-TOTAL-THIS-YTD TO GTL-SALES-THIS-YTD.
019900     MOVE GRAND-TOTAL-LAST-YTD TO GTL-SALES-LAST-YTD.
020000     COMPUTE CHANGE-AMOUNT =
020100         GRAND-TOTAL-THIS-YTD - GRAND-TOTAL-LAST-YTD.
020200     MOVE CHANGE-AMOUNT TO GTL-CHANGE-AMOUNT.
020300     IF GRAND-TOTAL-LAST-YTD = ZERO
020400         MOVE 999.9 TO GTL-CHANGE-PERCENT
020500     ELSE
020600         COMPUTE GTL-CHANGE-PERCENT ROUNDED =
020700             CHANGE-AMOUNT * 100 / GRAND-TOTAL-LAST-YTD
020800             ON SIZE ERROR
020900                 MOVE 999.9 TO GTL-CHANGE-PERCENT.
021000     MOVE GRAND-TOTAL-LINE TO PRINT-AREA.
021100     WRITE PRINT-AREA AFTER ADVANCING 2 LINES.
./ ADD NAME=RPT3000C 0102-01302-01302-1144-00288-00288-00000-BC0THOR
000100 IDENTIFICATION DIVISION.
000200*
000300 PROGRAM-ID. RPT3000C.
000400*
000500 ENVIRONMENT DIVISION.
000600*
000700 INPUT-OUTPUT SECTION.
000800*
000900 FILE-CONTROL.
001000*
001100     SELECT CUSTMAST ASSIGN TO CUSTMAST.
001200     SELECT SALESRPT ASSIGN TO SALESRPT.
001300*
001400 DATA DIVISION.
001500*
001600 FILE SECTION.
001700*
001800 FD  CUSTMAST.
001900*
002000 01  CUSTOMER-MASTER-RECORD.
002100     05  CM-BRANCH-NUMBER        PIC 9(2).
002200     05  CM-SALESREP-NUMBER      PIC 9(2).
002300     05  CM-CUSTOMER-NUMBER      PIC 9(5).
002400     05  CM-CUSTOMER-NAME        PIC X(20).
002500     05  CM-SALES-THIS-YTD       PIC S9(5)V9(2).
002600     05  CM-SALES-LAST-YTD       PIC S9(5)V9(2).
002700*
002800 FD  SALESRPT.
002900*
003000 01  PRINT-AREA      PIC X(132).
003100*
003200 WORKING-STORAGE SECTION.
003300*
003400 01  SWITCHES.
003500     05  CUSTMAST-EOF-SWITCH     PIC X   VALUE "N".
003600     05  FIRST-RECORD-SWITCH     PIC X   VALUE "Y".
003700*
003800 01  CONTROL-FIELDS.
003900     05  OLD-BRANCH-NUMBER       PIC 99.
004000*
004100 01  CALCULATED-FIELDS.
004200     05  CHANGE-AMOUNT           PIC S9(7)V99.
004300*
004400 01  PRINT-FIELDS.
004500     05  PAGE-COUNT      PIC S9(3)   VALUE ZERO.
004600     05  LINES-ON-PAGE   PIC S9(3)   VALUE +55.
004700     05  LINE-COUNT      PIC S9(3)   VALUE +99.
004800     05  SPACE-CONTROL   PIC S9.
004900*
005000 01  TOTAL-FIELDS.
005100     05  BRANCH-TOTAL-THIS-YTD   PIC S9(6)V99    VALUE ZERO.
005200     05  BRANCH-TOTAL-LAST-YTD   PIC S9(6)V99    VALUE ZERO.
005300     05  GRAND-TOTAL-THIS-YTD    PIC S9(7)V99    VALUE ZERO.
005400     05  GRAND-TOTAL-LAST-YTD    PIC S9(7)V99    VALUE ZERO.
005500*
005600 01  CURRENT-DATE-AND-TIME.
005700     05  CD-YEAR         PIC 9999.
005800     05  CD-MONTH        PIC 99.
005900     05  CD-DAY          PIC 99.
006000     05  CD-HOURS        PIC 99.
006100     05  CD-MINUTES      PIC 99.
006200     05  FILLER          PIC X(9).
006300*
006400 01  HEADING-LINE-1.
006500     05  FILLER          PIC X(7)    VALUE "DATE:  ".
006600     05  HL1-MONTH       PIC 9(2).
006700     05  FILLER          PIC X(1)    VALUE "/".
006800     05  HL1-DAY         PIC 9(2).
006900     05  FILLER          PIC X(1)    VALUE "/".
007000     05  HL1-YEAR        PIC 9(4).
007100     05  FILLER          PIC X(15)   VALUE SPACE.
007200     05  FILLER          PIC X(20)   VALUE "YEAR-TO-DATE SALES R".
007300     05  FILLER          PIC X(20)   VALUE "EPORT               ".
007400     05  FILLER          PIC X(12)   VALUE "      PAGE: ".
007500     05  HL1-PAGE-NUMBER PIC ZZZ9.
007600     05  FILLER          PIC X(44)   VALUE SPACE.
007700*
007800 01  HEADING-LINE-2.
007900     05  FILLER          PIC X(7)    VALUE "TIME:  ".
008000     05  HL2-HOURS       PIC 9(2).
008100     05  FILLER          PIC X(1)    VALUE ":".
008200     05  HL2-MINUTES     PIC 9(2).
008300     05  FILLER          PIC X(66)   VALUE SPACE.
008400     05  FILLER          PIC X(10)   VALUE "RPT3000".
008500     05  FILLER          PIC X(44)   VALUE SPACE.
008600*
008700 01  HEADING-LINE-3.
008800     05  FILLER      PIC X(8)    VALUE "BRANCH  ".
008900     05  FILLER      PIC X(20)   VALUE "CUST                ".
009000     05  FILLER      PIC X(20)   VALUE "            SALES   ".
009100     05  FILLER      PIC X(20)   VALUE "      SALES         ".
009200     05  FILLER      PIC X(20)   VALUE "CHANGE     CHANGE   ".
009300     05  FILLER      PIC X(44)   VALUE SPACE.
009400*
009500 01  HEADING-LINE-4.
009600     05  FILLER      PIC X(8)    VALUE " NUM    ".
009700     05  FILLER      PIC X(20)   VALUE "NUM    CUSTOMER NAME".
009800     05  FILLER      PIC X(20)   VALUE "           THIS YTD ".
009900     05  FILLER      PIC X(20)   VALUE "     LAST YTD       ".
010000     05  FILLER      PIC X(20)   VALUE "AMOUNT    PERCENT   ".
010100     05  FILLER      PIC X(44)   VALUE SPACE.
010200*
010300 01  CUSTOMER-LINE.
010400     05  FILLER               PIC X(2)       VALUE SPACE.
010500     05  CL-BRANCH-NUMBER     PIC X(2).
010600     05  FILLER               PIC X(4)       VALUE SPACE.
010700     05  CL-CUSTOMER-NUMBER   PIC 9(5).
010800     05  FILLER               PIC X(2)       VALUE SPACE.
010900     05  CL-CUSTOMER-NAME     PIC X(20).
011000     05  FILLER               PIC X(3)       VALUE SPACE.
011100     05  CL-SALES-THIS-YTD    PIC ZZ,ZZ9.99-.
011200     05  FILLER               PIC X(4)       VALUE SPACE.
011300     05  CL-SALES-LAST-YTD    PIC ZZ,ZZ9.99-.
011400     05  FILLER               PIC X(4)       VALUE SPACE.
011500     05  CL-CHANGE-AMOUNT     PIC ZZ,ZZ9.99-.
011600     05  FILLER               PIC X(3)       VALUE SPACE.
011700     05  CL-CHANGE-PERCENT    PIC ZZ9.9-.
011800     05  FILLER               PIC X(47)      VALUE SPACE.
011900*
012000 01  BRANCH-TOTAL-LINE.
012100     05  FILLER               PIC X(23)      VALUE SPACE.
012200     05  FILLER               PIC X(14)      VALUE "BRANCH TOTAL".
012300     05  BTL-SALES-THIS-YTD   PIC ZZZ,ZZ9.99-.
012400     05  FILLER               PIC X(3)       VALUE SPACE.
012500     05  BTL-SALES-LAST-YTD   PIC ZZZ,ZZ9.99-.
012600     05  FILLER               PIC X(3)       VALUE SPACE.
012700     05  BTL-CHANGE-AMOUNT    PIC ZZZ,ZZ9.99-.
012800     05  FILLER               PIC X(3)       VALUE SPACE.
012900     05  BTL-CHANGE-PERCENT   PIC ZZ9.9-.
013000     05  FILLER               PIC X(47)      VALUE " *".
013100*
013200 01  GRAND-TOTAL-LINE.
013300     05  FILLER               PIC X(23)      VALUE SPACE.
013400     05  FILLER               PIC X(12)      VALUE "GRAND TOTAL".
013500     05  GTL-SALES-THIS-YTD   PIC Z,ZZZ,ZZ9.99-.
013600     05  FILLER               PIC X(1)       VALUE SPACE.
013700     05  GTL-SALES-LAST-YTD   PIC Z,ZZZ,ZZ9.99-.
013800     05  FILLER               PIC X(1)       VALUE SPACE.
013900     05  GTL-CHANGE-AMOUNT    PIC Z,ZZZ,ZZ9.99-.
014000     05  FILLER               PIC X(3)       VALUE SPACE.
014100     05  GTL-CHANGE-PERCENT   PIC ZZ9.9-.
014200     05  FILLER               PIC X(47)      VALUE " **".
014300*
014400 PROCEDURE DIVISION.
014500*
014600 000-PREPARE-SALES-REPORT.
014700*
014800     OPEN INPUT  CUSTMAST
014900          OUTPUT SALESRPT.
015000     PERFORM 100-FORMAT-REPORT-HEADING.
015100     PERFORM 300-PREPARE-SALES-LINES
015200         UNTIL CUSTMAST-EOF-SWITCH = "Y".
015300     PERFORM 500-PRINT-GRAND-TOTALS.
015400     CLOSE CUSTMAST
015500           SALESRPT.
015600     STOP RUN.
015700*
015800 100-FORMAT-REPORT-HEADING.
015900*
016000     MOVE FUNCTION CURRENT-DATE TO CURRENT-DATE-AND-TIME.
016100     MOVE CD-MONTH   TO HL1-MONTH.
016200     MOVE CD-DAY     TO HL1-DAY.
016300     MOVE CD-YEAR    TO HL1-YEAR.
016400     MOVE CD-HOURS   TO HL2-HOURS.
016500     MOVE CD-MINUTES TO HL2-MINUTES.
016600*
016700 300-PREPARE-SALES-LINES.
016800*
016900     PERFORM 310-READ-CUSTOMER-RECORD.
017000     IF CUSTMAST-EOF-SWITCH = "N"
017100         IF FIRST-RECORD-SWITCH = "Y"
017200             PERFORM 320-PRINT-CUSTOMER-LINE
017300             MOVE "N" TO FIRST-RECORD-SWITCH
017400             MOVE CM-BRANCH-NUMBER TO OLD-BRANCH-NUMBER
017500         ELSE
017600             IF CM-BRANCH-NUMBER > OLD-BRANCH-NUMBER
017700                 PERFORM 360-PRINT-BRANCH-LINE
017800                 PERFORM 320-PRINT-CUSTOMER-LINE
017900                 MOVE CM-BRANCH-NUMBER TO OLD-BRANCH-NUMBER
018000             ELSE
018100                 PERFORM 320-PRINT-CUSTOMER-LINE
018200     ELSE
018300         PERFORM 360-PRINT-BRANCH-LINE.
018400*
018500 310-READ-CUSTOMER-RECORD.
018600*
018700     READ CUSTMAST
018800         AT END
018900             MOVE "Y" TO CUSTMAST-EOF-SWITCH.
019000*
019100 320-PRINT-CUSTOMER-LINE.
019200*
019300     IF LINE-COUNT > LINES-ON-PAGE
019400         PERFORM 330-PRINT-HEADING-LINES.
019500     IF FIRST-RECORD-SWITCH = "Y"
019600         MOVE CM-BRANCH-NUMBER TO CL-BRANCH-NUMBER
019700     ELSE
019800         IF CM-BRANCH-NUMBER > OLD-BRANCH-NUMBER
019900             MOVE CM-BRANCH-NUMBER TO CL-BRANCH-NUMBER
020000         ELSE
020100             MOVE SPACE TO CL-BRANCH-NUMBER.
020200     MOVE CM-CUSTOMER-NUMBER   TO CL-CUSTOMER-NUMBER.
020300     MOVE CM-CUSTOMER-NAME     TO CL-CUSTOMER-NAME.
020400     MOVE CM-SALES-THIS-YTD    TO CL-SALES-THIS-YTD.
020500     MOVE CM-SALES-LAST-YTD    TO CL-SALES-LAST-YTD.
020600     COMPUTE CHANGE-AMOUNT =
020700         CM-SALES-THIS-YTD - CM-SALES-LAST-YTD.
020800     MOVE CHANGE-AMOUNT TO CL-CHANGE-AMOUNT.
020900     IF CM-SALES-LAST-YTD = ZERO
021000         MOVE 999.9 TO CL-CHANGE-PERCENT
021100     ELSE
021200         COMPUTE CL-CHANGE-PERCENT ROUNDED =
021300             CHANGE-AMOUNT * 100 / CM-SALES-LAST-YTD
021400             ON SIZE ERROR
021500                 MOVE 999.9 TO CL-CHANGE-PERCENT.
021600     MOVE CUSTOMER-LINE TO PRINT-AREA.
021700     PERFORM 350-WRITE-REPORT-LINE.
021800     MOVE 1 TO SPACE-CONTROL.
021900     ADD CM-SALES-THIS-YTD TO BRANCH-TOTAL-THIS-YTD.
022000     ADD CM-SALES-LAST-YTD TO BRANCH-TOTAL-LAST-YTD.
022100*
022200 330-PRINT-HEADING-LINES.
022300*
022400     ADD 1 TO PAGE-COUNT.
022500     MOVE PAGE-COUNT     TO HL1-PAGE-NUMBER.
022600     MOVE HEADING-LINE-1 TO PRINT-AREA.
022700     PERFORM 340-WRITE-PAGE-TOP-LINE.
022800     MOVE HEADING-LINE-2 TO PRINT-AREA.
022900     MOVE 1 TO SPACE-CONTROL.
023000     PERFORM 350-WRITE-REPORT-LINE.
023100     MOVE HEADING-LINE-3 TO PRINT-AREA.
023200     MOVE 2 TO SPACE-CONTROL.
023300     PERFORM 350-WRITE-REPORT-LINE.
023400     MOVE HEADING-LINE-4 TO PRINT-AREA.
023500     MOVE 1 TO SPACE-CONTROL.
023600     PERFORM 350-WRITE-REPORT-LINE.
023700     MOVE 2 TO SPACE-CONTROL.
023800*
023900 340-WRITE-PAGE-TOP-LINE.
024000*
024100     WRITE PRINT-AREA AFTER ADVANCING PAGE.
024200     MOVE 1 TO LINE-COUNT.
024300*
024400 350-WRITE-REPORT-LINE.
024500*
024600     WRITE PRINT-AREA AFTER ADVANCING SPACE-CONTROL LINES.
024700     ADD SPACE-CONTROL TO LINE-COUNT.
024800*
024900 360-PRINT-BRANCH-LINE.
025000*
025100     MOVE BRANCH-TOTAL-THIS-YTD TO BTL-SALES-THIS-YTD.
025200     MOVE BRANCH-TOTAL-LAST-YTD TO BTL-SALES-LAST-YTD.
025300     COMPUTE CHANGE-AMOUNT =
025400         BRANCH-TOTAL-THIS-YTD - BRANCH-TOTAL-LAST-YTD.
025500     MOVE CHANGE-AMOUNT TO BTL-CHANGE-AMOUNT.
025600     IF BRANCH-TOTAL-LAST-YTD = ZERO
025700         MOVE 999.9 TO BTL-CHANGE-PERCENT
025800     ELSE
025900         COMPUTE BTL-CHANGE-PERCENT ROUNDED =
026000             CHANGE-AMOUNT * 100 / BRANCH-TOTAL-LAST-YTD
026100             ON SIZE ERROR
026200                 MOVE 999.9 TO BTL-CHANGE-PERCENT.
026300     MOVE BRANCH-TOTAL-LINE TO PRINT-AREA.
026400     MOVE 1 TO SPACE-CONTROL.
026500     PERFORM 350-WRITE-REPORT-LINE.
026600     MOVE 2 TO SPACE-CONTROL.
026700     ADD BRANCH-TOTAL-THIS-YTD TO GRAND-TOTAL-THIS-YTD.
026800     ADD BRANCH-TOTAL-LAST-YTD TO GRAND-TOTAL-LAST-YTD.
026900     MOVE ZERO TO BRANCH-TOTAL-THIS-YTD.
027000     MOVE ZERO TO BRANCH-TOTAL-LAST-YTD.
027100*
027200 500-PRINT-GRAND-TOTALS.
027300*
027400     MOVE GRAND-TOTAL-THIS-YTD TO GTL-SALES-THIS-YTD.
027500     MOVE GRAND-TOTAL-LAST-YTD TO GTL-SALES-LAST-YTD.
027600     COMPUTE CHANGE-AMOUNT =
027700         GRAND-TOTAL-THIS-YTD - GRAND-TOTAL-LAST-YTD.
027800     MOVE CHANGE-AMOUNT TO GTL-CHANGE-AMOUNT.
027900     IF GRAND-TOTAL-LAST-YTD = ZERO
028000         MOVE 999.9 TO GTL-CHANGE-PERCENT
028100     ELSE
028200         COMPUTE GTL-CHANGE-PERCENT ROUNDED =
028300             CHANGE-AMOUNT * 100 / GRAND-TOTAL-LAST-YTD
028400             ON SIZE ERROR
028500                 MOVE 999.9 TO GTL-CHANGE-PERCENT.
028600     MOVE GRAND-TOTAL-LINE TO PRINT-AREA.
028700     MOVE 2 TO SPACE-CONTROL.
028800     PERFORM 350-WRITE-REPORT-LINE.
./ ADD NAME=RPT5000C 0101-01302-01302-1145-00346-00346-00000-BC0THOR
000100 IDENTIFICATION DIVISION.
000200*
000300 PROGRAM-ID. RPT5000C.
000400*
000500 ENVIRONMENT DIVISION.
000600*
000700 INPUT-OUTPUT SECTION.
000800*
000900 FILE-CONTROL.
001000*
001100     SELECT CUSTMAST ASSIGN TO CUSTMAST.
001200     SELECT SALESRPT ASSIGN TO SALESRPT.
001300*
001400 DATA DIVISION.
001500*
001600 FILE SECTION.
001700*
001800 FD  CUSTMAST.
001900*
002000 01  CUSTOMER-MASTER-RECORD.
002100     05  CM-BRANCH-NUMBER        PIC 9(2).
002200     05  CM-SALESREP-NUMBER      PIC 9(2).
002300     05  CM-CUSTOMER-NUMBER      PIC 9(5).
002400     05  CM-CUSTOMER-NAME        PIC X(20).
002500     05  CM-SALES-THIS-YTD       PIC S9(5)V9(2).
002600     05  CM-SALES-LAST-YTD       PIC S9(5)V9(2).
002700*
002800 FD  SALESRPT.
002900*
003000 01  PRINT-AREA      PIC X(132).
003100*
003200 WORKING-STORAGE SECTION.
003300*
003400 01  SWITCHES.
003500     05  CUSTMAST-EOF-SWITCH     PIC X   VALUE "N".
003600         88  CUSTMAST-EOF                VALUE "Y".
003700     05  FIRST-RECORD-SWITCH     PIC X   VALUE "Y".
003800         88  FIRST-RECORD                VALUE "Y".
003900*
004000 01  CONTROL-FIELDS.
004100     05  OLD-BRANCH-NUMBER       PIC 9(2).
004200     05  OLD-SALESREP-NUMBER     PIC 9(2).
004300*
004400 01  CALCULATED-FIELDS.
004500     05  CHANGE-AMOUNT           PIC S9(7)V99.
004600*
004700 01  PRINT-FIELDS.
004800     05  PAGE-COUNT      PIC S9(3)   VALUE ZERO.
004900     05  LINES-ON-PAGE   PIC S9(3)   VALUE +55.
005000     05  LINE-COUNT      PIC S9(3)   VALUE +99.
005100     05  SPACE-CONTROL   PIC S9.
005200*
005300 01  TOTAL-FIELDS.
005400     05  SALESREP-TOTAL-THIS-YTD PIC S9(6)V99    VALUE ZERO.
005500     05  SALESREP-TOTAL-LAST-YTD PIC S9(6)V99    VALUE ZERO.
005600     05  BRANCH-TOTAL-THIS-YTD   PIC S9(6)V99    VALUE ZERO.
005700     05  BRANCH-TOTAL-LAST-YTD   PIC S9(6)V99    VALUE ZERO.
005800     05  GRAND-TOTAL-THIS-YTD    PIC S9(7)V99    VALUE ZERO.
005900     05  GRAND-TOTAL-LAST-YTD    PIC S9(7)V99    VALUE ZERO.
006000*
006100 01  CURRENT-DATE-AND-TIME.
006200     05  CD-YEAR         PIC 9999.
006300     05  CD-MONTH        PIC 99.
006400     05  CD-DAY          PIC 99.
006500     05  CD-HOURS        PIC 99.
006600     05  CD-MINUTES      PIC 99.
006700     05  FILLER          PIC X(9).
006800*
006900 01  HEADING-LINE-1.
007000     05  FILLER          PIC X(7)    VALUE "DATE:  ".
007100     05  HL1-MONTH       PIC 9(2).
007200     05  FILLER          PIC X(1)    VALUE "/".
007300     05  HL1-DAY         PIC 9(2).
007400     05  FILLER          PIC X(1)    VALUE "/".
007500     05  HL1-YEAR        PIC 9(4).
007600     05  FILLER          PIC X(18)   VALUE SPACE.
007700     05  FILLER          PIC X(20)   VALUE "YEAR-TO-DATE SALES R".
007800     05  FILLER          PIC X(20)   VALUE "EPORT               ".
007900     05  FILLER          PIC X(15)   VALUE "         PAGE: ".
008000     05  HL1-PAGE-NUMBER PIC ZZZ9.
008100     05  FILLER          PIC X(37)   VALUE SPACE.
008200*
008300 01  HEADING-LINE-2.
008400     05  FILLER          PIC X(7)    VALUE "TIME:  ".
008500     05  HL2-HOURS       PIC 9(2).
008600     05  FILLER          PIC X(1)    VALUE ":".
008700     05  HL2-MINUTES     PIC 9(2).
008800     05  FILLER          PIC X(72)   VALUE SPACE.
008900     05  FILLER          PIC X(8)    VALUE "RPT5000".
009000     05  FILLER          PIC X(39)   VALUE SPACE.
009100*
009200 01  HEADING-LINE-3.
009300     05  FILLER      PIC X(20)   VALUE "BRCH  SLSREP  CUST  ".
009400     05  FILLER      PIC X(20)   VALUE SPACE.
009500     05  FILLER      PIC X(14)   VALUE "      SALES  ".
009600     05  FILLER      PIC X(20)   VALUE "      SALES         ".
009700     05  FILLER      PIC X(20)   VALUE "CHANGE     CHANGE   ".
009800     05  FILLER      PIC X(38)   VALUE SPACE.
009900*
010000 01  HEADING-LINE-4.
010100     05  FILLER      PIC X(20)   VALUE "NUM    NUM     NUM  ".
010200     05  FILLER      PIC X(20)   VALUE " CUSTOMER NAME      ".
010300     05  FILLER      PIC X(14)   VALUE "     THIS YTD".
010400     05  FILLER      PIC X(20)   VALUE "     LAST YTD       ".
010500     05  FILLER      PIC X(20)   VALUE "AMOUNT    PERCENT   ".
010600     05  FILLER      PIC X(38)   VALUE SPACE.
010700*
010800 01  CUSTOMER-LINE.
010900     05  FILLER               PIC X(1)       VALUE SPACE.
011000     05  CL-BRANCH-NUMBER     PIC X(2).
011100     05  FILLER               PIC X(5)       VALUE SPACE.
011200     05  CL-SALESREP-NUMBER   PIC X(2).
011300     05  FILLER               PIC X(4)       VALUE SPACE.
011400     05  CL-CUSTOMER-NUMBER   PIC 9(5).
011500     05  FILLER               PIC X(2)       VALUE SPACE.
011600     05  CL-CUSTOMER-NAME     PIC X(20).
011700     05  FILLER               PIC X(3)       VALUE SPACE.
011800     05  CL-SALES-THIS-YTD    PIC ZZ,ZZ9.99-.
011900     05  FILLER               PIC X(4)       VALUE SPACE.
012000     05  CL-SALES-LAST-YTD    PIC ZZ,ZZ9.99-.
012100     05  FILLER               PIC X(4)       VALUE SPACE.
012200     05  CL-CHANGE-AMOUNT     PIC ZZ,ZZ9.99-.
012300     05  FILLER               PIC X(3)       VALUE SPACE.
012400     05  CL-CHANGE-PERCENT    PIC ZZ9.9-.
012500     05  FILLER               PIC X(41)      VALUE SPACE.
012600*
012700 01  SALESREP-TOTAL-LINE.
012800     05  FILLER               PIC X(27)      VALUE SPACE.
012900     05  FILLER               PIC X(9)       VALUE "SALESREP ".
013000     05  FILLER               PIC X(7)       VALUE "TOTAL  ".
013100     05  STL-SALES-THIS-YTD   PIC ZZZ,ZZ9.99-.
013200     05  FILLER               PIC X(3)       VALUE SPACE.
013300     05  STL-SALES-LAST-YTD   PIC ZZZ,ZZ9.99-.
013400     05  FILLER               PIC X(3)       VALUE SPACE.
013500     05  STL-CHANGE-AMOUNT    PIC ZZZ,ZZ9.99-.
013600     05  FILLER               PIC X(3)       VALUE SPACE.
013700     05  STL-CHANGE-PERCENT   PIC ZZ9.9-.
013800     05  FILLER               PIC X(41)      VALUE " *".
013900*
014000 01  BRANCH-TOTAL-LINE.
014100     05  FILLER               PIC X(27)      VALUE SPACE.
014200     05  FILLER               PIC X(16)      VALUE "BRANCH TOTAL".
014300     05  BTL-SALES-THIS-YTD   PIC ZZZ,ZZ9.99-.
014400     05  FILLER               PIC X(3)       VALUE SPACE.
014500     05  BTL-SALES-LAST-YTD   PIC ZZZ,ZZ9.99-.
014600     05  FILLER               PIC X(3)       VALUE SPACE.
014700     05  BTL-CHANGE-AMOUNT    PIC ZZZ,ZZ9.99-.
014800     05  FILLER               PIC X(3)       VALUE SPACE.
014900     05  BTL-CHANGE-PERCENT   PIC ZZ9.9-.
015000     05  FILLER               PIC X(41)      VALUE " **".
015100*
015200 01  GRAND-TOTAL-LINE.
015300     05  FILLER               PIC X(27)      VALUE SPACE.
015400     05  FILLER               PIC X(14)      VALUE "GRAND TOTAL".
015500     05  GTL-SALES-THIS-YTD   PIC Z,ZZZ,ZZ9.99-.
015600     05  FILLER               PIC X(1)       VALUE SPACE.
015700     05  GTL-SALES-LAST-YTD   PIC Z,ZZZ,ZZ9.99-.
015800     05  FILLER               PIC X(1)       VALUE SPACE.
015900     05  GTL-CHANGE-AMOUNT    PIC Z,ZZZ,ZZ9.99-.
016000     05  FILLER               PIC X(3)       VALUE SPACE.
016100     05  GTL-CHANGE-PERCENT   PIC ZZ9.9-.
016200     05  FILLER               PIC X(41)      VALUE " ***".
016300*
016400 PROCEDURE DIVISION.
016500*
016600 000-PREPARE-SALES-REPORT.
016700*
016800     OPEN INPUT  CUSTMAST
016900          OUTPUT SALESRPT.
017000     PERFORM 100-FORMAT-REPORT-HEADING.
017100     PERFORM 300-PREPARE-SALES-LINES
017200         WITH TEST AFTER
017300         UNTIL CUSTMAST-EOF.
017400     PERFORM 500-PRINT-GRAND-TOTALS.
017500     CLOSE CUSTMAST
017600           SALESRPT.
017700     STOP RUN.
017800*
017900 100-FORMAT-REPORT-HEADING.
018000*
018100     MOVE FUNCTION CURRENT-DATE TO CURRENT-DATE-AND-TIME.
018200     MOVE CD-MONTH   TO HL1-MONTH.
018300     MOVE CD-DAY     TO HL1-DAY.
018400     MOVE CD-YEAR    TO HL1-YEAR.
018500     MOVE CD-HOURS   TO HL2-HOURS.
018600     MOVE CD-MINUTES TO HL2-MINUTES.
018700*
018800 300-PREPARE-SALES-LINES.
018900*
019000     PERFORM 310-READ-CUSTOMER-RECORD.
019100     EVALUATE TRUE
019200         WHEN CUSTMAST-EOF
019300             PERFORM 355-PRINT-SALESREP-LINE
019400             PERFORM 360-PRINT-BRANCH-LINE
019500         WHEN FIRST-RECORD
019600             PERFORM 320-PRINT-CUSTOMER-LINE
019700             MOVE "N" TO FIRST-RECORD-SWITCH
019800             MOVE CM-SALESREP-NUMBER TO OLD-SALESREP-NUMBER
019900             MOVE CM-BRANCH-NUMBER TO OLD-BRANCH-NUMBER
020000         WHEN CM-BRANCH-NUMBER > OLD-BRANCH-NUMBER
020100             PERFORM 355-PRINT-SALESREP-LINE
020200             PERFORM 360-PRINT-BRANCH-LINE
020300             PERFORM 320-PRINT-CUSTOMER-LINE
020400             MOVE CM-SALESREP-NUMBER TO OLD-SALESREP-NUMBER
020500             MOVE CM-BRANCH-NUMBER TO OLD-BRANCH-NUMBER
020600         WHEN CM-SALESREP-NUMBER > OLD-SALESREP-NUMBER
020700             PERFORM 355-PRINT-SALESREP-LINE
020800             PERFORM 320-PRINT-CUSTOMER-LINE
020900             MOVE CM-SALESREP-NUMBER TO OLD-SALESREP-NUMBER
021000         WHEN OTHER
021100             PERFORM 320-PRINT-CUSTOMER-LINE
021200     END-EVALUATE.
021300*
021400 310-READ-CUSTOMER-RECORD.
021500*
021600     READ CUSTMAST
021700         AT END
021800             SET CUSTMAST-EOF TO TRUE.
021900*
022000 320-PRINT-CUSTOMER-LINE.
022100*
022200     IF LINE-COUNT > LINES-ON-PAGE
022300         PERFORM 330-PRINT-HEADING-LINES.
022400     EVALUATE TRUE
022500         WHEN FIRST-RECORD
022600             MOVE CM-SALESREP-NUMBER TO CL-SALESREP-NUMBER
022700             MOVE CM-BRANCH-NUMBER TO CL-BRANCH-NUMBER
022800         WHEN CM-BRANCH-NUMBER > OLD-BRANCH-NUMBER
022900             MOVE CM-SALESREP-NUMBER TO CL-SALESREP-NUMBER
023000             MOVE CM-BRANCH-NUMBER TO CL-BRANCH-NUMBER
023100         WHEN CM-SALESREP-NUMBER > OLD-SALESREP-NUMBER
023200             MOVE CM-SALESREP-NUMBER TO CL-SALESREP-NUMBER
023300             MOVE SPACE TO CL-BRANCH-NUMBER
023400         WHEN OTHER
023500             MOVE SPACE TO CL-SALESREP-NUMBER
023600             MOVE SPACE TO CL-BRANCH-NUMBER
023700     END-EVALUATE.
023800     MOVE CM-CUSTOMER-NUMBER   TO CL-CUSTOMER-NUMBER.
023900     MOVE CM-CUSTOMER-NAME     TO CL-CUSTOMER-NAME.
024000     MOVE CM-SALES-THIS-YTD    TO CL-SALES-THIS-YTD.
024100     MOVE CM-SALES-LAST-YTD    TO CL-SALES-LAST-YTD.
024200     COMPUTE CHANGE-AMOUNT =
024300         CM-SALES-THIS-YTD - CM-SALES-LAST-YTD.
024400     MOVE CHANGE-AMOUNT TO CL-CHANGE-AMOUNT.
024500     IF CM-SALES-LAST-YTD = ZERO
024600         MOVE 999.9 TO CL-CHANGE-PERCENT
024700     ELSE
024800         COMPUTE CL-CHANGE-PERCENT ROUNDED =
024900             CHANGE-AMOUNT * 100 / CM-SALES-LAST-YTD
025000             ON SIZE ERROR
025100                 MOVE 999.9 TO CL-CHANGE-PERCENT.
025200     MOVE CUSTOMER-LINE TO PRINT-AREA.
025300     PERFORM 350-WRITE-REPORT-LINE.
025400     MOVE 1 TO SPACE-CONTROL.
025500     ADD CM-SALES-THIS-YTD TO SALESREP-TOTAL-THIS-YTD.
025600     ADD CM-SALES-LAST-YTD TO SALESREP-TOTAL-LAST-YTD.
025700     ADD CM-SALES-THIS-YTD TO BRANCH-TOTAL-THIS-YTD.
025800     ADD CM-SALES-LAST-YTD TO BRANCH-TOTAL-LAST-YTD.
025900*
026000 330-PRINT-HEADING-LINES.
026100*
026200     ADD 1 TO PAGE-COUNT.
026300     MOVE PAGE-COUNT     TO HL1-PAGE-NUMBER.
026400     MOVE HEADING-LINE-1 TO PRINT-AREA.
026500     PERFORM 340-WRITE-PAGE-TOP-LINE.
026600     MOVE HEADING-LINE-2 TO PRINT-AREA.
026700     MOVE 1 TO SPACE-CONTROL.
026800     PERFORM 350-WRITE-REPORT-LINE.
026900     MOVE HEADING-LINE-3 TO PRINT-AREA.
027000     MOVE 2 TO SPACE-CONTROL.
027100     PERFORM 350-WRITE-REPORT-LINE.
027200     MOVE HEADING-LINE-4 TO PRINT-AREA.
027300     MOVE 1 TO SPACE-CONTROL.
027400     PERFORM 350-WRITE-REPORT-LINE.
027500     MOVE 2 TO SPACE-CONTROL.
027600*
027700 340-WRITE-PAGE-TOP-LINE.
027800*
027900     WRITE PRINT-AREA AFTER ADVANCING PAGE.
028000     MOVE 1 TO LINE-COUNT.
028100*
028200 350-WRITE-REPORT-LINE.
028300*
028400     WRITE PRINT-AREA AFTER ADVANCING SPACE-CONTROL LINES.
028500     ADD SPACE-CONTROL TO LINE-COUNT.
028600*
028700 355-PRINT-SALESREP-LINE.
028800*
028900     MOVE SALESREP-TOTAL-THIS-YTD TO STL-SALES-THIS-YTD.
029000     MOVE SALESREP-TOTAL-LAST-YTD TO STL-SALES-LAST-YTD.
029100     COMPUTE CHANGE-AMOUNT =
029200         SALESREP-TOTAL-THIS-YTD - SALESREP-TOTAL-LAST-YTD.
029300     MOVE CHANGE-AMOUNT TO STL-CHANGE-AMOUNT.
029400     IF SALESREP-TOTAL-LAST-YTD = ZERO
029500         MOVE 999.9 TO STL-CHANGE-PERCENT
029600     ELSE
029700         COMPUTE STL-CHANGE-PERCENT ROUNDED =
029800             CHANGE-AMOUNT * 100 / SALESREP-TOTAL-LAST-YTD
029900             ON SIZE ERROR
030000                 MOVE 999.9 TO STL-CHANGE-PERCENT.
030100     MOVE SALESREP-TOTAL-LINE TO PRINT-AREA.
030200     MOVE 1 TO SPACE-CONTROL.
030300     PERFORM 350-WRITE-REPORT-LINE.
030400     MOVE 2 TO SPACE-CONTROL.
030500     MOVE ZERO TO SALESREP-TOTAL-THIS-YTD.
030600     MOVE ZERO TO SALESREP-TOTAL-LAST-YTD.
030700*
030800 360-PRINT-BRANCH-LINE.
030900*
031000     MOVE BRANCH-TOTAL-THIS-YTD TO BTL-SALES-THIS-YTD.
031100     MOVE BRANCH-TOTAL-LAST-YTD TO BTL-SALES-LAST-YTD.
031200     COMPUTE CHANGE-AMOUNT =
031300         BRANCH-TOTAL-THIS-YTD - BRANCH-TOTAL-LAST-YTD.
031400     MOVE CHANGE-AMOUNT TO BTL-CHANGE-AMOUNT.
031500     IF BRANCH-TOTAL-LAST-YTD = ZERO
031600         MOVE 999.9 TO BTL-CHANGE-PERCENT
031700     ELSE
031800         COMPUTE BTL-CHANGE-PERCENT ROUNDED =
031900             CHANGE-AMOUNT * 100 / BRANCH-TOTAL-LAST-YTD
032000             ON SIZE ERROR
032100                 MOVE 999.9 TO BTL-CHANGE-PERCENT.
032200     MOVE BRANCH-TOTAL-LINE TO PRINT-AREA.
032300     MOVE 2 TO SPACE-CONTROL.
032400     PERFORM 350-WRITE-REPORT-LINE.
032500     ADD BRANCH-TOTAL-THIS-YTD TO GRAND-TOTAL-THIS-YTD.
032600     ADD BRANCH-TOTAL-LAST-YTD TO GRAND-TOTAL-LAST-YTD.
032700     MOVE ZERO TO BRANCH-TOTAL-THIS-YTD.
032800     MOVE ZERO TO BRANCH-TOTAL-LAST-YTD.
032900*
033000 500-PRINT-GRAND-TOTALS.
033100*
033200     MOVE GRAND-TOTAL-THIS-YTD TO GTL-SALES-THIS-YTD.
033300     MOVE GRAND-TOTAL-LAST-YTD TO GTL-SALES-LAST-YTD.
033400     COMPUTE CHANGE-AMOUNT =
033500         GRAND-TOTAL-THIS-YTD - GRAND-TOTAL-LAST-YTD.
033600     MOVE CHANGE-AMOUNT TO GTL-CHANGE-AMOUNT.
033700     IF GRAND-TOTAL-LAST-YTD = ZERO
033800         MOVE 999.9 TO GTL-CHANGE-PERCENT
033900     ELSE
034000         COMPUTE GTL-CHANGE-PERCENT ROUNDED =
034100             CHANGE-AMOUNT * 100 / GRAND-TOTAL-LAST-YTD
034200             ON SIZE ERROR
034300                 MOVE 999.9 TO GTL-CHANGE-PERCENT.
034400     MOVE GRAND-TOTAL-LINE TO PRINT-AREA.
034500     MOVE 2 TO SPACE-CONTROL.
034600     PERFORM 350-WRITE-REPORT-LINE.
./ ADD NAME=SEQ1000C 0104-01302-01311-1322-00151-00146-00000-BC0THOR
000100 IDENTIFICATION DIVISION.
000200*
000300 PROGRAM-ID.  SEQ1000C.
000400*
000500 ENVIRONMENT DIVISION.
000600*
000700 INPUT-OUTPUT SECTION.
000800*
000900 FILE-CONTROL.
001000
001100     SELECT RCTTRAN  ASSIGN TO RCTTRAN.
001300     SELECT OLDMAST  ASSIGN TO OLDMAST.
001500     SELECT NEWMAST  ASSIGN TO NEWMAST
001700                     FILE STATUS IS NEWMAST-FILE-STATUS.
001800     SELECT ERRTRAN  ASSIGN TO ERRTRAN
002000                     FILE STATUS IS ERRTRAN-FILE-STATUS.
002100*
002200 DATA DIVISION.
002300*
002400 FILE SECTION.
002410
002500*
002600 FD  RCTTRAN
002610     RECORDING MODE IS F
002620     LABEL RECORDS ARE STANDARD.
002700*
002800 01  TRANSACTION-RECORD      PIC X(23).
002900*
003000 FD  OLDMAST
003010     RECORDING MODE IS F
003020     LABEL RECORDS ARE STANDARD.
003100*
003200 01  OLD-MASTER-RECORD       PIC X(70).
003300*
003400 FD  NEWMAST
003410     RECORDING MODE IS F
003420     LABEL RECORDS ARE STANDARD.
003500*
003600 01  NEW-MASTER-RECORD       PIC X(70).
003700*
003800 FD  ERRTRAN
003810     RECORDING MODE IS F
003820     LABEL RECORDS ARE STANDARD.
003900*
004000 01  ERROR-TRANSACTION       PIC X(23).
004100*
004200 WORKING-STORAGE SECTION.
004300*
004400 01  SWITCHES.
004500     05  FIRST-EXECUTION-SWITCH          PIC X   VALUE "Y".
004600         88  FIRST-EXECUTION                     VALUE "Y".
004700     05  ALL-RECORDS-PROCESSED-SWITCH    PIC X   VALUE "N".
004800         88  ALL-RECORDS-PROCESSED               VALUE "Y".
004900*
005000 01  FILE-STATUS-FIELDS.
005100     05  NEWMAST-FILE-STATUS     PIC XX.
005200         88  NEWMAST-SUCCESSFUL          VALUE "00".
005300     05  ERRTRAN-FILE-STATUS     PIC XX.
005400         88  ERRTRAN-SUCCESSFUL          VALUE "00".
005500*
005600 01  RECEIPT-TRANSACTION.
005700     05  RT-ITEM-NO              PIC X(5).
005800     05  RT-VENDOR-NO            PIC X(5).
005900     05  RT-RECEIPT-DATE         PIC X(8).
006000     05  RT-RECEIPT-QUANTITY     PIC S9(5).
006100*
006200 01  INVENTORY-MASTER-RECORD.
006300     05  IM-ITEM-NO              PIC X(5).
006400     05  IM-DESCRIPTIVE-DATA.
006500         10  IM-ITEM-DESC        PIC X(40).
006600         10  IM-UNIT-COST        PIC S9(3)V99.
006700         10  IM-UNIT-PRICE       PIC S9(3)V99.
006800     05  IM-INVENTORY-DATA.
006900         10  IM-REORDER-POINT    PIC S9(5).
007000         10  IM-ON-HAND          PIC S9(5).
007100         10  IM-ON-ORDER         PIC S9(5).
007200*
007300 PROCEDURE DIVISION.
007400*
007500 000-UPDATE-INVENTORY-MASTER.
007600*
007700     OPEN INPUT  RCTTRAN
007800                 OLDMAST
007900          OUTPUT NEWMAST
008000          EXTEND ERRTRAN.
008100     MOVE LOW-VALUE TO IM-ITEM-NO.
008200     PERFORM 300-PROCESS-RECEIPT-TRAN
008300         UNTIL ALL-RECORDS-PROCESSED.
008400     CLOSE RCTTRAN
008500           OLDMAST
008600           NEWMAST
008700           ERRTRAN.
008800     STOP RUN.
008900*
009000 300-PROCESS-RECEIPT-TRAN.
009100*
009200     PERFORM 310-READ-RECEIPT-TRANSACTION.
009300     PERFORM 320-PROCESS-INVENTORY-MASTER
009400         UNTIL IM-ITEM-NO >= RT-ITEM-NO.
009500     IF      IM-ITEM-NO = HIGH-VALUE
009600         AND RT-ITEM-NO = HIGH-VALUE
009700         MOVE "Y" TO ALL-RECORDS-PROCESSED-SWITCH
009800     ELSE
009900         IF IM-ITEM-NO = RT-ITEM-NO
010000             PERFORM 350-APPLY-RECEIPT-TRANSACTION
010100         ELSE
010200             PERFORM 360-WRITE-ERROR-TRANSACTION.
010300*
010400 310-READ-RECEIPT-TRANSACTION.
010500*
010600     READ RCTTRAN INTO RECEIPT-TRANSACTION
010700         AT END
010800             MOVE HIGH-VALUE TO RT-ITEM-NO.
010900*
011000 320-PROCESS-INVENTORY-MASTER.
011100*
011200     IF FIRST-EXECUTION
011300         PERFORM 330-READ-OLD-MASTER
011400         MOVE "N" TO FIRST-EXECUTION-SWITCH
011500     ELSE
011600         PERFORM 340-WRITE-NEW-MASTER
011700         PERFORM 330-READ-OLD-MASTER.
011800*
011900 330-READ-OLD-MASTER.
012000*
012100     READ OLDMAST INTO INVENTORY-MASTER-RECORD
012200         AT END
012300             MOVE HIGH-VALUE TO IM-ITEM-NO.
012400*
012500 340-WRITE-NEW-MASTER.
012600*
012700     WRITE NEW-MASTER-RECORD FROM INVENTORY-MASTER-RECORD.
012800     IF NOT NEWMAST-SUCCESSFUL
012900         DISPLAY "WRITE ERROR ON NEWMAST FOR ITEM NUMBER "
013000             IM-ITEM-NO
013100         DISPLAY "FILE STATUS CODE IS " NEWMAST-FILE-STATUS
013200         MOVE "Y" TO ALL-RECORDS-PROCESSED-SWITCH.
013300*
013400 350-APPLY-RECEIPT-TRANSACTION.
013500*
013600     ADD RT-RECEIPT-QUANTITY TO IM-ON-HAND.
013700     SUBTRACT RT-RECEIPT-QUANTITY FROM IM-ON-ORDER.
013800*
013900 360-WRITE-ERROR-TRANSACTION.
014000*
014100     WRITE ERROR-TRANSACTION FROM RECEIPT-TRANSACTION.
014200     IF NOT ERRTRAN-SUCCESSFUL
014300         DISPLAY "WRITE ERROR ON ERRTRAN FOR ITEM NUMBER "
014400             RT-ITEM-NO
014500         DISPLAY "FILE STATUS CODE IS " ERRTRAN-FILE-STATUS
014600         MOVE "Y" TO ALL-RECORDS-PROCESSED-SWITCH.
./ ADD NAME=SEQ2000C 0101-01302-01302-1149-00213-00213-00000-BC0THOR
000100 IDENTIFICATION DIVISION.
000200*
000300 PROGRAM-ID.  SEQ2000C.
000400*
000500 ENVIRONMENT DIVISION.
000600*
000700 INPUT-OUTPUT SECTION.
000800*
000900 FILE-CONTROL.
001000
001100     SELECT MNTTRAN  ASSIGN TO MNTTRAN.
001200     SELECT OLDMAST  ASSIGN TO OLDMAST.
001300     SELECT NEWMAST  ASSIGN TO NEWMAST
001400                     FILE STATUS IS NEWMAST-FILE-STATUS.
001500     SELECT ERRTRAN  ASSIGN TO ERRTRAN
001600                     FILE STATUS IS ERRTRAN-FILE-STATUS.
001700*
001800 DATA DIVISION.
001900*
002000 FILE SECTION.
002100*
002200 FD  MNTTRAN.
002300*
002400 01  TRANSACTION-RECORD      PIC X(61).
002500*
002600 FD  OLDMAST.
002700*
002800 01  OLD-MASTER-RECORD       PIC X(70).
002900*
003000 FD  NEWMAST.
003100*
003200 01  NEW-MASTER-RECORD.
003300*
003400     05  NM-ITEM-NO              PIC X(5).
003500     05  NM-DESCRIPTIVE-DATA.
003600         10  NM-ITEM-DESC        PIC X(40).
003700         10  NM-UNIT-COST        PIC S9(3)V99.
003800         10  NM-UNIT-PRICE       PIC S9(3)V99.
003900     05  NM-INVENTORY-DATA.
004000         10  NM-REORDER-POINT    PIC S9(5).
004100         10  NM-ON-HAND          PIC S9(5).
004200         10  NM-ON-ORDER         PIC S9(5).
004300*
004400 FD  ERRTRAN.
004500*
004600 01  ERROR-TRANSACTION       PIC X(61).
004700*
004800 WORKING-STORAGE SECTION.
004900*
005000 01  SWITCHES.
005100     05  ALL-RECORDS-PROCESSED-SWITCH    PIC X   VALUE "N".
005200         88  ALL-RECORDS-PROCESSED               VALUE "Y".
005300     05  NEED-TRANSACTION-SWITCH         PIC X   VALUE "Y".
005400         88  NEED-TRANSACTION                    VALUE "Y".
005500     05  NEED-MASTER-SWITCH              PIC X   VALUE "Y".
005600         88  NEED-MASTER                         VALUE "Y".
005700     05  WRITE-MASTER-SWITCH             PIC X   VALUE "N".
005800         88  WRITE-MASTER                        VALUE "Y".
005900*
006000 01  FILE-STATUS-FIELDS.
006100     05  NEWMAST-FILE-STATUS     PIC XX.
006200         88  NEWMAST-SUCCESSFUL          VALUE "00".
006300     05  ERRTRAN-FILE-STATUS     PIC XX.
006400         88  ERRTRAN-SUCCESSFUL          VALUE "00".
006500*
006600 01  MAINTENANCE-TRANSACTION.
006700     05  MT-TRANSACTION-CODE     PIC X.
006800         88  DELETE-RECORD               VALUE "1".
006900         88  ADD-RECORD                  VALUE "2".
007000         88  CHANGE-RECORD               VALUE "3".
007100     05  MT-MASTER-DATA.
007200         10  MT-ITEM-NO          PIC X(5).
007300         10  MT-ITEM-DESC        PIC X(40).
007400         10  MT-UNIT-COST        PIC S9(3)V99.
007500         10  MT-UNIT-PRICE       PIC S9(3)V99.
007600         10  MT-REORDER-POINT    PIC S9(5).
007700*
007800 01  INVENTORY-MASTER-RECORD.
007900     05  IM-ITEM-NO              PIC X(5).
008000     05  IM-DESCRIPTIVE-DATA.
008100         10  IM-ITEM-DESC        PIC X(40).
008200         10  IM-UNIT-COST        PIC S9(3)V99.
008300         10  IM-UNIT-PRICE       PIC S9(3)V99.
008400     05  IM-INVENTORY-DATA.
008500         10  IM-REORDER-POINT    PIC S9(5).
008600         10  IM-ON-HAND          PIC S9(5).
008700         10  IM-ON-ORDER         PIC S9(5).
008800*
008900 PROCEDURE DIVISION.
009000*
009100 000-MAINTAIN-INVENTORY-FILE.
009200*
009300     OPEN INPUT  OLDMAST
009400                 MNTTRAN
009500          OUTPUT NEWMAST
009600                 ERRTRAN.
009700     PERFORM 300-MAINTAIN-INVENTORY-RECORD
009800         UNTIL ALL-RECORDS-PROCESSED.
009900     CLOSE MNTTRAN
010000           OLDMAST
010100           NEWMAST
010200           ERRTRAN.
010300     STOP RUN.
010400*
010500 300-MAINTAIN-INVENTORY-RECORD.
010600*
010700     IF NEED-TRANSACTION
010800         PERFORM 310-READ-INVENTORY-TRANSACTION
010900         MOVE "N" TO NEED-TRANSACTION-SWITCH.
011000     IF NEED-MASTER
011100         PERFORM 320-READ-OLD-MASTER
011200         MOVE "N" TO NEED-MASTER-SWITCH.
011300     PERFORM 330-MATCH-MASTER-TRAN.
011400     IF WRITE-MASTER
011500         PERFORM 340-WRITE-NEW-MASTER
011600         MOVE "N" TO WRITE-MASTER-SWITCH.
011700*
011800 310-READ-INVENTORY-TRANSACTION.
011900*
012000     READ MNTTRAN INTO MAINTENANCE-TRANSACTION
012100         AT END
012200             MOVE HIGH-VALUE TO MT-ITEM-NO.
012300*
012400 320-READ-OLD-MASTER.
012500*
012600     READ OLDMAST INTO INVENTORY-MASTER-RECORD
012700         AT END
012800             MOVE HIGH-VALUE TO IM-ITEM-NO.
012900*
013000 330-MATCH-MASTER-TRAN.
013100*
013200     IF IM-ITEM-NO > MT-ITEM-NO
013300         PERFORM 350-PROCESS-HI-MASTER
013400     ELSE IF IM-ITEM-NO < MT-ITEM-NO
013500         PERFORM 360-PROCESS-LO-MASTER
013600     ELSE
013700         PERFORM 370-PROCESS-MAST-TRAN-EQUAL.
013800
013900 340-WRITE-NEW-MASTER.
014000*
014100     WRITE NEW-MASTER-RECORD.
014200     IF NOT NEWMAST-SUCCESSFUL
014300         DISPLAY "WRITE ERROR ON NEWMAST FOR ITEM NUMBER "
014400             IM-ITEM-NO
014500         DISPLAY "FILE STATUS CODE IS " NEWMAST-FILE-STATUS
014600         MOVE "Y" TO ALL-RECORDS-PROCESSED-SWITCH.
014700*
014800 350-PROCESS-HI-MASTER.
014900*
015000     IF ADD-RECORD
015100         PERFORM 380-APPLY-ADD-TRANSACTION
015200     ELSE
015300         PERFORM 390-WRITE-ERROR-TRANSACTION.
015400*
015500 360-PROCESS-LO-MASTER.
015600*
015700     MOVE INVENTORY-MASTER-RECORD TO NEW-MASTER-RECORD.
015800     MOVE "Y" TO WRITE-MASTER-SWITCH.
015900     MOVE "Y" TO NEED-MASTER-SWITCH.
016000*
016100 370-PROCESS-MAST-TRAN-EQUAL.
016200*
016300     IF IM-ITEM-NO = HIGH-VALUES
016400         MOVE "Y" TO ALL-RECORDS-PROCESSED-SWITCH
016500     ELSE
016600         IF DELETE-RECORD
016700             PERFORM 400-APPLY-DELETE-TRANSACTION
016800         ELSE
016900             IF CHANGE-RECORD
017000                 PERFORM 410-APPLY-CHANGE-TRANSACTION
017100             ELSE
017200                 PERFORM 390-WRITE-ERROR-TRANSACTION.
017300*
017400 380-APPLY-ADD-TRANSACTION.
017500*
017600     MOVE MT-ITEM-NO TO NM-ITEM-NO.
017700     MOVE MT-ITEM-DESC TO NM-ITEM-DESC.
017800     MOVE MT-UNIT-COST TO NM-UNIT-COST.
017900     MOVE MT-UNIT-PRICE TO NM-UNIT-PRICE.
018000     MOVE MT-REORDER-POINT TO NM-REORDER-POINT.
018100     MOVE ZERO TO NM-ON-HAND
018200                  NM-ON-ORDER.
018300     MOVE "Y" TO WRITE-MASTER-SWITCH.
018400     MOVE "Y" TO NEED-TRANSACTION-SWITCH.
018500*
018600 390-WRITE-ERROR-TRANSACTION.
018700*
018800     WRITE ERROR-TRANSACTION FROM MAINTENANCE-TRANSACTION.
018900     IF NOT ERRTRAN-SUCCESSFUL
019000         DISPLAY "WRITE ERROR ON ERRTRAN FOR ITEM NUMBER "
019100             MT-ITEM-NO
019200         DISPLAY "FILE STATUS CODE IS " ERRTRAN-FILE-STATUS
019300         MOVE "Y" TO ALL-RECORDS-PROCESSED-SWITCH
019400     ELSE
019500         MOVE "Y" TO NEED-TRANSACTION-SWITCH.
019600*
019700 400-APPLY-DELETE-TRANSACTION.
019800*
019900     MOVE "Y" TO NEED-MASTER-SWITCH.
020000     MOVE "Y" TO NEED-TRANSACTION-SWITCH.
020100
020200*
020300 410-APPLY-CHANGE-TRANSACTION.
020400*
020500     IF MT-ITEM-DESC NOT = SPACE
020600         MOVE MT-ITEM-DESC TO IM-ITEM-DESC.
020700     IF MT-UNIT-COST NOT = ZERO
020800         MOVE MT-UNIT-COST TO IM-UNIT-COST.
020900     IF MT-UNIT-PRICE NOT = ZERO
021000         MOVE MT-UNIT-PRICE TO IM-UNIT-PRICE.
021100     IF MT-REORDER-POINT NOT = ZERO
021200         MOVE MT-REORDER-POINT TO IM-REORDER-POINT.
021300     MOVE "Y" TO NEED-TRANSACTION-SWITCH.
./ ADD NAME=SKELETNC 0116-01288-01302-1150-00196-00132-00000-BC0THOR
000100 IDENTIFICATION DIVISION.                                         @
000200 PROGRAM-ID.    SKELETNC.                                         @
000300 AUTHOR. PROGRAMMER-NAME.                                         @
000400***************************************************************** @
000500*REMARKS. SKELETON FOR WRITING NEW PROGRAMS IN COBOL.           * @
000600*      1. CHANGE ALL 'SKELETNC' TO YOUR PROGRAM NAME            * @
000700*      2. CHANGE THE AUTHOR STATEMENT ABOVE TO SHOW YOUR NAME AS* @
000800*         PROGRAMMER.                                           * @
000900*      3. IN FILE-CONTROL BELOW, INCLUDE SELECT STATEMENTS FOR  * @
001000*         ALL FILES USED BY THE PROGRAM.                        * @
001100*      4. IN THE FILE SECTION BELOW, DESCRIBE ALL THE FILES TO  * @
001200*         BE USED BY THE PROGRAM. THIS WOULD INCLUDE AN FD AND  * @
001300*         AT LEAST ONE DATA RECORD DESCRIPTION FOR EACH FILE.   * @
001400*      5. NOTE THAT COBOL STATEMENTS ARE CONTAINED BETWEEN      * @
001500*         COLUMN 1 AND 71. COLUMN 72 IS USED AS A CONTINUATION  * @
001600*         INDICATOR AND MUST BE BLANK EXCEPT WHEN CONTINUING A  * @
001700*         NON-NUMERIC LITERAL. THE @ CHARACTERS ARE SET UP IN   * @
001800*         COLUMN 73 AS AN AID TO PREVENT RUNNING PAST COLUMN 71.* @
001900*         THEY MAY BE DELETED WHEN FINISHED CODING IF DESIRED.  * @
002000*      6. THE REMARKS SECTION SHOULD BE USED TO DESCRIBE THE    * @
002100*         PROGRAM AFTER DELETING THESE NOTES.                   * @
002200***************************************************************** @
002300 ENVIRONMENT DIVISION.                                            @
002400 CONFIGURATION SECTION.                                           @
002410 SPECIAL-NAMES.                                                   @
002420     C01 IS TOP-OF-PAGE.                                          @
002500 INPUT-OUTPUT SECTION.                                            @
002600 FILE-CONTROL.                                                    @
002700     SELECT INPUT-FILE ASSIGN TO INPUT1.                          @
002800     SELECT OUTPUT-FILE ASSIGN TO OUTPUT1.                        @
002900     SELECT PRINT-FILE ASSIGN TO PRINT1.                          @
003000 DATA DIVISION.                                                   @
003100 FILE SECTION.                                                    @
003200 FD  INPUT-FILE                                                   @
003300     BLOCK CONTAINS 0 RECORDS                                     @
003400     RECORD CONTAINS 80 CHARACTERS                                @
003500     RECORDING MODE IS F                                          @
003600     LABEL RECORDS ARE STANDARD.                                  @
003700 01  INPUT-RECORD-1.                                              @     10
003800     05  IR1-FIELD1                 PIC XX.                       @     20
003900     05  IR1-FIELD2                 PIC X(14).                    @     30
004000     05  IR1-FIELD3                 PIC Z(5).                     @     30
004100     05  FILLER                     PIC X(59).                    @     40
004200 01  INPUT-RECORD-2.                                              @
004300     05  IR2-FIELD1                 PIC XX.                       @
004400     05  IR2-FIELD2                 PIC X(25).                    @
004500     05  FILLER                     PIC X.                        @
004600     05  IR2-FIELD3                 PIC X(7).                     @
004700     05  IR2-FIELD4                 PIC X(2).                     @
004800     05  IR2-FIELD5                 PIC X(25).                    @
004900     05  IR2-FIELD6                 PIC X(18).                    @
005000                                                                  @
005100 FD  OUTPUT-FILE                                                  @
005200     BLOCK CONTAINS 0 RECORDS                                     @
005300     RECORD CONTAINS 40 TO 225 CHARACTERS                         @
005400     RECORDING MODE IS V                                          @
005500     LABEL RECORDS ARE STANDARD.                                  @
005600 01  OUTPUT-RECORD-1.                                             @     10
005700   05  OR1-FIELD1                   PIC XX.                       @     20
005800   05  OR1-FILLD2                   PIC X(14).                    @     30
005900   05  OR1-FIELD3                   PIC Z(5).                     @     30
006000   05  OR1-FIELD4                   PIC X(204).                   @     40
006100 01  OUTPUT-RECORD-2.                                             @     10
006200   05  OR2-FIELD1                   PIC XX.                       @     20
006300   05  OR2-FIELD2                   PIC X(25).                    @     30
006400   05  OR2-FIELD3                   PIC S9(5)V99 COMP.            @     30
006500   05  OR2-FIELD4                   PIC X(77).                    @     40
006600   05  OR2-FIELD5                   PIC X(7).                     @
006700 01  OUTPUT-RECORD-3.                                             @     10
006800   05  OR3-FIELD1                   PIC XX.                       @     20
006900   05  OR3-FIELD2                   PIC X(12).                    @     30
007000   05  OR3-FIELD3                   PIC S9(5)V99 COMP-3.          @     30
007100   05  OR3-FIELD4                   PIC X(22).                    @     40
007200                                                                  @
007300 FD  PRINT-FILE                                                   @
007400     BLOCK CONTAINS 0 RECORDS                                     @
007500     RECORD CONTAINS 133 CHARACTERS                               @
007600     RECORDING MODE IS F                                          @
007700     LABEL RECORDS ARE STANDARD.                                  @
007800 01  PRINT-RECORD-1.                                              @     10
007900     05  PR1-CC                     PIC X.                        @
008000     05  PR1-DATA                   PIC X(132).                   @
008100 01  PR1-EOJ-COUNTS.                                              @     10
008200   05  FILLER                       PIC X.                        @     20
008300   05  PR-EOJ-COUNTER               PIC ZZ,ZZZ,ZZ9.               @     30
008400   05  FILLER                       PIC X.                        @     20
008500   05  PR-EOJ-COUNT-NAME            PIC X(121).                   @     20
008600                                                                  @
008700 WORKING-STORAGE SECTION.                                         @
008800 77  FILLER                         PIC X(36)  VALUE              @
008900     'SKELETNC WORKING STORAGE BEGINS HERE'.                      @
009000 01  WS-SWITCHES-AND-INDICATORS.                                  @
009100     05  WS-END-OF-INPUT1-SWITCH    PIC X VALUE 'N'.              @
009200         88  WS-END-OF-INPUT1-DATA    VALUE IS 'Y'.               @
009300         88  WS-MORE-DATA-TO-PROCESS  VALUE IS 'N'.               @
009400                                                                  @
009500 01  WS-MISCELLANEOUS-WORK-AREAS.                                 @
009600     05  WS-OUTPUT1-RECORD-COUNTER  PIC S9(8) COMP-3 VALUE +0.    @
009700     05  WS-INPUT1-RECORD-COUNTER   PIC S9(8) COMP-3 VALUE +0.    @
009800     05  WS-LINE-COUNT              PIC S99 COMP-3 VALUE +0.      @
009900     05  WS-LINE-SPACING            PIC 9 VALUE 1.                @
010000     05  WS-PAGE-NUMBER             PIC S9(4) COMP-3 VALUE +0.    @
010100     05  WS-TODAYS-DATE.                                          @
010200         10  WS-TODAYS-YEAR         PIC X(4).                     @
010300         10  WS-TODAYS-MONTH        PIC XX.                       @
010400         10  WS-TODAYS-DAY          PIC XX.                       @
010500                                                                  @
010600 01  WS-HEADING-LINE-1.                                           @
010700     05  FILLER                     PIC X VALUE '2'.              @
010800     05  FILLER                     PIC X(8) VALUE 'SKELETNC'.    @
010900     05  FILLER                     PIC X VALUE ' '.              @
011000     05  WS-HEADING-DATE.                                         @
011100         10  WS-HEADING-MONTH       PIC X(2).                     @
011200         10  FILLER                 PIC X VALUE '/'.              @
011300         10  WS-HEADING-DAY         PIC XX.                       @
011400         10  FILLER                 PIC X VALUE '/'.              @
011500         10  WS-HEADING-YEAR        PIC X(4).                     @
011600     05  FILLER                     PIC X(42) VALUE SPACES.       @
011700     05  FILLER                     PIC X(21) VALUE               @
011800                                   'CENTERED REPORT TITLE'.       @
011900     05  FILLER                     PIC X(41) VALUE SPACES.       @
012000     05  FILLER                     PIC X(5) VALUE 'PAGE '.       @
012100     05  WS-HEADING-PAGE-NUMBER     PIC ZZZ9.                     @
012200                                                                  @
012300 LINKAGE SECTION.                                                 @
012400 01  EXEC-PARM-FIELD.                                             @
012500     05  EXEC-PARM-LENGTH           PIC S9(4) COMP.               @
012600     05  EXEC-PARM-DATA             PIC X(104).                   @
012700                                                                  @
012800 PROCEDURE DIVISION USING EXEC-PARM-FIELD.                        @
012900                                                                  @
013000 A100-EXECUTIVE-CONTROL.                                          @
013100     PERFORM A100-INITIALIZATION.                                 @
013200     PERFORM B100-MAINLINE-PROCESSING UNTIL                       @
013210         WS-END-OF-INPUT1-DATA.                                   @
013300     PERFORM Z100-END-OF-PROCESSING.                              @
013400     GOBACK.                                                      @
013500                                                                  @
013600 A100-INITIALIZATION.                                             @
013700     OPEN INPUT INPUT-FILE,                                       @
013800          OUTPUT OUTPUT-FILE, PRINT-FILE.                         @
013900     ACCEPT WS-TODAYS-DATE FROM DATE YYYYMMDD.                    @
014000     MOVE WS-TODAYS-YEAR TO WS-HEADING-YEAR.                      @
014100     MOVE WS-TODAYS-MONTH TO WS-HEADING-MONTH.                    @
014200     MOVE WS-TODAYS-DAY TO WS-HEADING-DAY.                        @
014300                                                                  @
014400 B100-MAINLINE-PROCESSING.                                        @
014500     PERFORM C100-READ-INPUT-FILE THRU C100-EXIT.                 @
014600     IF WS-MORE-DATA-TO-PROCESS                                   @
014700        PERFORM D100-PROCESS-THE-RECORD THRU D100-EXIT.           @
014800     PERFORM E100-WRITE-OUTPUT-FILE THRU E100-EXIT.               @
014900                                                                  @
015000 C100-READ-INPUT-FILE.                                            @
015100     READ INPUT-FILE                                              @
015200         AT END                                                   @
015201             MOVE 'Y' TO WS-END-OF-INPUT1-SWITCH                  @
015210             GO TO C100-EXIT.                                     @     30
015220     ADD +1 TO WS-INPUT1-RECORD-COUNTER.                          @     30
015300 C100-EXIT. EXIT.                                                 @
015400                                                                  @
015500 D100-PROCESS-THE-RECORD.                                         @
015600     IF WS-END-OF-INPUT1-DATA                                     @
015700         GO TO D100-EXIT.                                         @
015800 D100-EXIT. EXIT.                                                 @
015900                                                                  @
016000 E100-WRITE-OUTPUT-FILE.                                          @
016100     WRITE OUTPUT-RECORD-1.                                       @
016200     ADD 1 TO WS-OUTPUT1-RECORD-COUNTER.                          @
016300 E100-EXIT. EXIT.                                                 @
016400                                                                  @
016500 Y100-PRINT-A-LINE.                                               @
016600     WRITE PRINT-RECORD-1 AFTER ADVANCING WS-LINE-SPACING.        @
016700     ADD WS-LINE-SPACING TO WS-LINE-COUNT.                        @
016800     IF WS-LINE-COUNT IS GREATER THAN 60                          @
016900         PERFORM Y200-PRINT-HEADING THRU Y200-EXIT.               @
017000 Y100-EXIT. EXIT.                                                 @
017100                                                                  @
017200 Y200-PRINT-HEADING.                                              @
017300     ADD 1 TO WS-PAGE-NUMBER.                                     @
017400     MOVE WS-PAGE-NUMBER TO WS-HEADING-PAGE-NUMBER.               @
017500     MOVE WS-HEADING-LINE-1 TO PRINT-RECORD-1.                    @
017600     WRITE PRINT-RECORD-1 AFTER ADVANCING TOP-OF-PAGE.            @
017700     MOVE 2 TO WS-LINE-COUNT.                                     @
017800     MOVE SPACES TO PRINT-RECORD-1.                               @
017900 Y200-EXIT. EXIT.                                                 @
018000                                                                  @
018100 Z100-END-OF-PROCESSING.                                          @
018200     MOVE 'INPUT RECORDS READ' TO PR-EOJ-COUNT-NAME.              @     20
018300     MOVE WS-INPUT1-RECORD-COUNTER TO PR-EOJ-COUNTER.             @     30
018400     PERFORM Y100-PRINT-A-LINE THRU Y100-EXIT.                    @
018500     MOVE 'OUTPUT RECORDS WRITTEN' TO PR-EOJ-COUNT-NAME.          @     20
018600     MOVE WS-OUTPUT1-RECORD-COUNTER TO PR-EOJ-COUNTER.            @
018700     PERFORM Y100-PRINT-A-LINE THRU Y100-EXIT.                    @
018800     CLOSE INPUT-FILE,                                            @
018900           OUTPUT-FILE,                                           @
019000           PRINT-FILE.                                            @
./ ADD NAME=SRT1000C 0101-01302-01302-1152-00196-00196-00000-BC0THOR
000100 IDENTIFICATION DIVISION.
000200*
000300 PROGRAM-ID.  SRT1000C
000400*
000500 ENVIRONMENT DIVISION.
000600*
000700 INPUT-OUTPUT SECTION.
000800*
000900 FILE-CONTROL.
001000*
001100     SELECT RCTTRAN  ASSIGN TO RCTTRAN.
001200     SELECT OLDMAST  ASSIGN TO OLDMAST.
001300     SELECT NEWMAST  ASSIGN TO NEWMAST
001400                     FILE STATUS IS NEWMAST-FILE-STATUS.
001500     SELECT ERRTRAN  ASSIGN TO ERRTRAN
001600                     FILE STATUS IS ERRTRAN-FILE-STATUS.
001700     SELECT SORTWORK ASSIGN TO SORTWORK.
001800*
001900 DATA DIVISION.
002000*
002100 FILE SECTION.
002200*
002300 FD  RCTTRAN.
002400*
002500 01  TRANSACTION-RECORD      PIC X(23).
002600*
002700 FD  OLDMAST.
002800*
002900 01  OLD-MASTER-RECORD       PIC X(70).
003000*
003100 FD  NEWMAST.
003200*
003300 01  NEW-MASTER-RECORD       PIC X(70).
003400*
003500 FD  ERRTRAN.
003600*
003700 01  ERROR-TRANSACTION       PIC X(23).
003800*
003900 SD  SORTWORK.
004000*
004100 01  SORT-WORK-AREA.
004200     05  SW-ITEM-NO          PIC X(5).
004300     05  FILLER              PIC X(18).
004400*
004500 WORKING-STORAGE SECTION.
004600*
004700 01  SWITCHES.
004800     05  TRANSACTION-EOF-SWITCH          PIC X   VALUE "N".
004900         88  TRANSACTION-EOF                     VALUE "Y".
005000     05  VALID-TRANSACTION-SWITCH        PIC X   VALUE "Y".
005100         88  VALID-TRANSACTION                   VALUE "Y".
005200     05  FIRST-EXECUTION-SWITCH          PIC X   VALUE "Y".
005300         88  FIRST-EXECUTION                     VALUE "Y".
005400     05  ALL-RECORDS-PROCESSED-SWITCH    PIC X   VALUE "N".
005500         88  ALL-RECORDS-PROCESSED               VALUE "Y".
005600*
005700 01  FILE-STATUS-FIELDS.
005800     05  NEWMAST-FILE-STATUS     PIC XX.
005900         88  NEWMAST-SUCCESSFUL          VALUE "00".
006000     05  ERRTRAN-FILE-STATUS     PIC XX.
006100         88  ERRTRAN-SUCCESSFUL          VALUE "00".
006200*
006300 01  RECEIPT-TRANSACTION.
006400     05  RT-ITEM-NO              PIC X(5).
006500     05  RT-VENDOR-NO            PIC X(5).
006600     05  RT-RECEIPT-DATE         PIC X(8).
006700     05  RT-RECEIPT-QUANTITY-X   PIC X(5).
006800     05  RT-RECEIPT-QUANTITY REDEFINES RT-RECEIPT-QUANTITY-X
006900                                 PIC 9(5).
007000*
007100 01  INVENTORY-MASTER-RECORD.
007200     05  IM-ITEM-NO              PIC X(5).
007300     05  IM-DESCRIPTIVE-DATA.
007400         10  IM-ITEM-DESC        PIC X(40).
007500         10  IM-UNIT-COST        PIC S9(3)V99.
007600         10  IM-UNIT-PRICE       PIC S9(3)V99.
007700     05  IM-INVENTORY-DATA.
007800         10  IM-REORDER-POINT    PIC S9(5).
007900         10  IM-ON-HAND          PIC S9(5).
008000         10  IM-ON-ORDER         PIC S9(5).
008100*
008200 PROCEDURE DIVISION.
008300*
008400 000-UPDATE-INVENTORY-FILE.
008500*
008600     OPEN INPUT  OLDMAST
008700                 RCTTRAN
008800          OUTPUT NEWMAST
008900                 ERRTRAN.
009000     SORT SORTWORK
009100         ON ASCENDING KEY SW-ITEM-NO
009200         INPUT PROCEDURE IS 100-EDIT-RECEIPT-TRANSACTIONS
009300         OUTPUT PROCEDURE IS 400-UPDATE-INVENTORY-RECORDS.
009400     CLOSE RCTTRAN
009500           OLDMAST
009600           NEWMAST
009700           ERRTRAN.
009800     STOP RUN.
009900*
010000 100-EDIT-RECEIPT-TRANSACTIONS.
010100*
010200     PERFORM 200-EDIT-RECEIPT-TRAN
010300         UNTIL TRANSACTION-EOF.
010400*
010500 200-EDIT-RECEIPT-TRAN.
010600*
010700     PERFORM 210-READ-RECEIPT-TRANSACTION.
010800     IF NOT TRANSACTION-EOF
010900         PERFORM 220-EDIT-TRANSACTION-FIELDS
011000         IF VALID-TRANSACTION
011100             PERFORM 230-RELEASE-VALID-TRANSACTION
011200         ELSE
011300             PERFORM 240-WRITE-ERROR-TRANSACTION.
011400*
011500 210-READ-RECEIPT-TRANSACTION.
011600*
011700     READ RCTTRAN INTO RECEIPT-TRANSACTION
011800         AT END
011900             MOVE "Y" TO TRANSACTION-EOF-SWITCH.
012000*
012100 220-EDIT-TRANSACTION-FIELDS.
012200*
012300     MOVE "Y" TO VALID-TRANSACTION-SWITCH.
012400     IF       RT-ITEM-NO NOT NUMERIC
012500           OR RT-VENDOR-NO NOT NUMERIC
012600           OR RT-RECEIPT-QUANTITY-X NOT NUMERIC
012700         MOVE "N" TO VALID-TRANSACTION-SWITCH.
012800*
012900 230-RELEASE-VALID-TRANSACTION.
013000*
013100     RELEASE SORT-WORK-AREA FROM RECEIPT-TRANSACTION.
013200*
013300 240-WRITE-ERROR-TRANSACTION.
013400*
013500     WRITE ERROR-TRANSACTION FROM RECEIPT-TRANSACTION.
013600     IF NOT ERRTRAN-SUCCESSFUL
013700         DISPLAY "WRITE ERROR ON ERRTRAN FOR ITEM NUMBER "
013800             RT-ITEM-NO
013900         DISPLAY "FILE STATUS CODE IS " ERRTRAN-FILE-STATUS.
014000*
014100*300-SORT-VALID-TRANSACTIONS.  DUMMY MODULE DONE BY SORT PROGRAM.
014200*
014300 400-UPDATE-INVENTORY-RECORDS.
014400*
014500     MOVE LOW-VALUE TO IM-ITEM-NO.
014600     PERFORM 500-PROCESS-RECEIPT-TRAN
014700         UNTIL ALL-RECORDS-PROCESSED.
014800*
014900 500-PROCESS-RECEIPT-TRAN.
015000*
015100     PERFORM 510-RETURN-RECEIPT-TRANSACTION.
015200     PERFORM 520-PROCESS-INVENTORY-MASTER
015300         UNTIL IM-ITEM-NO >= RT-ITEM-NO.
015400     IF     IM-ITEM-NO = HIGH-VALUE
015500        AND RT-ITEM-NO = HIGH-VALUE
015600         MOVE "Y" TO ALL-RECORDS-PROCESSED-SWITCH
015700     ELSE
015800         IF IM-ITEM-NO = RT-ITEM-NO
015900             PERFORM 550-APPLY-RECEIPT-TRANSACTION
016000         ELSE
016100             PERFORM 240-WRITE-ERROR-TRANSACTION.
016200*
016300 510-RETURN-RECEIPT-TRANSACTION.
016400*
016500     RETURN SORTWORK INTO RECEIPT-TRANSACTION
016600         AT END
016700             MOVE HIGH-VALUE TO RT-ITEM-NO.
016800*
016900 520-PROCESS-INVENTORY-MASTER.
017000*
017100     IF FIRST-EXECUTION
017200         PERFORM 530-READ-OLD-MASTER
017300         MOVE "N" TO FIRST-EXECUTION-SWITCH
017400     ELSE
017500         PERFORM 540-WRITE-NEW-MASTER
017600         PERFORM 530-READ-OLD-MASTER.
017700*
017800 530-READ-OLD-MASTER.
017900*
018000     READ OLDMAST INTO INVENTORY-MASTER-RECORD
018100         AT END
018200             MOVE HIGH-VALUE TO IM-ITEM-NO.
018300*
018400 540-WRITE-NEW-MASTER.
018500*
018600     WRITE NEW-MASTER-RECORD FROM INVENTORY-MASTER-RECORD.
018700     IF NOT NEWMAST-SUCCESSFUL
018800         DISPLAY "WRITE ERROR ON NEWMAST FOR ITEM NUMBER "
018900             IM-ITEM-NO
019000         DISPLAY "FILE STATUS CODE IS " NEWMAST-FILE-STATUS
019100         MOVE "Y" TO ALL-RECORDS-PROCESSED-SWITCH.
019200*
019300 550-APPLY-RECEIPT-TRANSACTION.
019400*
019500     ADD RT-RECEIPT-QUANTITY TO IM-ON-HAND.
019600     SUBTRACT RT-RECEIPT-QUANTITY FROM IM-ON-ORDER.
